5.6.11 / 2019-08-25
===================
 * fix(model): allow passing options to `exists()` #8075
 * fix(document): make `validateUpdatedOnly` option handle pre-existing errors #8091
 * fix: throw readable error if middleware callback isnt a function #8087
 * fix: don't throw error if calling `find()` on a nested array #8089
 * docs(middleware): clarify that you must add middleware before compiling your model #5087
 * docs(query): add missing options to `setOptions()` #8099

5.6.10 / 2019-08-20
===================
 * fix(schema): fix require() path to work around yet another bug in Jest #8053
 * fix(document): skip casting when initing a populated path #8062
 * fix(document): prevent double-calling validators on mixed objects with nested properties #8067
 * fix(query): handle schematype with `null` options when checking immutability #8070 [rich-earth](https://github.com/rich-earth)
 * fix(schema): support `Schema#path()` to get schema path underneath doc array #8057
 * docs(faq): add disable color instruction #8066

5.6.9 / 2019-08-07
==================
 * fix(model): delete versionError after saving to prevent memory leak #8048
 * fix(cursor): correctly handle batchSize option with query cursor #8039
 * fix(populate): handle virtual populate with count = 0 if virtual embedded in doc array #7573
 * fix(schema): allow declaring ObjectId array with `{ type: 'ObjectID' }`, last 'D' case insensitive #8034

5.6.8 / 2019-08-02
==================
 * fix(aggregate): allow modifying pipeline in pre('aggregate') hooks #8017
 * fix(query): make `findOneAndReplace()` work with `orFail()` #8030
 * fix(document): allow saving an unchanged document if required populated path is null #8018
 * fix(debug): support disabling colors in debug mode #8033 [Mangosteen-Yang](https://github.com/Mangosteen-Yang)
 * docs: add async-await guide #8028 [Rossh87](https://github.com/Rossh87)
 * docs(plugins): rewrite plugins docs to be more modern and not use strange `= exports` syntax #8026
 * docs(transactions): clarify relationship between `session` in docs and MongoDB driver ClientSession class, link to driver docs #8009

5.6.7 / 2019-07-26
==================
 * fix(document): support validators on nested arrays #7926
 * fix(timestamps): handle `timestamps: false` in child schema #8007
 * fix(query): consistently support `new` option to `findOneAndX()` as an alternative to `returnOriginal` #7846
 * fix(document): make `inspect()` never return `null`, because a document or nested path is never `== null` #7942
 * docs(query+lean): add links to mongoose-lean-virtuals, mongoose-lean-getters, mongoose-lean-defaults #5606
 * docs: add example for `Schema#pre(Array)` #8022 [Mangosteen-Yang](https://github.com/Mangosteen-Yang)
 * docs(schematype): updated comment from Schema.path to proper s.path #8013 [chrisweilacker](https://github.com/chrisweilacker)
 * chore: upgrade nyc #8015 [kolya182](https://github.com/kolya182)

5.6.6 / 2019-07-22
==================
 * fix(populate): handle refPath returning a virtual with `Query#populate()` #7341
 * fix(populate): handle `refPath` in discriminator when populating top-level model #5109
 * fix(mongoose): ensure destucturing and named imports work for Mongoose singleton methods like `set()`, etc. #6039
 * fix(query): add missing options for deleteOne and deleteMany in Query #8004 [Fonger](https://github.com/Fonger)
 * fix(schema): make embedded discriminators `instanceof` their parent types #5005
 * fix(array): make `validators` a private property that doesn't show up in for/in #6572
 * docs(api): fix array API docs that vanished because of #7798 #7979
 * docs(discriminators+api): add single nested discriminator to discriminator docs and API docs #7983
 * docs(connection+mongoose): make option lists consistent between `mongoose.connect()`, `mongoose.createConnection()`, and `conn.openUri()` #7976
 * docs(validation): clarify resolve(false) vs reject() for promise-based async custom validators #7761
 * docs(guide): use correct `mongoose.set()` instead of `mongoose.use()` #7998
 * docs: add redis cache example #7997 [usama-asfar](https://github.com/usama-asfar)

5.6.5 / 2019-07-17
==================
 * fix(document): handle setting non-schema path to ObjectId or Decimal128 if strict: false #7973
 * fix(connection): remove backwards-breaking multiple mongoose.connect() call for now #7977
 * fix(schema): print invalid value in error message when a schema path is set to undefined or null #7956
 * fix(model): throw readable error if calling `new Model.discriminator()` #7957
 * fix(mongoose): export `cast()` function #7975 [perfectstorm88](https://github.com/perfectstorm88)
 * docs(model): fix link to Model.inspect() and add example #7990
 * docs: fix broken anchor links on validation tutorial #7966
 * docs(api): fix broken links to split API pages #7978
 * chore: create LICENSE.md #7989 [Fonger](https://github.com/Fonger)

5.6.4 / 2019-07-08
==================
 * fix(schema): support pre(Array, Function) and post(Array, Function) #7803
 * fix(document): load docs with a `once` property successfully #7958
 * fix(queryhelpers): ensure parent `select` overwrites child path `select` if parent is nested #7945
 * fix(schema): make `clone()` correctly copy array embedded discriminators #7954
 * fix(update): fix error when update property gets casted to null #7949
 * fix(connection): bubble up attemptReconnect event for now #7872
 * docs(tutorials): add virtuals tutorial #7965
 * docs(connection): add section on connection handling #6997

5.6.3 / 2019-07-03
==================
 * fix(document): respect projection when running getters #7940
 * fix(model): call createCollection() in syncIndexes() to ensure the collection exists #7931
 * fix(document): consistently use post-order traversal for gathering subdocs for hooks #7929
 * fix(schema): ensure `Schema#pathType()` returns correct path type given non-existent positional path #7935
 * fix(ChangeStream): set `closed` if emitting close event #7930
 * fix(connection): bubble up 'attemptReconnect' event from MongoDB connection #7872
 * docs: fix broken .jade links on search page #7932
 * docs: correct link to `Query#select()` #7953 [rayhatfield](https://github.com/rayhatfield)
 * docs(README): add list of related projects #7773

4.13.19 / 2019-07-02
====================
 * fix(aggregate): make `setOptions()` work as advertised #7950 #6011 [cdimitroulas](https://github.com/cdimitroulas)

5.6.2 / 2019-06-28
==================
 * fix(update): allow using `update()` with immutable `createdAt` #7917
 * fix(model): pass `doc` parameter to save() error handling middleware #7832
 * fix(mongoose): add applyPluginsToChildSchemas option to allow opting out of global plugins for child schemas #7916
 * docs(connection): document `useCache` option for `useDb()` #7923
 * docs: fix broken link in FAQ #7925 [christophergeiger3](https://github.com/christophergeiger3)

5.6.1 / 2019-06-24
==================
 * fix(update): skip setting defaults for single embedded subdocs underneath maps #7909
 * fix(document): copy date objects correctly when strict = false #7907
 * feat(mongoose): throw an error if calling `mongoose.connect()` multiple times while connected #7905 [Fonger](https://github.com/Fonger)
 * fix(document): copies virtuals from array subdocs when casting array of docs with same schema #7898
 * fix(schema): ensure clone() copies single embedded discriminators correctly #7894
 * fix(discriminator): merge instead of overwriting conflicting nested schemas in discriminator schema #7884
 * fix(populate): ignore nullish arguments when calling `populate()` #7913 [rayhatfield](https://github.com/rayhatfield)
 * docs: add getters/setters tutorial #7919
 * docs: clean up error docs so they refer to `Error` rather than `MongooseError` #7867
 * docs: fix a couple broken links #7921 [kizmo04](https://github.com/kizmo04)
 * refactor: remove unnecessary if #7911 [rayhatfield](https://github.com/rayhatfield)

5.6.0 / 2019-06-14
==================
 * feat(schematype): add `immutable` option to disallow changing a given field #7671
 * docs: split API docs into separate pages to make API documentation more Google-able #7812
 * perf(array): remove all mixins in favor of ES6 classes, ~20% faster in basic benchmarks #7798
 * feat(document): use promise rejection error message when async custom validator throws an error #4913
 * feat(virtual): pass document as 3rd parameter to virtual getters and setters to enable using arrow functions #4143
 * feat(model): add `Model.exists()` function to quickly check whether a document matching `filter` exists #6872
 * feat(index+connection): support setting global and connection-level `maxTimeMS`
 * feat(populate): support setting `ref` to a function for conventional populate #7669
 * feat(document): add overwrite() function that overwrites all values in a document #7830
 * feat(populate): support `PopulateOptions#connection` option to allow cross-db populate with refPath #6520
 * feat(populate): add skipInvalidIds option to silently skip population if id is invalid, instead of throwing #7706
 * feat(array): skip empty array default if there's a 2dsphere index on a geojson path #3233
 * feat(query): add `getFilter()` as an alias of `getQuery()` to be more in line with API docs #7839
 * feat(model): add Model.inspect() to make models not clutter `util.inspect()` #7836
 * perf(discriminator): skip calling `createIndex()` on indexes that are defined in the base schema #7379
 * docs: upgrade from Jade to latest Pug #7812
 * docs(README): update reference to example schema.js #7899 [sharils](https://github.com/sharils)
 * docs(README): improve variable name #7900 [sharils](https://github.com/sharils)
 * chore: replace charAt(0) with startsWith #7897 [Fonger](https://github.com/Fonger)
 * chore: replace indexOf with includes, startsWith and endsWith for String #7897 [Fonger](https://github.com/Fonger)

5.5.15 / 2019-06-12
===================
 * fix(connection): reject initial connect promise even if there is an on('error') listener #7850
 * fix(map): make `of` automatically convert POJOs to schemas unless typeKey is set #7859
 * fix(update): use discriminator schema to cast update if discriminator key specified in filter #7843
 * fix(array): copy atomics from source array #7891 #7889 [jyrkive](https://github.com/jyrkive)
 * fix(schema): return this when Schema.prototype.add is called with Schema #7887 [Mickael-van-der-Beek](https://github.com/Mickael-van-der-Beek)
 * fix(document): add `numAffected` and `result` to DocumentNotFoundError for better debugging #7892 #7844

5.5.14 / 2019-06-08
===================
 * fix(query): correct this scope of setters in update query #7876 [Fonger](https://github.com/Fonger)
 * fix(model): reset modifiedPaths after successful insertMany #7852 #7873 [Fonger](https://github.com/Fonger)
 * fix(populate): allow using `refPath` with virtual populate #7848
 * fix(document): prepend private methods getValue and setValue with $ #7870 [Fonger](https://github.com/Fonger)
 * fix: update mongodb driver -> 3.2.7 #7871 [Fonger](https://github.com/Fonger)
 * docs(tutorials): add tutorial about custom casting functions #7045
 * docs(connection): fix outdated events document #7874 [Fonger](https://github.com/Fonger)
 * docs: fix typo in lean docs #7875 [tannakartikey](https://github.com/tannakartikey)
 * docs: move off of KeenIO for tracking and use self-hosted analytics instead

5.5.13 / 2019-06-05
===================
 * fix(model): support passing deleteOne options #7860 #7857 [Fonger](https://github.com/Fonger)
 * fix(update): run setters on array elements when doing $addToSet, $push, etc #4185
 * fix(model): support getting discriminator by value when creating a new model #7851
 * docs(transactions): add section about the `withTransaction()` helper #7598
 * docs(schema): clarify relationship between Schema#static() and Schema#statics #7827
 * docs(model): fix typo `projetion` to `projection` #7868 [dfdeagle47](https://github.com/dfdeagle47)
 * docs(schema): correct schema options lists #7828

5.5.12 / 2019-05-31
===================
 * fix(document): fix unexpected error when loading a document with a nested property named `schema` #7831
 * fix(model): skip applying static hooks by default if static name conflicts with query middleware (re: mongoose-delete plugin) #7790
 * fix(query): apply schema-level projections to the result of `findOneAndReplace()` #7654
 * fix: upgrade mongodb driver -> 3.2.6
 * docs(tutorials): add findOneAndUpdate() tutorial #7847
 * docs(validation): add `updateOne()` and `updateMany()` to list of update validator operations #7845
 * docs(model): make sure options lists in `update()` API line up #7842

5.5.11 / 2019-05-23
===================
 * fix(discriminator): allow numeric discriminator keys for embedded discriminators #7808
 * chore: add Node.js 12 to travis build matrix #7784

5.5.10 / 2019-05-20
===================
 * fix(discriminator): allow user-defined discriminator path in schema #7807
 * fix(query): ensure `findOneAndReplace()` sends `replacement` to server #7654
 * fix(cast): allow `[]` as a value when casting `$nin` #7806
 * docs(model): clarify that setters do run on `update()` by default #7801
 * docs: fix typo in FAQ #7821 [jaona](https://github.com/jaona)

5.5.9 / 2019-05-16
==================
 * fix(query): skip schema setters when casting $regexp $options #7802 [Fonger](https://github.com/Fonger)
 * fix(populate): don't skip populating doc array properties whose name conflicts with an array method #7782
 * fix(populate): make populated virtual return undefined if not populated #7795
 * fix(schema): handle custom setters in arrays of document arrays #7804 [Fonger](https://github.com/Fonger)
 * docs(tutorials): add query casting tutorial #7789

5.5.8 / 2019-05-13
==================
 * fix(document): run pre save hooks on nested child schemas #7792
 * fix(model): set $session() before validation middleware for bulkWrite/insertMany #7785 #7769 [Fonger](https://github.com/Fonger)
 * fix(query): make `getPopulatedPaths()` return deeply populated paths #7757
 * fix(query): suppress findAndModify deprecation warning when using `Model.findOneAndUpdate()` #7794
 * fix: upgrade mongodb -> 3.2.4 #7794
 * fix(document): handle a couple edge cases with atomics that happen when schema defines an array property named 'undefined' #7756
 * docs(discriminator): correct function parameters #7786 [gfpacheco](https://github.com/gfpacheco)

5.5.7 / 2019-05-09
==================
 * fix(model): set $session() before pre save middleware runs when calling save() with options #7742
 * fix(model): set $session before pre remove hooks run when calling remove() with options #7742
 * fix(schema): support `remove()` on nested path #2398
 * fix(map): handle setting populated map element to doc #7745
 * fix(query): return rawResult when inserting with options `{new:false,upsert:true,rawResult:true}` #7774 #7770 [LiaanM](https://github.com/LiaanM)
 * fix(schematype): remove internal `validators` option because it conflicts with Backbone #7720

5.5.6 / 2019-05-06
==================
 * fix(document): stop converting arrays to objects when setting non-schema path to array with strict: false #7733
 * fix(array): make two Mongoose arrays `assert.deepEqual()` each other if they have the same values #7700
 * fix(populate): support populating a path in a document array embedded in an array #7647
 * fix(populate): set populate virtual count to 0 if local field is empty #7731
 * fix(update): avoid throwing cast error if casting array filter that isn't in schema with strictQuery = false #7728
 * docs: fix typo in `distinct()` description #7767 [phil-r](https://github.com/phil-r)

5.5.5 / 2019-04-30
==================
 * fix(document): ensure nested properties within single nested subdocs get set correctly when overwriting single nested subdoc #7748
 * fix(document): skip non-object `validators` in schema types #7720
 * fix: bump mongodb driver -> 3.2.3 #7752
 * fix(map): disallow setting map key with special properties #7750 [Fonger](https://github.com/Fonger)

5.5.4 / 2019-04-25
==================
 * fix(document): avoid calling custom getters when saving #7719
 * fix(timestamps): handle child schema timestamps correctly when reusing child schemas #7712
 * fix(query): pass correct callback for _legacyFindAndModiFy #736 [on'Er](htt0S://çithuâ.bom/Fnnoer)
 * fix(model+query): allow se4ting `repláseMent` paramEt%r fr `findOneAndReplace8)p #76u4
0* fix(map): make @delete()` unse4 the keq in the database #7?46 [Fonger](htôps://giôhuf.com/Fon'er) * fix(array):0use sylbol$dor$`_schemi`(property`to0avoid confusinc!deep euuality khecks #7600
$* bix(focument): `refen4 `äetopulate8)`%from reíovhng fields$uith empty aròay #7741 #7740 [Fooger](https://cithub.com+Vongeb)
 * fix: maKe aMngnoseArpaY#insludes` support ObjectIds #7732 #6354 [hansemannnY(htdps://giôhub.cgm/hansemannn)
 * fix(document)*`pepoRt corregt validation ervor!indey when puching onto dmc árra9 '7744 [Fmnger](https://github.com/Fonger)

55.3 / 2019-04-22
=======}==========
 * fix: add fIndAndMoeify deprecatio. warning$phat(refdrefcEó ôhe(useFindAndModify oxti{n #764t
 *`fi|¨docement): handHe pushing i doc o.to á disaréminaTor tHat cgntains a äoc array #w704
 * fix85Pd!te)º run {etturs ol(ivray elemgnts when dking $set #767=
!* fix: Correct0usaGe`oF arçumentS while buffepinf commcnds #7718 [rzymek](https://github.com/zzymek)
 * fix(documgnt(: ivoid errov cleariîg modified subpauhs if"toc not0defilud #7715 ßbitdlower](lttps://fithub.com/bxtglowar¹
 * refactor(array)z moög `_parent` Prnperty behinä a qymbol #7726 #7700
 * docó(Modml): lyst out all operatéons a.ä optiOns for `bUlkWrite()` "7055 ª docs(agg2eoate): use  eachCsync()` iNstead"onhnone0istent `eacH()r #'6)9
 . doc{(validation):`add$CastErbor0valilation exemple #551¤
 * docs(query«model): list out `ll /ptions$and callbabk det`hls for Modål.UpdaueX(( and Que2y#updaveX(i £764v

5.7.2  6219-04m16=================
 * fix(documen4k: support setTkng nested pith(to non-PNJO object '7639
 * perf(connection): removm`leqkåd event0hindler in `Model.init(!` {o `deleteModelh9` freas alh memor} #7682
 * fIx(timestamps): handle custom statiss thaT$cOnfl)ct$with built-in functionS"(lhke monooose-ddlete plugij) #7698
 * fix(populate): make `Docqmeît'populated()` vork for!pkpuìaTed sublocs #7685
 * fix(tocument): support `.set()` on documgnt array underjeath embedded dibcriminator ðaTh #7>56

5.5.1 / 2019-04-11
====m-============
 j fix(document): cobrectly ovgrwrite all properties when setting q single neSted sub$oc +'668 #7681Š * fix(array): allow cuspomizatiOn"of$arvay requyred r!Lidator #7696 [freewml]¨https:/-github.com/nreewIl)
 * gih8discrIminator©* handle emjelded discr)minators whensasting irray)defaults$#7687
 * fix(Collecvion): ensure collection fuîctigns ret5rn a promisu even if äiscoNjected #7676
0*0æix(scxematyp$): avoId inde8ing propertyes with `{ unique: f!,se- ijdex: false |` #7620
 * æix(ag'regete+: make `Aggregate#mode,)` wivh no arguments råturn the aggregadiongs mo`el$#7608

5.5.0 /`2019­0428
=====9===5?=5½====
"*"feat(mgdel): su0port apply).g hooks to!custom sTathc ftncvions c5982
 * feit¨populate): support ópecifying e fu~ction as `-atch` #7397
 * perf(buffer): aVoid ãalling `dufinePropgrpies()` in Buff%r constructor #'3#1
 * feqt(Colnection): `dd `pluch.()``for connection-scoped plugins +7738
 
 feat(mïdel): add Model#daleteOne() and coRrespoNding hooks #7538ˆ * fåau*query): support hoOks for aaugry+distinct()@ #5939
$* feat(modem): Print warning when`callijg creat%() incorreC4ly with a sessmon #7535 *°feat(document): add Documunt#ysEmpty() afd correspgnding helpe`s for nested 0aths(#u369
 * fEat(document)> add `getters` oðtion"to ÄocUeend#Get(+$#7233
 * faat(auery): add Quer9#projecpion() to çet r ïverwrite the(current pbobectio #7384
 * fix(document): set lull valmdatnr path on validatorQpopertiec if `propsParaoetdr` set on vaìiditor 3·0w * feat(documdnti: add Docement#directModifiedPaths()"#6373
 ª Feau(document): add $locals propårty #7691
 * feat(document): add vali$ateUpdatedonl9 kptIon thad only valmdates modifiud paths in `save()` #7492 [captaknaaiuS](htvps://Gitjub.com/capdaincaius)
 * chore: upgòade MoîgoDB dbiver to v3.2.0 #7645
 * fix(schematypå): deprecate `irAsync` option gor cu3tom valid`tozs !v720
 * chïre(molgooqe): dapråcate global&MKNGOOSE_DRIVEZ_P`TH0so we cif be w%âpack-warnén'-fzee in 6.2 #7µ01

5&4.23 / 201¹-04/08
=??=====-=========
!*$fiy(document)> re`ort"cast error when`stri.c qath0in schema is an array in MongïDC #7¶1¹
 * fip(uueòy)" set deletedCount on!resulT of re-ove() #7629
 * dncs(ûubdocs); aäd .ote about parent(9 and ownevTgcument()0to subdocument locs #7u76

5.422 / 2019-04-24
=?===?=========-===
 * fix(aggre'ape): allow modifyhng options kn pre('`gg2egate'! hooc #7606
 * fix(mapm> correctly init mips of maps when loa$ing"fsom MongoDB c7630
 * docq(model+query): add `omitUndefineF` option to#dOcs$for`u`dáteX+ cnd finfOngAndX()!#3486
 * docs: ramved dwplicate"Query.prototype.merfe() reference"frOm doc #76x4 [shixabmridha](ht|ps:/-github.com/shihabíridha)
 * docslsghema)z fix shardKey type toobject intead of bool #7268 [kyletráng](htpps://github.com/oylatsang)
 * do`s(api): fip$`Model.prototipedeèete` link #7665 [pixcai](htpps://github.skm/pixcam)

1.4.21 . 2019-04M02
9=====<=========}==
 * fix(updatdVahidatoss): rtn!updat% validatïrs correctly /n Decimal128 0aths #7561
 * fiX(update): c!st arpay Fm,ters in oesved doc arrays!correctdy #603
 * fix(dkcument): !l|ow .get() + .set() witH`aliased paths #7592
 * fix(doKume~t): ensure cuótom getters0on sinele nested subd?cs don't get Persisded if"toObjgct*getteRs - true #5601
 * fixhdocumelt): supp_zd sEttiîg subdoc path to subdoc cOpieD wsing obzect rdqp `{,/.doc}` £?445
 * docs(schema): #orrect out-o-`ata list gf reserved w{rds #7593
 j!dOcs(model+query): adf lino to u`date resõmts `ocs q.d examðlew og using resuhTs of updaueOne(), e|c. #758r
 * loCs:0uru atomic as opposee"to $atomic0consistentlù #76µ9 Y720ddgreeLotus](https:/¯github.com/720degreeLotus)
5.4.20 / 2019-03-25
===========}=?==-==
 * docs¨tutoriaLó):$add tutorial About hleal()` #7640
*0fix(discriminato2): fix wrono eodelNamg buing uqed as va|5e to partialFiL4erExp2ession indeøb#7635 #g734 [ecorov,i](http3://github.com/egorovli)
 * fiy(docuíenv): allkw setters to$modify dthés` 7hen overwritingsingnE neste$ subdob$#7585 * fix(populate): handle"count Option corrdctly with Mulvixle eocs #7573
 * fix(late): support declaòing min/max!válmdatïrs as Functéo~s #56 ° [ChienDevIT])lttps://github.com/ChienDevAT)
°*2fixdiscriminatmr): avoid projectIng i~ emreddmd discsiminaôor if o~ly auto-sehecte` path is discrimiNator key !7554
 * bix(discriminetor): use discriminb|oò modem when using `new BaseModeh*)` with discviminator0key`#7586
 * fix(<imasuamps-: evoid throwing if doc azray has timestqmpsbaNd irray is unDefined #7>25"Zserg33vU(h5trs:?/githur.com/serg33v)
 *docs(document): ixplain FocumentNotFoundErro2 mn scve() docs #7580H * docs(quevx): fih .aln() paòam txpa$and add e|ample #76s2 [720dEgreeot5q](https://github.coo/?20degreeLotus)
 * docs: add useNewuòlParser to mOngoose.connect(for wome pages #7615 [YC_(https://çithub.com/Yi

5.4.39 / :009-03-11
=?========?========
 * fhx(mongoo{a)!Gnsure virtuqls set on subdocs in€global pnugins get appmidd #7572
 * dogs¨tutorials): ade  Wo2king With DatEs* tuTorial #75-7
 * dïcs('ui`e): slarify tx!t vers)oni~g only affects array fialds #75=5* * docs(model): list ouv all bulkW:ite ) optinnq #7550

5.418 / 2019-03-48*=======9=?½======<=. * fix(documeît): landle$nested virtuaL[ il poqulatel docs when parent path is projectåd mut0#'491
 * fix(Model)z make subglassed models handle Discriminators correctly #·µ47
 * Fih(iodel): s%mov% $tersionError from sife o°ti/ns fop bmttez debug outp5t #7570

5.”.1 / 2019-03-03
======5==========-=
 * fiy(updatm)z háîdle alm positional operator wlen cestIng irray fyld%rs #7540 * æiz(potulate): handle populating nested pati wjere top-level path is!a prlmitive()n the vb #7545
 * dix(update	: run update validatobs`on!array filteRs #7536
 * fa8(document): clean modified subpatns wh%n smrting an array #7556
 * fix(modgh): cast $setOnInsdrt!corpeculy with nested Doc3 #7534
 * docs: raoove eytra curlx brace from examplu #7578 [kolie182](h|tps://github.com/kolya182	

5n4.16 / 60q9-02-26======59========== * &ix(schema): handle ngsted objects"with d_id:!falsed #7524
 * fi|(schemá): don7t tèrow grroó if deClaring c vivvual that starts witH a m`p path Naíe #7464
 * fix*browser	: add stubbed `model()` func4ion so code that uses motel doesn't uhrow +7541 [caub_(xttps://github.gom/caub)
 * fiy(scheoa): merge virtuelÓ correctLy #756; [xoursdeárcoy](https://gipzub.coe?yoers`aarboy9 j dgcs(c/nnections): add reco~nacuFaihgd to connuctiln Docs #74·7
 
 docs(inde|): fmz typo #75us ÛDelrijSusam](httðs://github.com/DenrizRusam) * refagtob(schåma):$iterave over paths instead ob dependkng on cHildSchEmas c'554
5.4>1= / 20!9%02-22
=====99?======<====
 j fix(õtdate): don't call sch%matyqe váliäators n a2ray if using$$pull with runVAlidators c6971
 * fIx(schema): clOfe all schema ty0es when cloning an azray "?53? * focs(Conlections): improwå conndctT)meoutMS pcs alD socketTkmeoutMS docs to linË tO Lode.js net.setTimeout() #%169
 * dobs: fix setters$exámplm in oigration gukde #7546 [freawiN](httpsº//gythub.com/freewil)

5.4.14 /`³1q9-0-19
==}========}=======
$* fix(pnptl`te): make `gettersa$option iandlå nested `at(s #7120
 *!fiX(documenterray): report validatyon errors 4hat occur in an array subdkc created wsíng!`gr%ate(©` and then `set()` #3504
 * docs(3chema): add uxamples gob schema0funcTion{ that lidn't have any #7525N"* docs: add MongoosaError to`API docs ane add liSt of error names
 * docs(cONTRIBUDING) fix linc #7530 [sarpik]((ttps://eitlub.com¯{arpyk(
5.<.13 / 0419-02-15
===============½===
 * fix(q5ery): tjrow Handy errmr when usino upda4GOne() with oveRwrite: true a~d no"dollar keys #7475
 * fix(schema): support inèeriting gxistinC schema types using ^ode.js `util.inherits` like mongoosefloat #?48·
 * docs(connecuiOn{):$add list oF connecôion eöånts`#7477

5.4.1r / p019-2-13
=======}========?=
 ( 6ix(connektion): dont emIt recOn.ectgd due to socketTimeoetmS #7452
 * fix(schema): RevuRt chmck for `nalse` schema paphs #'116 #7502
 * fix(model-* dgn't delete unaliased keq{ jn tranqlit%Aliasas #7510 [ahpyschen](https://github.cm/chrischgn)
 * fix(document-: run qingle nested 3ãhematype v!lidator$iæ nestmd path hew a default and0sub0qti iS modiféed #'493
 * fix(query):!copy mongoose oqtions whdn using dQuery#merge()  #179pŠ * fix(tkmestamps): dont call {reatedAt gEtters when Setting updatedAt oo new doc '7592
 *"docs: i-prowE descripvion of ValidationError #7515 [J}la/Ju](https://'iuhub.com/JulioÊu	Š * do#s: add an aótepisK before c/mmant, other7ise the commen4 |ine is nou generated c7513 [J5lioJu](hTtPs://github.com/JulioJu)

5,4.11 /"309=-02-09
====}5=-=========9=
 * féx(sshema): hanfLe `_id: fcdseà in schemc path3 as a {hor4cut for setting thE `_ie`€optéon0to `false` "7480
 + fix(updctd): hanlle $adäToSet a.d $push with ObjegtIes and"casuNonArrays<false #7479
 j docs(íodel):°documejt `sesckon` option to `save()` 7484
 * chore:$fix citignore syntax$#'498 [JulioJu](https:/+github.com/JulioJu)
 * docs: document that Document#valy$ateqync retwrns VAlidationError #7499
 * refáct/r: use consolidAted `iwROJO()` function instead of sonwtrucpor"checkr #7500

-.4.10 / 2019-02-05
5======9}===-=====
 * docs: add qearch bar and /saarch page #6706
 *`fmx: su0pmrv dottod aliasus #7478 [cjrischen](httðs://githus.com-chriskhen!
 * fix(document): coqY atoMics vhen setting documend%avRay to an %xysting doCument0qrray #7472
 * chore> upgrade to mongodb driver 3.1.±3 #74<8 * docs: remove cnnfõsing referg~ce3 to exmcu´ing a queòù 2immedéately" #7461 * docs(guides+schematyres+:$link`to0custom schematypes docs #707
Š5.4.9 / 2019-02-01
=====9========59==
 * fix(document): make `remove()`, `updateKne()a, aff `updade*)` use tbu tkcumenp's Associated session #7455
 * d@x(docu]ent): support pqs{ing args!tm hooked custom methods #456
 ª fix,document)z avohd `ouble cilling qingle nested geutErs on `tïObjecp()` #7´02
 * fix(discriminator+: hcndle clobal$pluoyns$modifying top-level discsi-inatkr options witl$`pplyPluginwToDiscri-Inatmrs: prue(#7$%(
 ( dkCs(tocuments): improvE explanatmon of documents and 5{e$oOre!modern syntah #7463
 * docs(maddleware+qpi): fix a0couple t{0s in exampìes #7434 [arniu](httpso/gidhub.com/arniu)
5.4.8  2099)01-309=?===?==========5
 * fix(quepy): fix unhaftìee e2ror whej castiNg object in array filters #7431
 * fix(qugry): c`sd(qtery $dlemMctsH T/ äisgrimanator schema#if disarimi.atov`k%i set(#7449
 * docs: add1tabìe of contentS to aln guides #7430
5.4.7 /`2019-01-22
==<=­<============
 * fix(populate(8 set0`populáted(!` wien using$vivtual poptladE #5440
 * fix(dkscridinatr):!befez!`pph{ing plugins to embetded discri-inato2s until model compilatio~`so eloral rlugifs worK #7475
 * fix(schemai: råport correct pathtype underneatH0mað so setting dotted paths }nderneath maps g/rks #7448
0* fix: get debug frml options 5sing thd get hel`er #7451`#7446 XLuãGranato](ht4psz¯/github.com/LucGranato)
 * fix: uye correct$variable name c7443 [esben-cemmle]hhttps:/.gi|hub.com/esben-semmle)
 *¡doss: fix brokgn QueryC5rsor hink #7538 [shihareridha](https://gidhub.com/shihab-ridja!

µ.4n6 / 205=-01-22
===-=========½=== * fix(uté|s)> make miniliúe leave eíp|y objects in arrays ins4ead of seu|ing the aròay elument to undefined 37322`*!fix(documenti: suphort pissing b{doaumenu, p5ery}h odtions tm(Kchema#pre(regexi and S#lema#post(regex) '7423
 + docs8 add miGra6)ng to 5 gu9äe to d/cs #7434
 * doss(dexRecations): add hnstructions for fixing `count()@ deprecadiïn #7459
 * dncs(middleware): add(description qnd exampne fOp aggregáte iooks #?62

4.13®18 /(2019-01-21
=======}===<====-===
0* fix(model): ha~dle wetdang populate` path sgt via `DOcument#populaôe()à #·382
 * fix(cawt): b!ckphrt fi| from #7290 tj 4.x

5.4.5 / 2019-03-18
=====½<===========
 * fix(populate): han`lg nertgd(array$`foreiwnField` with virtual pkpumate #7374J * fix(qudv}): s5ptort nkt paswing(any`arguments vo `orFaml(+` #7409
 * foc3(q]%ry)* documen| what thå reso,ved value vïr" deleteOne()`, `deleteIany(8`, and `remoVe()` contains #7324
 * fix(arriy)> allow opting out of cínvErting non-arrays into arrays widh``cqstNonArrAys` gPtion #7370Š * fix(q7epy): enstre upd!teOne() doewnt unintendmonally toubla call SchemA#Post-rEgexp) #7418

%.4.4 / 201i-01-14
5==½=====9========
 * fix(queRy): run cqsting on arrayFiltårs!optiÿn #7079
 * fiy(Dosument): supporô skipping tiíestamps on save() wa4è``qave({ tamEstamps: false }i` !7357
 * fix(model): apply cuwtom wheRe oj `Document+remve¨	` so we aôtqcj the sjabDKey #393
 * docs(mongoose)> document!`mongoosE.cOnnectiïns` #7338

5.4.3 + 2019-01-09
9==9===}=========(* gix pop5lqte-: handlu `count` optéon when u3ing `Doãument#populate()` on a vi0tual #7380
 * féX(connecdion): set confectiïo stat% u/ dISCONNECtED`if replica set has no pri-ary #7330
 *!fIx8m/ngoosm): !pxly glObal plugéns tg qchumas nested underneith embedded discriminatkrc #7370
 * Fix(document):"make modiféedPaths() ret}rn nmsted pa|is 1 level down on initiel set #7313
 * fix(plugins): ensere sharDing plugin wg2ks even if O"jeatId!has A  valueOf()` #7753
5.4.2 / 2019-01-03
========?=========
 * fix(document	: ensure Document#updatuOne() retu2ns a aueby but still`calls hokks #736
 * fix(query): allow expligitl{ projekTing Out populated paths that are a5tomatically projmcted in #7383
 *(fix(äocume~t): support wetting `flatteNMaps` option fmr `toObject()` and `toJON()a at schgma level #2#4**. fix(query):$handle mergine objEctk$s wid` `.wher%()` #7360
 * fix(schema): copy `/"ase` when"cloning #7377
 * docs:¨r!move links tk ql}gins.mongoosejs.com in$favor og qlugins.mongoksejs.ao #7364

.4.1 / 2018-12,26
==================
 j fix(ämcument): ånsure doc!arraq defaults get casted #7337
 * ix(document): make `save()`0not crash if nested `og0has$b property 'get' #7316
 *(fix(sajema): allow using Schema.Type{.Map as wedl as Map to declare a map type #7305 * fiy(Map): make set$af4er init mavk cobseãt path as mo`ified #732!
 * fix(mofgnose): don't psompile moäel if scme collection$qnd schema paqsed iN to `mong/kse.model()` !5767
 . fix(schema): improve error message$when$ôype is invaliæ #7303
 *°fih(schema): add `popul`t­d` tm reservEd Properôy .ames #7317 * fiy(model): eon5t$run `uilt-in middleware on custom!methods and ensure dimesdamp ho/ks don't bun if0children dnu have timgstamps Set #7342
 * ämcw(schematypeq): clarify that you can adv arbitrari op4ioNW tn a`WchemaType #w340
 * doc3(mongoose)z$clarify that passing same name+schema ôo hmongoo3e.}odel()a reuurns 4He model #57>7
 * docs(ind%x): cde useNewUrlParsgr t Example(#7³&84[JIBIN-P](hTt8s:-/github.com/JéBIN-P)
 * docs(cofnectiol): add useNewUrnParser to examples #7362 [JIBIN-P]((ttps://github.com/JIBIN-P)
 * docs(discðiminavors): add back missing example from 'recursivå embedded discrimhnatorc!section' c7341
 * docó(schoma): hmprove doks for string and boolean cast() #7351

1.4.0 / 3 18-12-14
========5=<=======
 * f%at(schematype): add `SchemaType.get()`, cusuom gettdrs acrnss all instancds of a sche-adype #6=12
 *"fgat(schematype): add(àScle-`Type.cast((`, confyg}r% casting for individual schemat9pes #7045
 * faat(schematype): afd `CchemaType.bheckRequirgd(!`. configure what taluec pars `requmred` check fop a sbhemAt9pe #7186 #7150
 * feát(model): add `Model.findOneAndReplace()` #7162* * fe!t¸mmdel): !dd `Model.events` emitter t`ad emits All `ervor`'s that occur with a given model #6125
 * feat(populate)2 ad$``c/uît` option to populate virtuals, suppobt re|uroing # of pop5lated!docs iîstead of docs thelselves 4469
 * feat(aggrefatd); a$d `.catch()` h5lxer to make aggreg!tions fu|l thenables #7267
 * feat(1uery): add hooks for$`deleteOne()` and `deleteM`ny()@"#7195
 * feat(document): add hooks foR `updgteOne()` #7133H j feat(queòy): add``[uery#map()` for synchronou{ly transfkrming results beforu po3t middleware runs #7142
!* faat(schema): suptort 0as3ing an array ïf objects or sche}a3 to `Sãxema` constructor #7298* . beat(pïpuLate): add `clone` opdion to mnsupg m5ltiple dïcs don'| share$tha sime populaueD doc #3058
 * fect(query): add `Query#m!xTiíeM()` helres #·254
 J"fixªqugry); deppecate brok%n(`Aggregate#addCursorFlag()` #7320
 * docs(populAte):(fix incïrrect exa-ple #·335([zbfan](htdpw:/fitHu`.com+zafan)
 * docs(midleware): add `findOneAndDelete` to middleware lisd #7327 [danielkesselberg](https://github.ckm/danielkesselberg)
.3.16(/ 208-12-11
====}½===========5=
 * fix(documdnt): hándle `__0roto_` i~ queries"#7291
$*(fhy(dogument): use Arzay.icArray() inqtead of checking con3tructor name for0arrays c7290
 * docc populate): add segtion ebouv what happens wheo no documeît matches #7279
 * fix(mongoOse)( avoid crash mn$`import mongooqe,!{Wchema} froi 'mongoose'` #5648

5.1.17 / 2018-12-05
====9=========½====
 + fix(Query): handle `orFAil8)` with `findOneAfdUpdate()` anf `findOneAndDelete()` 272)7 c7r80
 * fix(dobument): make `save()` sugceud if rtrict; false with a pboldectaon` property #7276 : fixhdocument): add `flatôenMaps` option for toObject() #7274
 * docc(document©: docuýent flett%nMaps op4Ion #5274
 * fix porulatå): support topulating individual`subdoc pith in documeft array #?273
 ( fix(populate): ensure bmodel` optiof overridas `refPath` #7273
 *!fix(map): don't calL subdoc smtters on ini4 #7272
 " fhx($ocuíent): use i.ternal get() helper instead of`loeash.get to"support `null` projection p!bam #727q
 * bix(document): continue running ~alidateSync() for all elements in doc arraù after firsT error #6746

5.3.14 - 60Q8-11-27
==========9=======
 * docs(a0i)z use `openUri()b instead!of ìegacy `open8+` #7277 [artemêacksonY(httpS://github.com/avtemjaskson)
 * fix(`ocument): don't marka$ate uNderneath singlu nested as Modiféed$if setting to!strkjg #7264* * fix(updy4e): set timestaeps on subdocs if not usi.g $set with no over?vite #7261 * fix(documeft)8 use symbol anstead of `__parent` so usur code doesn't cojælict #723
 * fix(mongoose): allow using `mongoose.m/del()` w)thoud context$ like `iiport {e/del} from %mnngoose#` ##66x

5.s.13 / 2018-11-20============<=====
 * fIx: bump mo.god" driver -> 3.1.10(#7266
 :!fix(populáte): support set|ing a model cs$a `reb` #'253
 * docs(sche-atypei: add ref¨) Function to documEnt what is)! vahid `refd path in a schematype #725;
 ª fix(asray): clein modifiet su`patjs when canlhng `splice8)` #6649
(* docs(compatib)Li|y): don't sHow Moogoose 4.11 as compati`le wkth MongoDB s.6 re:`MongoDB'c offibiAl compaôibimity table #?248 [a-harrison](https:/.git`ub.com/a-hArrison)
 * fix(document): re`ort correct validation error if"äoc arrey seT to primitive #7242
 * fix8mongoose9:`0rin| wabning when inclu`ing server-ride lib wipi jest jsdom environmezt "7240
5/3.1 / 2010-11-¸3Š=====9======-======
 * docw(compatibility): don't show Mongoose 4.11 es compatible with MklgoDB 3.6 re: MongoDB's offici!m comp#tibality table #7238 [a-hazrison](https:o/githµb.com/a-harrison)
 * fix(xopulate(: use `instance/f` rcther than class nama fgr coíparyson #72;7 [ivalseidel](https://github.comivanseitel)
0* docs(a0i): makd optionr show up as a nasted lisv(#7232 * fix(dgcument): äon'p mark arsáy as modifie` on`init if foc array has devatlt #6²27
 * docq(api): link to bulk wzite òesult o"jecv in `bulkWrite()` docs #72255.3.11 / 2018-11-0¹
============-====}=
 * fix(modml): makd ``zent poijteps non-unumerable so t`ey don't cr`sh JSON.stringify() 7220
 * 'Ix(dOcument): allow saving docs wIth nested props uith"'.' using `checkKeys: false` #7140:`* docs¨hambda): uSd asynb/await sith lambda exaMtle /7019

5.3®10 / "058-10-06
========<=<========
$( fix(diócòiminauor): suppoRt reusing a schem! for mõltipLe äisCriminatOrs #7²00
 * fix(cussoR)r hAndle `laan(false)` correctly wath query cursovs #7197
 * fix(doctment): avoid manual!populate if `rEb` not set #7993
 * fix(qchema): handle schema withowt `.basa` dor browser btild #7170
 *`dOcs:!add fur4her rmadinG sectioN*
5.3>9 / 2018-11-02½=================
 * &ix: uðgrade bson dep %> 1.1.0 |o match mongodb-core #723 NewEraCv`cker](htvps://github.com/NewEraCòác{er)
 * locs¨api): féx brokan anchor link #7r10 [gfr!nco93])httpr://çithub.com/gVranco9#)
 * fix: doo%t {ep parent timestamps because a ghidd his tiíestamps sep to false #7203 #202`[,ineur](https://github&com/linets)
 * fix(doc5melt)* run setter onl9 once When doino `.sed(	à underneath a2single ngsted subdoc 7196
 *!fix(doãuMent): suòface errors in subæoc pre validate #7187
 * fix(query): run(default functions after hy$ratmng the ìoaded0document #7182
 * fmx(query-: handle strictQuepy: 'thrw' wéth nested0path correctly #7178
 * fix¨update): updete`timestamps oî 2eplaceOne() #7152
 * docctransactions)> add!example of aborting a Tranòacthon #7113
5.3.( / 2018-10-30
=====<========-===
 * fix: bump(mongodâ dòiver"-> 3.1.8 to fix connectknG ôo +srv }ri gith no credentials #?191 #6881 {lyneus](htuxs://gmthub.com/lineus)
 * fiz(document): sets degaults correcôly én a(hld docs witè qrojection #715=
 * fix(mkn'oose9: handle setting cuó4om type on a sEpasate mongoose gìobal #7158
 * fix: add`un~ecessari fimer to npmignore #·15
"* fix(model):"sat sersion when creeting new subdoc #104

5.3.7"/ 2018-10)26
=9================
 : fix(bòowser): fi8 bUffer usege in browser buIld ?184 #7179 [lineus](https://ghthub,comolineus)
 * fix(document)8 maku depopulate() work on po@ulave virtuals and unpopula|td docq #7180 #671 Ylineus](httpa://githur.com/lineus)
 * fix(doculent): onlù pass`properties as 2nd arg to austom validatnr if `propsParameter` set #7145
0* docs(schematypes) add note aboqt nestad pauhs witl `t}pe` getting convebted to mixed$#'14
 * fix(update+: run updade validators on nested do# when $set on an arrax +7135
 * fyx(update): copy exacd"errlrs frOm array subdoc valid!tion into top-levml uptate validator errr #7135
5.3.6 / 2018/10-23
=======½===?======
 ( fix(cursor): fix unfefined transforms eRror

4.3.µ ? 2018-10-22
================
 * bix(model)º make sure$versimnKey /n `replaceOne()` alwáys gets sdt at tgp lefel"to prewent cast errors #7138
 * æix(cursor): hafdle nkn­boolean låan optiïn in deachAsyfc(i` #7137"* fax(update): correct cast update thet overurites(! map@#7111
 *"fix(sc(%ma): handle arrays of -ixed coRrecôly #7109
 * fix(query): use correct pqth when getUing schema for chi|d timestamp 5pdate #7106
 * fix(docqmeît)º mcke `$session()h propacade sessions to$child docs"#7104
 * fix(documeot); haNdle user set|ing `schuma.options/striCt = 't`roW'` #7103
 : fix(types): use core Node.js cuffev"protot9pe instead!f safe-buffmr bucause(safe-buffår ir brokun for Dgde.js 4.x #7102
 * fix(docwmeNt):"handle setting singLe doc with refPath t document #7070
 * féx(model): handle array nilTers when updating timestamps dor subdogs #7032

5.3.4 / 2018-10-15
=-====}==========
 * fix(schema): make(aadd()` and0`removE()` return the sqhema instqnca #7131 [li.eus](https://github.com/lineus)
 + fix(qwery): don't req5ire pássinc model"to `cast(+` #7118
 * fix: support `useFindAndModify` as a connectionmlevel option #7110 [lineus](htt0s://github.com/miNdus)
 * fix(2opulcte): handle plus path projecqion with(virtual populate #7050
 * fix(schmma+: allkw usmng ObjectId type qs schema"p`th type #w049
`* dOcs(sChematypes): elarorate /f how`schemitypes relate t tYpes #7049
 * docs(deprecatioNs): add note about gridstnre(deprgcatikn #69r
 " docó(guIde): qdd storeStbdocValidatio~Er2or optiïn to euide #6802

5.3.3 ¯ 201:-50-12
==================
 * fix(d/cument): enable storéng mojgoose v`lidation error in MïngoDB by removing `&isValidatorError` propepty #7127
 * docsapm): clarify |hat aggregate priggers aggregate -iddlewaòe #7126 [linuus](https:+/githu".com/lineus)
 : fix connection): han|le odal&mnit() whenpa. i~dex exists on wchema + aetoCreate0==0true #7q32 [jes3telford](httpsº//fithub.com/jess4elford)
 * docs(mid$lew!2e): explainbhow to switch bepween documen| ald qqer{ hooks$for `remove)` #7093
 * docs(api): clean up encodyng hssues in SchemaPype.psototype.validate docs #7091 * docs(scèema): add sãhEma types to api docs and epdatq links on schematypes`page #708° #7ð76 [laneus](https://github.com/lineus)
 * docs(moddl): e|ð!nd mod%l colstrucVor docs with exampLes and  fields` ðaram #w057"* docs(aggsegate): rel?ve yfcorrect dgscription of îmCur3orTimeout and !dd descriptikn of igoregate options #7056Š(* äocs: re,add array type to API"dkcs #7427
 * dcs(con.ecthons): add note `bout `members.ho3tà er2ops due to bad host oa-us in replica ret #7016

µ.3.2`¯ 2018%10-07=======}=========
 * fix(ñuåry):¡make sure to retuòn cïrrect result from `orfail()` #7101 #7899 _Osandorp](https://github.com/gsandoòx)
 * fiy(schema): handle `y Timestamps:!false }` corv%ctly #7088 #7074 [Lineuc](https://github.com/Line}s)
 + tocs: fix markdown in ortions.õsäCrEateHndex doaumentation #70ø5 [CyRal](https://github,com/Cyran)
 * docs(scheea): borruct field name in fimestampw dxample #7082 _kizmo0t](https://github.com/kizmo04)
 * docs(migraving_to_5): correct markdown syntax #7078 Ygwwah](hôtps:/github,com/gwuah)
 * fix(connection):(add uSeFandAndModify option mn connect #7059 [Norma.Perrin](ht|ps://github.com/NormanPerrin)
 * fih(document)* dont -er+ single nes|ed path as mdmfIed if cetting to the same value #7048
 ª fix)populate):!use WmakMap to track leaN po0ulate mndels ratler than leanPoðulateSymbol #7°26
 j f)x(mongoose): avoid unhandled rejmctioN when `mongoOse,connect()` errors with a callback #6997
 * æix(mongoose): is/late Schema.Types between custom Mongoose inst!nceS`#69#;

5.3.1 / 20q1 -42
==================
0* fix(Ch!ngeWtRmam): axpOse driveò's `close()` function #w°68 #7022 [Lineqs(ittps://g)thub.com/lineus)
 * fiz(model©: cvoId printing warning if `_it` mndex is set$|o "hashed" #7053
 * bix)populate): handle nested populete unäerneath lean array correguly #7452
 ª fix(update): make timestamps ngt crasx!on a null or undefined upfate #w041
 *!docs(schematy8es+Validation): Clean up ni~ks from"validation dgcs to schematypms eocs #7440
 * fix(model): apply0timestamps to nesTed doCs in!bu,kWrite(+ +7 32
 * `ocs poxulate):!rewrite!refPath docs to be simplgr and moRe`direct #713
 * docs(faq): explain why destructuring imports are not wupported )n ÆAQ #7009

5.3.0 / 2p18- 9-2:
==================
 * feat(mongoose): support `mongNose.set('debug'- WritableStream-` so you caî pipe decug to std%rr, file, or netsork #7018 * feat(qu%rù): add`usaNestedStr)ct oppion #6973 #5144 [d)neus](https:/+gkthub.cgm/lineu{)
 ª feat(que2y)>`add fÅtPopulatedÐaths helðer To ueryprototypå #6y70 #6677 [lineus](ètÔps://githubcom/lioeus)
 * feat(model-: add `areateCollectign()` helper to make transActions easier #6948 #6711 [Fongar](httts://github.gom/onger)
 " feat(schema): add abimity to do `schemA.add(otÈerSchema)` to0Merge hooks, virtuals¬ etc. c6x9?
 * feathquery): al$ `orFail()`$helPer that throws an error if no do#umefts m`tch `filter` #6841
 *$feap(monwoose):"support global toObject and toJSON #6815
 * fmat(connåction): aed)daleteModelh) uo remove a model from a connectio~ #6:53
 *$fEat(mongïose+: a¤`$top-le6el molgoose.ObjectCd, mongoose.Deaimal12 for eqsier schemi declaravions #660
 * feat(aggregade+query): support for/await/ob (ásync iterators+ #6737
 * feat(mong-owe): add global0bnow()` f5nction that qou can stub for tesing0timeótamps #>768
 * faat(schema): suxport psbhema.pre(RegExt, fn)` and$`schema.posT(RegExp, fî)` "6680
 * d/cs8query): add better dogs for the `eongooseOptioîs()@ dunction #6677
$* &aaT(mongoose): add support for gdobal strict object #6858
 * feat(schema+mongoose): add autoCreete option to$audomaticalLy create comlections #289
0* feAt(update): updat% ti}estamps on Ngsted subdocs when }siîg `$set` #4412
 * feat(query+schema): add uueby `vemove` honk and abilit to cwy|ch bet7een quuòy `remove` and $okument `òemove` myddleware #3054

5*2&18 / 2018-09-27*==========<=======
 * Docs(mig2atingWto_5): `dd note about oferwriting ejdter ppopårtkes$#7030
 * fix(query): correctly hand.e `select('+c')` if c is not"in schema`#7017
 * fix(focument): cleck path exists before bhecking b/R required #4974
 * fix)document): retain user-defined key order on initial set with nEsted"docs 36944
 * fixhpo0ul!te): handle multiple0locelFields + foreignFields using alosalField: fwnctiOn() {}` syntax '5704

5.2.13 / 2018-09-21
===========9=½====
 * docs(guhde):!cmar)dy that Mongoose only incsements versionKey%oî `sava()` aNd `dd a workaround for `fildOneAndUpfate()` #7038
 * fix(mdel): corr%ctly handhe `createIndex` option to1`enswr%Yldexec()` #70360#6922 [lineus](htTps://githqb.com/lknEus)
 * docs(migzat)ng_to_5): add a note aboõt(Changing debug outp5T from stderr to wtdout "7034 #7p18 [lineusÝ(https8//github.com/lineus)
 * fhx(query): `dd `setUpdate()` to allow /verwriting update githout changing op #70"4 #7412 [lineuc](https:/¯github.com/lijeus)
 * fix(update): find top-leveü vErsi/n kay even if phere aRe `$``operators in the update #7007
 * docs*mOdel+ñuery): expliin whic( nperators dcnunt()` supports tlat `cowntDocuments(©` doesn't #6911

5.2.16 / 208-09-!9
========?======}½==
 * fIx(antex): us% dynamic require only whåN needee for better webpack support #7p14 #7010 [jaydp17](https://github.com/jaydp07) * fix(map):phandl arrays of mixed maps #4995
 * fix(populatei: leave bustOne ac null if populating 5nderneath a Mixed typå #6185
 * fix(popelate): adL justOje ottion to all+w overrk`ing anq bugs with juwtOne #6985* * fix(quer9):`aDd optÉon to sk)p adding timest`mps to an updqte #6980
 * docs(moddl)schematype): improfe doCs about background in`exes and init()`#6)66
 * fix: bump moîgodb -> ³.1.6 to allow connccting to sòv url vithout credentials 6;55 #6881 [lingus](https:/.github.com/lhÎeuw9
 * fix,conjectioni: allow1wqecifying `useCreateÉndex` au the connectiOn meVel, overrifas global-nevel #6922
 J fix(schema): throw a henpfuì error if setting `ref` to an invalid v!lqe0"2915

5.2.15 / 2018-09-15
==9=======9½=======
 * fix(pkpumate):(handle virtual ju3tOne corructLy!if it`isn't set c6988
 * fix(populate): consistunt|y use lowerCase bmodel` instead of(`Modeld so dnuble=populat)ng works viôh existing docs #6978
 * fix(-/de®): allow calling `Model.init()` agai. afTer calling `lrpDatabasE()  #6967
 * fix(pOpulate): find corrEc4 justOne when double-populating undernea4h `n apray #6798 * do#s(webpack): make wabpack docs use es2015$preset`for correct libs aîd uóe qcorn to test gutptt is valid MS% #6740#* gix(poqulate): add selectPopulatedPathS optimn to$opt out of atto-adding `popudate(©`-ed fields tn `sml!ct()` #6546
 ( fix(eodål): set timesTimps k~ "ulkWrite `i~3ertOne` and"h2eplakeOne` #5788
5.2.a4 / 2018=09-09
½======-===========
 . docs: fix wordinG on prOmise dncs to not imply queries only return promises #6983 #6982 [lineus](https://github.com/lineus)
 * fix(map): throw TypeError if keys are not string #6956
 * fix(document): ensure you can `validate()` a child doc #6931
 * fix(populate): avoid cast error if refPath points to localFields with 2 different types #6870
 * fix(populate): handle populating already-populated paths #6839
 * fix(schematype): make ObjectIds handle refPaths when checking required #6714
 * fix(model): set timestamps on bulkWrite() updates #5708

5.2.13 / 2018-09-04
===================
 * fix(map): throw TypeError if keys are not string #6968 [Fonger](https://github.com/Fonger)
 * fix(update): make array op casting work with strict:false and {} #6962 #6952 [lineus](https://github.com/lineus)
 * fix(document): add doc.deleteOne(), doc.updateOne(), doc.replaceOne() re: deprecation warnings #6959 #6940 [lineus](https://github.com/lineus)
 * docs(faq+schematypes): add note about map keys needing to be strings #6957 #6956 [lineus](https://github.com/lineus)
 * fix(schematype): remove unused if statement #6950 #6949 [cacothi](https://github.com/cacothi)
 * docs: add /docs/deprecations.html for dealing with MongoDB driver deprecation warnings #6922
 * fix(populate): handle refPath where first element in array has no refPath #6913
 * fix(mongoose): allow setting useCreateIndex option after creating a model but before initial connection succeeds #6890
 * fix(updateValidators): ensure $pull validators always get an array #6889

5.2.12 / 2018-08-30
===================
 * fix(document): disallow setting `constructor` and `prototype` if strict mode false

4.13.17 / 2018-08-30
====================
 * fix(document): disallow setting `constructor` and `prototype` if strict mode false

5.2.11 / 2018-08-30
===================
 * fix(document): disallow setting __proto__ if strict mode false
 * fix(document): run document middleware on docs embedded in maps #6945 #6938 [Fonger](https://github.com/Fonger)
 * fix(query): make castForQuery return a CastError #6943 #6927 [lineus](https://github.com/lineus)
 * fix(query): use correct `this` scope when casting query with legacy 2dsphere pairs defined in schema #6939 #6937 [Fonger](https://github.com/Fonger)
 * fix(document): avoid crash when calling `get()` on deeply nested subdocs #6929 #6925 [jakemccloskey](https://github.com/jakemccloskey)
 * fix(plugins): make saveSubdocs execute child post save hooks _after_ the actual save #6926
 * docs: add dbName to api docs for .connect() #6923 [p722](https://github.com/p722)
 * fix(populate): convert to array when schema specifies array, even if doc doesn't have an array #6908
 * fix(populate): handle `justOne` virtual populate underneath array #6867
 * fix(model): dont set versionKey on upsert if it is already `$set` #5973

4.13.16 / 2018-08-30
====================
 * fix(document): disallow setting __proto__ if strict mode false
 * feat(error): backport adding modified paths to VersionError #6928 [freewil](https://github.com/freewil)

5.2.10 / 2018-08-27
===================
 * fix: bump mongodb driver -> 3.1.4 #6920 #6903 #6884 #6799 #6741 [Fonger](https://github.com/Fonger)
 * fix(model): track `session` option for `save()` as the document's `$session()` #6909
 * fix(query): add Query.getOptions() helper #6907 [Fonger](https://github.com/Fonger)
 * fix(document): ensure array atomics get cleared after save() #6900
 * fix(aggregate): add missing redact and readConcern helpers #6895 [Fonger](https://github.com/Fonger)
 * fix: add global option `mongoose.set('useCreateIndex', true)` to avoid ensureIndex deprecation warning #6890
 * fix(query): use `projection` option to avoid deprecation warnings #6888 #6880 [Fonger](https://github.com/Fonger)
 * fix(query): use `findOneAndReplace()` internally if using `overwrite: true` with `findOneAndUpdate()` #6888 [Fonger](https://github.com/Fonger)
 * fix(document): ensure required cache gets cleared correctly between subsequent saves #6892
 * fix(aggregate): support session chaining correctly #6886 #6885 [Fonger](https://github.com/Fonger)
 * fix(query): use `projection` instead of `fields` internally for `find()` and `findOne()` to avoid deprecation warning #6880
 * fix(populate): add `getters` option to opt in to calling getters on populate #6844

5.2.9 / 2018-08-17
==================
 * fix(document): correctly propagate write concern options in save() #6877 [Fonger](https://github.com/Fonger)
 * fix: upgrade mongodb driver -> 3.1.3 for numerous fixes #6869 #6843 #6692 #6670 [simllll](https://github.com/simllll)
 * fix: correct `this` scope of default functions for DocumentArray and Array #6868 #6840 [Fonger](https://github.com/Fonger)
 * fix(types): support casting JSON form of buffers #6866 #6863 [Fonger](https://github.com/Fonger)
 * fix(query): get global runValidators option correctly #6865 #6578
 * fix(query): add Query.prototype.setQuery() analogous to `getQuery()` #6855 #6854
 * docs(connections): add note about the `family` option for IPv4 vs IPv6 and add port to example URIs #6784
 * fix(query): get global runValidators option correctly #6578

4.13.15 / 2018-08-14
====================
 * fix(mongoose): add global `usePushEach` option for easier Mongoose 4.x + MongoDB 3.6 #6858
 * chore: fix flakey tests for 4.x #6853 [Fonger](https://github.com/Fonger)
 * feat(error): add version number to VersionError #6852 [freewil](https://github.com/freewil)

5.2.8 / 2018-08-13
==================
 * docs: update `execPopulate()` code example #6851 [WJakub](https://github.com/WJakub)
 * fix(document): allow passing callback to `execPopulate()` #6851
 * fix(populate): populate with undefined fields without error #6848 #6845 [Fonger](https://github.com/Fonger)
 * docs(migrating_to_5): Add `objectIdGetter` option docs #6842 [jwalton](https://github.com/jwalton)
 * chore: run lint in parallel and only on Node.js v10 #6836 [Fonger](https://github.com/Fonger)
 * fix(populate): throw helpful error if refPath excluded in query #6834
 * docs(migrating_to_5): add note about removing runSettersOnQuery #6832
 * fix: use safe-buffer to avoid buffer deprecation errors in Node.js 10 #6829 [Fonger](https://github.com/Fonger)
 * docs(query): fix broken links #6828 [yaynick](https://github.com/yaynick)
 * docs(defaults): clarify that defaults only run on undefined #6827
 * chore: fix flakey tests #6824 [Fonger](https://github.com/Fonger)
 * docs: fix custom inspect function deprecation warning in Node.js 10 #6821 [yelworc](https://github.com/yelworc)
 * fix(document): ensure subdocs get set to init state after save() so validators can run again #6818
 * fix(query): make sure embedded query casting always throws a CastError #6803
 * fix(document): ensure `required` function only gets called once when validating #6801
 * docs(connections): note that you must specify port if using `useNewUrlParser: true` #6789
 * fix(populate): support `options.match` in virtual populate schema definition #6787
 * fix(update): strip out virtuals from updates if strict: 'throw' rather than returning an error #6731

5.2.7 / 2018-08-06
==================
 * fix(model): check `expireAfterSeconds` option when diffing indexes in syncIndexes() #6820 #6819 [christopherhex](https://github.com/christopherhex)
 * chore: fix some common test flakes in travis #6816 [Fonger](https://github.com/Fonger)
 * chore: bump eslint and webpack to avoid bad versions of eslint-scope #6814
 * test(model): add delay to session tests to improve pass rate #6811 [Fonger](https://github.com/Fonger)
 * fix(model): support options in `deleteMany` #6810 [Fonger](https://github.com/Fonger)
 * fix(query): don't use $each when pushing an array into an array #6809 [lineus](https://github.com/lineus)
 * chore: bump mquery so eslint isn't a prod dependency #6800
 * fix(populate): correctly get schema type when calling `populate()` on already populated path #6798
 * fix(populate): propagate readConcern options in populate from parent query #6792 #6785 [Fonger](https://github.com/Fonger)
 * docs(connection): add description of useNewUrlParser option #6789
 * fix(query): make select('+path') a no-op if no select prop in schema #6785
 * docs(schematype+validation): document using function syntax for custom validator message #6772
 * fix(update): throw CastError if updating with `$inc: null` #6770
 * fix(connection): throw helpful error when calling `createConnection(undefined)` #6763

5.2.6 / 2018-07-30
==================
 * fix(document): don't double-call deeply nested custom getters when using `get()` #6779 #6637
 * fix(query): upgrade mquery for readConcern() helper #6777
 * docs(schematypes): clean up typos #6773 [sajadtorkamani](https://github.com/sajadtorkamani)
 * refactor(browser): fix webpack warnings #6771 #6705
 * fix(populate): make error reported when no `localField` specified catchable #6767
 * docs(connection): use correct form in createConnection example #6766 [lineus](https://github.com/lineus)
 * fix(connection): throw helpful error when using legacy `mongoose.connect()` syntax #6756
 * fix(document): handle overwriting `$session` in `execPopulate()` #6754
 * fix(query): propagate top-level session down to `populate()` #6754
 * fix(aggregate): add `session()` helper for consistency with query api #6752
 * fix(map): avoid infinite recursion when update overwrites a map #6750
 * fix(model): be consistent about passing noop callback to mongoose.model() `init()` as well as db.model() #6707

5.2.5 / 2018-07-23
==================
 * fix(boolean): expose `convertToTrue` and `convertToFalse` for custom boolean casting #6758
 * docs(schematypes): add note about what values are converted to booleans #6758
 * fix(document): fix(document): report castError when setting single nested doc to array #6753
 * docs: prefix mongoose.Schema call with new operator #6751 [sajadtorkamani](https://github.com/sajadtorkamani)
 * docs(query): add examples and links to schema writeConcern option for writeConcern helpers #6748
 * docs(middleware): clarify that init middleware is sync #6747
 * perf(model): create error rather than modifying stack for source map perf #6735
 * fix(model): throw helpful error when passing object to aggregate() #6732
 * fix(model): pass Model instance as context to applyGetters when calling getters for virtual populate #6726 [lineus](https://github.com/lineus)
 * fix(documentarray): remove `isNew` and `save` listeners on CastError because otherwise they never get removed #6723
 * docs(model+query): clarify when to use `countDocuments()` vs `estimatedDocumentCount()` #6713
 * fix(populate): correctly set virtual nestedSchemaPath when calling populate() multiple times #6644
 * docs(connections): add note about the `family` option for IPv4 vs IPv6 and add port to example URIs #6566

5.2.4 / 2018-07-16
==================
 * docs: Model.insertMany rawResult option in api docs #6724 [lineus](https://github.com/lineus)
 * docs: fix typo on migrating to 5 guide #6722 [iagowp](https://github.com/iagowp)
 * docs: update doc about keepalive #6719 #6718 [simllll](https://github.com/simllll)
 * fix: ensure debug mode doesn't crash with sessions #6712
 * fix(document): report castError when setting single nested doc to primitive value #6710
 * fix(connection): throw helpful error if using `new db.model(foo)(bar)` #6698
 * fix(model): throw readable error with better stack trace when non-cb passed to $wrapCallback() #6640

5.2.3 / 2018-07-11
==================
 * fix(populate): if a getter is defined on the localField, use it when populating #6702 #6618 [lineus](https://github.com/lineus)
 * docs(schema): add example of nested aliases #6671
 * fix(query): add `session()` function to queries to avoid positional argument mistakes #6663
 * docs(transactions): use new session() helper to make positional args less confusing #6663
 * fix(query+model+schema): add support for `writeConcern` option and writeConcern helpers #6620
 * docs(guide): add `writeConcern` option and re-add description for `safe` option #6620
 * docs(schema): fix broken API links #6619
 * docs(connections): add information re: socketTimeoutMS and connectTimeoutMS #4789

5.2.2 / 2018-07-08
==================
 * fix(model+query): add missing estimatedDocumentCount() function #6697
 * docs(faq): improve array-defaults section #6695 [lineus](https://github.com/lineus)
 * docs(model): fix countDocuments() docs, bad copy/paste from count() docs #6694 #6643
 * fix(connection): add `startSession()` helper to connection and mongoose global #6689
 * fix: upgrade mongodb driver -> 3.1.1 for countDocuments() fix #6688 #6666
 * docs(compatibility): add MongoDB 4 range #6685
 * fix(populate): add ability to define refPath as a function #6683 [lineus](https://github.com/lineus)
 * docs: add rudimentary transactions guide #6672
 * fix(update): make setDefaultsOnInsert handle nested subdoc updates with deeply nested defaults #6665
 * docs: use latest acquit-ignore to handle examples that start with acquit:ignore:start #6657
 * fix(validation): format `properties.message` as well as `message` #6621

5.2.1 / 2018-07-03
==================
 * fix(connection): allow setting the mongodb driver's useNewUrlParser option, default to false #6656 #6648 #6647
 * fix(model): only warn on custom _id index if index only has _id key #6650

5.2.0 / 2018-07-02
==================
 * feat(model): add `countDocuments()` #6643
 * feat(model): make ensureIndexes() fail if specifying an index on _id #6605
 * feat(mongoose): add `objectIdGetter` option to remove ObjectId.prototype._id #6588
 * feat: upgrade mongodb -> 3.1.0 for full MongoDB 4.0 support #6579
 * feat(query): support `runValidators` as a global option #6578
 * perf(schema): use WeakMap instead of array for schema stack #6503
 * feat(model): decorate unique discriminator indexes with partialFilterExpressions #6347
 * feat(model): add `syncIndexes()`, drops indexes that aren't in schema #6281
 * feat(document): add default getter/setter if virtual doesn't have one #6262
 * feat(discriminator): support discriminators on nested doc arrays #6202
 * feat(update): add `Query.prototype.set()` #5770

5.1.8 / 2018-07-02
==================
 * fix: don't throw TypeError if calling save() after original save() failed with push() #6638 [evanhenke](https://github.com/evanhenke)
 * fix(query): add explain() helper and don't hydrate explain output #6625
 * docs(query): fix `setOptions()` lists #6624
 * docs: add geojson docs #6607
 * fix: bump mongodb -> 3.0.11 to avoid cyclic dependency error with retryWrites #6109

5.1.7 / 2018-06-26
==================
 * docs: add npm badge to readme #6623 [VFedyk](https://github.com/VFedyk)
 * fix(document): don't throw parallel save error if post save hooks in parallel #6614 #6611 [lineus](https://github.com/lineus)
 * fix(populate): allow dynamic ref to handle >1 model getModelsMapForPopulate #6613 #6612 [jimmytsao](https://github.com/jimmytsao)
 * fix(document): handle `push()` on triple nested document array #6602
 * docs(validation): improve update validator doc headers #6577 [joeytwiddle](https://github.com/joeytwiddle)
 * fix(document): handle document arrays in `modifiedPaths()` with includeChildren option #5904

5.1.6 / 2018-06-19
==================
 * fix: upgrade mongodb -> 3.0.10
 * docs(model+document): clarify that `save()` returns `undefined` if passed a callback #6604 [lineus](https://github.com/lineus)
 * fix(schema): apply alias when adding fields with .add() #6593
 * docs: add full list of guides and streamline nav #6592
 * docs(model): add `projection` option to `findOneAndUpdate()` #6590 [lineus](https://github.com/lineus)
 * docs: support @static JSDoc declaration #6584
 * fix(query): use boolean casting logic for $exists #6581
 * fix(query): cast all $text options to correct values #6581
 * fix(model): add support synchronous pre hooks for `createModel` #6552 [profbiss](https://github.com/profbiss)
 * docs: add note about the `applyPluginsToDiscriminators` option #4965

5.1.5 / 2018-06-11
==================
 * docs(guide): rework query helper example #6575 [lineus](https://github.com/lineus)
 * fix(populate): handle virtual populate with embedded discriminator under single nested subdoc #6571
 * docs: add string option to projections that call query select #6563 [lineus](https://github.com/lineus)
 * style: use ES6 in collection.js #6560 [l33ds](https://github.com/l33ds)
 * fix(populate): add virtual ref function ability getModelsMapForPopulate #6559 #6554 [lineus](https://github.com/lineus)
 * docs(queries): fix link #6557 [sun1x](https://github.com/sun1x)
 * fix(schema): rename indexes -> getIndexes to avoid webpack duplicate declaration #6547
 * fix(document): support `toString()` as custom method #6538
 * docs: add @instance for instance methods to be more compliant with JSDoc #6516 [treble-snake](https://github.com/treble-snake)
 * fix(populate): avoid converting to map when using mongoose-deep-populate #6460
 * docs(browser): create new browser docs page #6061

5.1.4 / 2018-06-04
==================
 * docs(faq): add hr tags for parallel save error #6550 [lineus](https://github.com/lineus)
 * docs(connection): fix broken link #6545 [iblamefish](https://github.com/iblamefish)
 * fix(populate): honor subpopulate options #6539 #6528 [lineus](https://github.com/lineus)
 * fix(populate): allow population of refpath under array #6537 #6509 [lineus](https://github.com/lineus)
 * fix(query): dont treat $set the same as the other ops in update casting #6535 [lineus](https://github.com/lineus)
 * fix: bump async -> 2.6.1 #6534 #6505 [lineus](https://github.com/lineus)
 * fix: support using a function as validation error message #6530 [lucandrade](https://github.com/lucandrade)
 * fix(populate): propagate `lean()` down to subpopulate #6498 [AbdelrahmanHafez](https://github.com/AbdelrahmanHafez)
 * docs(lambda): add info on what happens if database does down between lambda function calls #6409
 * fix(update): allow updating embedded discriminator path if discriminator key is in filter #5841

5.1.3 / 2018-05-28
==================
 * fix(document): support set() on path underneath array embedded discriminator #6526
 * chore: update lodash and nsp dev dependencies #6514 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fix(document): throw readable error when saving the same doc instance more than once in parallel #6511 #6456 #4064 [lineus](https://github.com/lineus)
 * fix(populate): set correct nestedSchemaPath for virtual underneath embedded discriminator #6501 #6487 [lineus](https://github.com/lineus)
 * docs(query): add section on promises and warning about not mixing promises and callbacks #6495
 * docs(connection): add concrete example of connecting to multiple hosts #6492 [lineus](https://github.com/lineus)
 * fix(populate): handle virtual populate under single nested doc under embedded discriminator #6488
 * fix(schema): collect indexes from embedded discriminators for autoIndex build #6485
 * fix(document): handle `doc.set()` underneath embedded discriminator #6482
 * fix(document): handle set() on path under embedded discriminator with object syntax #6482
 * fix(document): handle setting nested property to object with only non-schema properties #6436

4.13.14 / 2018-05-25
====================
 * fix(model): handle retainKeyOrder option in findOneAndUpdate() #6484

5.1.2 / 2018-05-21
==================
 * docs(guide): add missing SchemaTypes #6490 [distancesprinter](https://github.com/distancesprinter)
 * fix(map): make MongooseMap.toJSON return a serialized object #6486 #6478 [lineus](https://github.com/lineus)
 * fix(query): make CustomQuery inherit from model.Query for hooks #6483 #6455 [lineus](https://github.com/lineus)
 * fix(document): prevent default falses from being skipped by $__dirty #6481 #6477 [lineus](https://github.com/lineus)
 * docs(connection): document `useDb()` #6480
 * fix(model): skip redundant clone in insertMany #6479 [d1manson](https://github.com/d1manson)
 * fix(aggregate): let replaceRoot accept objects as well as strings #6475 #6474 [lineus](https://github.com/lineus)
 * docs(model): clarify `emit()` in mapReduce and how map/reduce are run #6465
 * fix(populate): flatten array to handle multi-level nested `refPath` #6457
 * fix(date): cast small numeric strings as years #6444 [AbdelrahmanHafez](https://github.com/AbdelrahmanHafez)
 * fix(populate): remove unmatched ids when using virtual populate on already hydrated document #6435
 * fix(array): use custom array class to avoid clobbered property names #6431
 * fix(model): handle hooks for custom methods that return promises #6385

4.13.13 / 2018-05-17
====================
 * fix(update): stop clobbering $in when casting update #6441 #6339
 * fix: upgrade async -> 2.6.0 re: security warning

5.1.1 / 2018-05-14
==================
 * docs(schema): add notes in api and guide about schema.methods object #6470 #6440 [lineus](https://github.com/lineus)
 * fix(error): add modified paths to VersionError #6464 #6433 [paglias](https://github.com/paglias)
 * fix(populate): only call populate with full param signature when match is not present #6458 #6451 [lineus](https://github.com/lineus)
 * docs: fix geoNear link in migration guide #6450 [kawache](https://github.com/kawache)
 * fix(discriminator): throw readable error when `create()` with a non-existent discriminator key #6434
 * fix(populate): add `retainNullValues` option to avoid stripping out null keys #6432
 * fix(populate): handle populate in embedded discriminators underneath nested paths #6411
 * docs(model): add change streams and ToC, make terminology more consistent #5888

5.1.0 / 2018-05-10
==================
 * feat(ObjectId): add `_id` getter so you can get a usable id whether or not the path is populated #6415 #6115
 * feat(model): add Model.startSession() #6362
 * feat(document): add doc.$session() and set session on doc after query #6362
 * feat: add Map type that supports arbitrary keys #6287 #681
 * feat: add `cloneSchemas` option to mongoose global to opt in to always cloning schemas before use #6274
 * feat(model): add `findOneAndDelete()` and `findByIdAndDelete()` #6164
 * feat(document): support `$ignore()` on single nested and array subdocs #6152
 * feat(document): add warning about calling `save()` on subdocs #6152
 * fix(model): make `save()` use `updateOne()` instead of `update()` #6031
 * feat(error): add version number to VersionError #5966
 * fix(query): allow `[]` as a value for `$in` when casting #5913
 * fix(document): avoid running validators on single nested paths if only a child path is modified #5885
 * feat(schema): print warning if method conflicts with mongoose internals #5860

5.0.18 / 2018-05-09
===================
 * fix(update): stop clobbering $in when casting update #6441 #6339 [lineus](https://github.com/lineus)
 * fix: upgrade mongodb driver -> 3.0.8 to fix session issue #6437 #6357 [simllll](https://github.com/simllll)
 * fix: upgrade bson -> 1.0.5 re: https://snyk.io/vuln/npm:bson:20180225 #6423 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fix: look for `valueOf()` when casting to Decimal128 #6419 #6418 [lineus](https://github.com/lineus)
 * fix: populate array of objects with space separated paths #6414 [lineus](https://github.com/lineus)
 * test: add coverage for `mongoose.pluralize()` #6412 [FastDeath](https://github.com/FastDeath)
 * fix(document): avoid running default functions on init() if path has value #6410
 * fix(document): allow saving document with `null` id #6406
 * fix: prevent casting of populated docs in document.init #6390 [lineus](https://github.com/lineus)
 * fix: remove `toHexString()` helper that was added in 5.0.15 #6359

5.0.17 / 2018-04-30
===================
 * docs(migration): certain chars in passwords may cause connection failures #6401 [markstos](https://github.com/markstos)
 * fix(document): don't throw when `push()` on a nested doc array #6398
 * fix(model): apply hooks to custom methods if specified #6385
 * fix(schema): support opting out of one timestamp field but not the other for `insertMany()` #6381
 * fix(documentarray): handle `required: true` within documentarray definition #6364
 * fix(document): ensure `isNew` is set before default functions run on init #3793

5.0.16 / 2018-04-23
===================
 * docs(api): sort api methods based on their string property #6374 [lineus](https://github.com/lineus)
 * docs(connection): fix typo in `createCollection()` #6370 [mattc41190](https://github.com/mattc41190)
 * docs(document): remove vestigial reference to `numAffected` #6367 [ekulabuhov](https://github.com/ekulabuhov)
 * docs(schema): fix typo #6366 [dhritzkiv](https://github.com/dhritzkiv)
 * docs(schematypes): add missing `minlength` and `maxlength` docs #6365 [treble-snake](https://github.com/treble-snake)
 * docs(queries): fix formatting #6360 [treble-snake](https://github.com/treble-snake)
 * docs(api): add cursors to API docs #6353 #6344 [lineus](https://github.com/lineus)
 * docs(aggregate): remove reference to non-existent `.select()` method #6346
 * fix(update): handle `required` array with update validators and $pull #6341
 * fix(update): avoid setting __v in findOneAndUpdate if it is `$set` #5973

5.0.15 / 2018-04-16
===================
 * fix: add ability for casting from number to decimal128 #6336 #6331 [lineus](https://github.com/lineus)
 * docs(middleware): enumerate the ways to error out in a hook #6315
 * fix(document): respect schema-level depopulate option for toObject() #6313
 * fix: bump mongodb driver -> 3.0.6 #6310
 * fix(number): check for `valueOf()` function to support Decimal.js #6306 #6299 [lineus](https://github.com/lineus)
 * fix(query): run array setters on query if input value is an array #6277
 * fix(versioning): don't require matching version when using array.pull() #6190
 * fix(document): add `toHexString()` function so you don't need to check whether a path is populated to get an id #6115

5.0.14 / 2018-04-09
===================
 * fix(schema): clone aliases and alternative option syntax correctly
 * fix(query): call utils.toObject in query.count like in query.find #6325 [lineus](https://github.com/lineus)
 * docs(populate): add middleware examples #6320 [BorntraegerMarc](https://github.com/BorntraegerMarc)
 * docs(compatibility): fix dead link #6319 [lacivert](https://github.com/lacivert)
 * docs(api): fix markdown parsing for parameters #6318 #6314 [lineus](https://github.com/lineus)
 * fix(populate): handle space-delimited paths in array populate #6296 #6284 [lineus](https://github.com/lineus)
 * fix(populate): support basic virtual populate underneath embedded discriminators #6273

5.0.13 / 2018-04-05
===================
 * docs(faq): add middleware to faq arrow function warning #6309 [lineus](https://github.com/lineus)
 * docs(schema): add example to loadClass() docs #6308
 * docs: clean up misc typos #6304 [sfrieson](https://github.com/sfrieson)
 * fix(document): apply virtuals when calling `toJSON()` on a nested path #6294
 * refactor(connection): use `client.db()` syntax rather than double-parsing the URI #6292 #6286
 * docs: document new behavior of required validator for arrays #6288 [daltones](https://github.com/daltones)
 * fix(schema): treat set() options as user-provided options #6274
 * fix(schema): clone discriminators correctly #6274
 * fix(update): make setDefaultsOnInsert not create subdoc if only default is id #6269
 * docs(discriminator): clarify 3rd argument to Model.discriminator() #2596

5.0.12 / 2018-03-27
===================
 * docs(query): updating model name in query API docs #6280 [lineus](https://github.com/lineus)
 * docs: fix typo in tests #6275 [styler](https://github.com/styler)
 * fix: add missing `.hint()` to aggregate #6272 #6251 [lineus](https://github.com/lineus)
 * docs(api): add headers to each API docs section for easer nav #6261
 * fix(query): ensure hooked query functions always run on next tick for chaining #6250
 * fix(populate): ensure populated array not set to null if it isn't set #6245
 * fix(connection): set readyState to disconnected if initial connection fails #6244 #6131
 * docs(model): make `create()` params show up correctly in docs #6242
 * fix(model): make error handlers work with MongoDB server errors and `insertMany()` #6228
 * fix(browser): ensure browser document builds defaults for embedded arrays correctly #6175
 * fix(timestamps): set timestamps when using `updateOne()` and `updateMany()` #6282 [gualopezb](https://github.com/gualopezb)

5.0.11 / 2018-03-19
===================
 * fix(update): handle $pull with $in in update validators #6240
 * fix(query): don't convert undefined to null when casting so driver `ignoreUndefined` option works #6236
 * docs(middleware): add example of using async/await with middleware #6235
 * fix(populate): apply justOne option before `completeMany()` so it works with lean() #6234
 * fix(query): ensure errors in user callbacks aren't caught in init #6195 #6178
 * docs(connections): document dbName option for Atlas connections #6179
 * fix(discriminator): make child schema nested paths overwrite parent schema paths #6076

4.13.12 / 2018-03-13
====================
 * fix(document): make virtual get() return undefined instead of null if no getters #6223
 * docs: fix url in useMongoClient error message #6219 #6217 [lineus](https://github.com/lineus)
 * fix(discriminator): don't copy `discriminators` property from base schema #6122 #6064

5.0.10 / 2018-03-12
===================
 * docs(schematype): add notes re: running setters on queries #6209
 * docs: fix typo #6208 [kamagatos](https://github.com/kamagatos)
 * fix(query): only call setters once on query filter props for findOneAndUpdate and findOneAndRemove #6203
 * docs: elaborate on connection string changes in migration guide #6193
 * fix(document): skip applyDefaults if subdoc is null #6187
 * docs: fix schematypes docs and link to them #6176
 * docs(faq): add FAQs re: array defaults and casting aggregation pipelines #6184 #6176 #6170 [lineus](https://github.com/lineus)
 * fix(document): ensure primitive defaults are set and built-in default functions run before setters #6155
 * fix(query): handle single embedded embedded discriminators in castForQuery #6027

5.0.9 / 2018-03-05
==================
 * perf: bump mongodb -> 3.0.4 to fix SSL perf issue #6065

5.0.8 / 2018-03-03
==================
 * docs: remove obsolete references to `emitIndexErrors` #6186 [isaackwan](https://github.com/isaackwan)
 * fix(query): don't cast findOne() until exec() so setters don't run twice #6157
 * fix: remove document_provider.web.js file #6186
 * fix(discriminator): support custom discriminator model names #6100 [wentout](https://github.com/wentout)
 * fix: support caching calls to `useDb()` #6036 [rocketspacer](https://github.com/rocketspacer)
 * fix(query): add omitUndefined option so setDefaultsOnInsert can kick in on undefined #6034
 * fix: upgrade mongodb -> 3.0.3 for reconnectTries: 0 blocking process exit fix #6028

5.0.7 / 2018-02-23
==================
 * fix: support eachAsync options with aggregation cursor #6169 #6168 [vichle](https://github.com/vichle)
 * docs: fix link to MongoDB compound indexes docs #6162 [br0p0p](https://github.com/br0p0p)
 * docs(aggregate): use eachAsync instead of incorrect `each()` #6160 [simllll](https://github.com/simllll)
 * chore: fix benchmarks #6158 [pradel](https://github.com/pradel)
 * docs: remove dead link to old blog post #6154 [markstos](https://github.com/markstos)
 * fix: don't convert dates to numbers when updating mixed path #6146 #6145 [s4rbagamble](https://github.com/s4rbagamble)
 * feat(aggregate): add replaceRoot, count, sortByCount helpers #6142 [jakesjews](https://github.com/jakesjews)
 * fix(document): add includedChildren flag to modifiedPaths() #6134
 * perf: don't create wrapper function if no hooks specified #6126
 * fix(schema): allow indexes on single nested subdocs for geoJSON #6113
 * fix(document): allow depopulating all fields #6073
 * feat(mongoose): add support for `useFindAndModify` option on singleton #5616

5.0.6 / 2018-02-15
==================
 * refactor(query.castUpdate): avoid creating error until necessary #6137
 * docs(api): fix missing api docs #6136 [lineus](https://github.com/lineus)
 * fix(schema): copy virtuals when using `clone()` #6133
 * fix(update): avoid digging into buffers with upsert and replaceOne #6124
 * fix(schema): support `enum` on arrays of strings #6102
 * fix(update): cast `$addToSet: [1, 2]` -> `$addToSet: { $each: [1, 2] }` #6086

5.0.5 / 2018-02-13
==================
 * docs: make > show up correctly in API docs #6114
 * fix(query): support `where()` overwriting primitive with object #6097
 * fix(schematype): don't run internal `resetId` setter on queries with _id #6093
 * fix(discriminator): don't copy `discriminators` property from base schema #6064
 * fix(utils): respect `valueOf()` when merging object for update #6059
 * docs(validation): fix typo 'maxLength' #4720
 * fix(document): apply defaults after setting initial value so default functions don't see empty doc #3781

5.0.4 / 2018-02-08
==================
 * docs: add lambda guide #6107
 * fix(connection): add `dbName` option to work around `mongodb+srv` not supporting db name in URI #6106
 * fix(schematype): fix regexp typo in ObjectId #6098 [JoshuaWise](https://github.com/JoshuaWise)
 * perf(document): re-use the modifiedPaths list #6092 [tarun1793](https://github.com/tarun1793)
 * fix: use console.info() instead of console.error() for debug output #6088 [yuristsepaniuk](https://github.com/yuristsepaniuk)
 * docs(validation): clean up runValidators and isAsync options docs for 5.x #6083
 * docs(model): use array instead of spread consistently for aggregate() #6070
 * fix(schema): make aliases handle mongoose-lean-virtuals #6069
 * docs(layout): add link to subdocs guide #6056
 * fix(query): make strictQuery: true strip out fields that aren't in the schema #6032
 * docs(guide): add notes for `strictQuery` option #6032

4.13.11 / 2018-02-07
====================
 * docs: fix links in 4.x docs #6081
 * chore: add release script that uses --tag for npm publish for 4.x releases #6063

5.0.3 / 2018-01-31
==================
 * fix: consistently use process.nextTick() to avoid sinon.useFakeTimers() causing ops to hang #6074
 * docs(aggregate): fix typo #6072 [adursun](https://github.com/adursun)
 * chore: add return type to `mongoose.model()` docs [bryant1410](https://github.com/bryant1410)
 * fix(document): depopulate push()-ed docs when saving #6048
 * fix: upgrade mongodb -> 3.0.2 #6019

5.0.2 / 2018-01-28
==================
 * fix(schema): do not overwrite default values in schema when nested timestamps are provided #6024 [cdeveas](https://github.com/cdeveas)
 * docs: fix syntax highlighting in models.jade, schematypes.jade, subdocs.jade #6058 [lineus](https://github.com/lineus)
 * fix: use lazy loading so we can build mongoose with webpack #5993 #5842
 * docs(connections): clarify multi-mongos with useMongoClient for 4.x docs #5984
 * fix(populate): handle populating embedded discriminator paths #5970

4.13.10 / 2018-01-28
====================
 * docs(model+query): add lean() option to Model helpers #5996 [aguyinmontreal](https://github.com/aguyinmontreal)
 * fix: use lazy loading so we can build mongoose with webpack #5993 #5842
 * docs(connections): clarify multi-mongos with useMongoClient for 4.x docs #5984
 * fix(populate): handle populating embedded discriminator paths #5970
 * docs(query+aggregate): add more detail re: maxTimeMS #4066

5.0.1 / 2018-01-19
==================
 * fix(document): make validate() not resolve to document #6014
 * fix(model): make save() not return DocumentNotFoundError if using fire-and-forget writes #6012
 * fix(aggregate): make options() work as advertised #6011 [spederiva](https://github.com/spederiva)
 * docs(queries): fix code samples #6008

5.0.0 / 2018-01-17
==================
 * test: refactor tests to use start fewer connections #5985 [fenanquin](https://github.com/fenanquin)
 * feat: add global bufferCommands option #5879
 * docs: new docs site and build system #5976
 * test: increase timeout on slow test cases #5968 [fenanquin](https://github.com/fenanquin)
 * fix: avoid casting out array filter elements #5965
 * feat: add Model.watch() wrapper #5964
 * chore: replace istanbul with nyc #5962 [ChristianMurphy](https://github.com/ChristianMurphy)

4.13.9 / 2018-01-07
===================
 * chore: update marked (dev dependency) re: security vulnerability #5951 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fix: upgrade mongodb -> 2.2.34 for ipv6 and autoReconnect fixes #5794 #5760
 * docs: use useMongooseAggCursor for aggregate docs #2955

5.0.0-rc2 / 2018-01-04
======================
 * fix: add cleaner warning about no longer needing `useMongoClient` in 5.x #5961
 * chore: update acquit -> 0.5.1 for minor security patch #5961 [ChristianMurphy](https://github.com/ChristianMurphy)
 * docs: add docs for mongoose 4.x at http://mongoosejs.com/docs/4.x #5959
 * docs: add link to migration guide #5957
 * chore: update eslint to version 4.14.0 #5955 [ChristianMurphy](https://github.com/ChristianMurphy)
 * chore: update mocha to version 4.1.0 [ChristianMurphy](https://github.com/ChristianMurphy)

5.0.0-rc1 / 2018-01-02
======================
 * fix(index): use pluralize correctly for `mongoose.model()` #5958
 * fix: make mquery use native promises by default #5945
 * fix(connection): ensure 'joined' and 'left' events get bubbled up #5944

5.0.0-rc0 / 2017-12-28
======================
 * BREAKING CHANGE: always use mongoose aggregation cursor when using `.aggregate().cursor()` #5941
 * BREAKING CHANGE: attach query middleware when compiling model #5939
 * BREAKING CHANGE: `emitIndexErrors` is on by default, failing index build will throw uncaught error if not handled #5910
 * BREAKING CHANGE: remove precompiled browser bundle #5895
 * feat: add `mongoose.pluralize()` function #5877
 * BREAKING CHANGE: remove `passRawResult` option for `findOneAndUpdate`, use `rawResult` #5869
 * BREAKING CHANGE: implicit async validators (based on number of function args) are removed, return a promise instead #5824
 * BREAKING CHANGE: fail fast if user sets a unique index on `_id` #5820 [varunjayaraman](https://github.com/varunjayaraman)
 * BREAKING CHANGE: mapReduce resolves to an object with 2 keys rather than 2 separate args #5816
 * BREAKING CHANGE: `mongoose.connect()` returns a promise, removed MongooseThenable #5796
 * BREAKING CHANGE: query stream removed, use `cursor()` instead #5795
 * BREAKING CHANGE: connection `open()` and `openSet()` removed, use `openUri()` instead #5795
 * BREAKING CHANGE: use MongoDB driver 3.0.0, drop support for MongoDB server < 3.0.0 #5791 #4740
 * BREAKING CHANGE: remove support for `$pushAll`, remove `usePushEach` option #5670
 * BREAKING CHANGE: make date casting use native Date #5395 [varunjayaraman](https://github.com/varunjayaraman)
 * BREAKING CHANGE: remove `runSettersOnQuery`, always run setters on query #5340
 * BREAKING CHANGE: array of length 0 now satisfies `required: true` for arays #5139 [wlingke](https://github.com/wlingke)
 * BREAKING CHANGE: remove `saveErrorIfNotFound`, always error out if `save()` did not update a document #4973
 * BREAKING CHANGE: don't execute getters in reverse order #4835
 * BREAKING CHANGE: make boolean casting more strict #4245
 * BREAKING CHANGE: `toObject()` and `toJSON()` option parameter merges with defaults rather than overwriting #4131
 * feat: allow setting `default` on `_id` #4069
 * BREAKING CHANGE: `deleteX()` and `remove()` promise resolves to the write object result #4013
 * feat: support returning a promise from middleware functions #3779
 * BREAKING CHANGE: don't return a promise if callback specified #3670
 * BREAKING CHANGE: only cast `update()`, `updateX()`, `replaceOne()`, `remove()`, `deleteX()` in exec #3529
 * BREAKING CHANGE: sync errors in middleware functions are now handled #3483
 * BREAKING CHANGE: post hooks get flow control #3232
 * BREAKING CHANGE: deduplicate hooks when merging discriminator schema #2945
 * BREAKING CHANGE: use native promises by default, remove support for mpromise #2917
 * BREAKING CHANGE: remove `retainKeyOrder`, always use forward order when iterating through objects #2749
 * BREAKING CHANGE: `aggregate()` no longer accepts a spread #2716

4.13.8 / 2017-12-27
===================
 * docs(guide): use more up-to-date syntax for autoIndex example #5933
 * docs: fix grammar #5927 [abagh0703](https://github.com/abagh0703)
 * fix: propagate lean options to child schemas #5914
 * fix(populate): use correct model with discriminators + nested populate #5858

4.13.7 / 2017-12-11
===================
 * docs(schematypes): fix typo #5889 [gokaygurcan](https://github.com/gokaygurcan)
 * fix(cursor): handle `reject(null)` with eachAsync callback #5875 #5874 [ZacharyRSmith](https://github.com/ZacharyRSmith)
 * fix: disallow setting `mongoose.connection` to invalid values #5871 [jinasonlin](https://github.com/jinasonlin)
 * docs(middleware): suggest using `return next()` to stop middleware execution #5866
 * docs(connection): improve connection string query param docs #5864
 * fix(document): run validate hooks on array subdocs even if not directly modified #5861
 * fix(discriminator): don't treat $meta as defining projection when querying #5859
 * fix(types): handle Decimal128 when using bson-ext on server side #5850
 * fix(document): ensure projection with only $slice isn't treated as inclusive for discriminators #4991
 * fix(model): throw error when passing non-object to create() #2037

4.13.6 / 2017-12-02
===================
 * fix(schema): support strictBool option in schema #5856 [ekulabuhov](https://github.com/ekulabuhov)
 * fix(update): make upsert option consistently handle truthy values, not just booleans, for updateOne() #5839
 * refactor: remove unnecessary constructor check #2057
 * docs(query): correct function signature for .mod() helper #1806
 * fix(query): report ObjectParameterError when passing non-object as filter to find() and findOne() #1698

4.13.5 / 2017-11-24
===================
 * fix(model): handle update cast errors correctly with bulkWrite #5845 [Michael77](https://github.com/Michael77)
 * docs: add link to bufferCommands option #5844 [ralphite](https://github.com/ralphite)
 * fix(model): allow virtual ref function to return arrays #5834 [brunohcastro](https://github.com/brunohcastro)
 * fix(query): don't throw uncaught error if query filter too big #5812
 * fix(document): if setting unselected nested path, don't overwrite nested path #5800
 * fix(document): support calling `populate()` on nested document props #5703
 * fix: add `strictBool` option for schema type boolean #5344 #5211 #4245
 * docs(faq): add faq re: typeKey #1886
 * docs(query): add more detailed docs re: options #1702

4.13.4 / 2017-11-17
===================
 * fix(aggregate): add chainable .option() helper for setting arbitrary options #5829
 * fix(aggregate): add `.pipeline()` helper to get the current pipeline #5825
 * docs: grammar fixes for `unique` FAQ #5823 [mfluehr](https://github.com/mfluehr)
 * chore: add node 9 to travis #5822 [superheri](https://github.com/superheri)
 * fix(model): fix infinite recursion with recursive embedded discriminators #5821 [Faibk](https://github.com/Faibk)

4.13.3 / 2017-11-15
===================
 * chore: add node 8 to travis #5818 [superheri](https://github.com/superheri)
 * fix(document): don't apply transforms to nested docs when updating already saved doc #5807

4.13.2 / 2017-11-11
===================
 * feat(buffer): add support for subtype prop #5530

4.13.1 / 2017-11-08
===================
 * fix: accept multiple paths or array of paths to depopulate #5798 #5797 [adamreisnz](https://github.com/adamreisnz)
 * fix(document): pass default array as actual array rather than taking first element #5780
 * fix(model): increment version when $set-ing it in a save() that requires a version bump #5779
 * fix(query): don't explicitly project in discriminator key if user projected in parent path #5775 #5754
 * fix(model): cast query option to geoNear() #5765
 * fix(query): don't treat projection with just $slice as inclusive #5737
 * fix(discriminator): defer applying embedded discriminator hooks until top-level model is compiled #5706
 * docs(discriminator): add warning to always attach hooks before calling discriminator() #5706

4.13.0 / 2017-11-02
===================
 * feat(aggregate): add $addFields helper #5740 [AyushG3112](https://github.com/AyushG3112)
 * feat(connection): add connection-level bufferCommands #5720
 * feat(connection): add createCollection() helper #5712
 * feat(populate): support setting localField and foreignField to functions #5704 #5602
 * feat(query): add multipleCastError option for aggregating cast errors when casting update #5609
 * feat(populate): allow passing a function to virtual ref #5602
 * feat(schema): add excludeIndexes option to optionally prevent collecting indexes from nested schemas #5575
 * feat(model): report validation errors from `insertMany()` if using `ordered: false` and `rawResult: true` #5337
 * feat(aggregate): add pre/post aggregate middleware #5251
 * feat(schema): allow using `set` as a schema path #1939

4.12.6 / 2017-11-01
===================
 * fix(schema): make clone() copy query helpers correctly #5752
 * fix: undeprecate `ensureIndex()` and use it by default #3280

4.12.5 / 2017-10-29
===================
 * fix(query): correctly handle `$in` and required for $pull and update validators #5744
 * feat(aggegate): add $addFields pipeline operator #5740 [AyushG3112](https://github.com/AyushG3112)
 * fix(document): catch sync errors in document pre hooks and report as error #5738
 * fix(populate): handle slice projections correctly when automatically selecting populated fields #5737
 * fix(discriminator): fix hooks for embedded discriminators #5706 [wlingke](https://github.com/wlingke)
 * fix(model): throw sane error when customer calls `mongoose.Model()` over `mongoose.model()` #2005

4.12.4 / 2017-10-21
===================
 * test(plugins): add coverage for idGetter with id as a schema property #5713 [wlingke](https://github.com/wlingke)
 * fix(model): avoid copying recursive $$context object when creating discriminator after querying #5721
 * fix(connection): ensure connection promise helpers are removed before emitting 'connected' #5714
 * docs(schema): add notes about runSettersOnQuery to schema setters #5705
 * fix(collection): ensure queued operations run on the next tick #5562

4.12.3 / 2017-10-16
===================
 * fix(connection): emit 'reconnect' event as well as 'reconnected' for consistency with driver #5719
 * fix: correctly bubble up left/joined events for replica set #5718
 * fix(connection): allow passing in `autoIndex` as top-level option rather than requiring `config.autoIndex` #5711
 * docs(connection): improve docs regarding reconnectTries, autoReconnect, and bufferMaxEntries #5711
 * fix(query): handle null with addToSet/push/pull/pullAll update validators #5710
 * fix(model): handle setDefaultsOnInsert option for bulkWrite updateOne and updateMany #5708
 * fix(query): avoid infinite recursion edge case when cloning a buffer #5702

4.12.2 / 2017-10-14
===================
 * docs(faq): add FAQ about using arrow functions for getters/setters, virtuals, and methods #5700
 * docs(schema): document the childSchemas property and add to public API #5695
 * fix(query): don't project in populated field if parent field is already projected in #5669
 * fix: bump mongodb -> 2.2.33 for issue with autoReconnect #4513

4.12.1 / 2017-10-08
===================
 * fix(document): create new doc when setting single nested, no more set() on copy of priorVal #5693
 * fix(model): recursively call applyMethods on child schemas for global plugins #5690
 * docs: fix bad promise lib example on home page #5686
 * fix(query): handle false when checking for inclusive/exclusive projection #5685
 * fix(discriminator): allow reusing child schema #5684
 * fix: make addToSet() on empty array with subdoc trigger manual population #5504

4.12.0 / 2017-10-02
===================
 * docs(validation): add docs coverage for ValidatorError.reason #5681
 * feat(discriminator): always add discriminatorKey to base schema to allow updating #5613
 * fix(document): make nested docs no longer inherit parent doc's schema props #5586 #5546 #5470
 * feat(query): run update validators on $pull and $pullAll #5555
 * feat(query): add .error() helper to query to error out in pre hooks #5520
 * feat(connection): add dropCollection() helper #5393
 * feat(schema): add schema-level collation option #5295
 * feat(types): add `discriminator()` function for single nested subdocs #5244
 * feat(document): add $isDeleted() getter/setter for better support for soft deletes #4428
 * feat(connection): bubble up reconnectFailed event when driver gives up reconnecting #4027
 * fix(query): report error if passing array or other non-object as filter to update query #3677
 * fix(collection): use createIndex() instead of deprecated ensureIndex() #3280

4.11.14 / 2017-09-30
====================
 * chore: add nsp check to the CI build #5679 [hairyhenderson](https://github.com/hairyhenderson)
 * fix: bump mquery because of security issue with debug package #5677 #5675 [jonathanprl](https://github.com/jonathanprl)
 * fix(populate): automatically select() populated()-ed fields #5669
 * fix(connection): make force close work as expected #5664
 * fix(document): treat $elemMatch as inclusive projection #5661
 * docs(model/query): clarify which functions fire which middleware #5654
 * fix(model): make `init()` public and return a promise that resolves when indexes are done building #5563

4.11.13 / 2017-09-24
====================
 * fix(query): correctly run replaceOne with update validators #5665 [sime1](https://github.com/sime1)
 * fix(schema): replace mistype in setupTimestamp method #5656 [zipp3r](https://github.com/zipp3r)
 * fix(query): avoid throwing cast error for strict: throw with nested id in query #5640
 * fix(model): ensure class gets combined schema when using class syntax with discriminators #5635
 * fix(document): handle setting doc array to array of top-level docs #5632
 * fix(model): handle casting findOneAndUpdate() with overwrite and upsert #5631
 * fix(update): correctly handle $ in updates #5628
 * fix(types): handle manual population consistently for unshift() and splice() #5504

4.11.12 / 2017-09-18
====================
 * docs(model): asterisk should not render as markdown bullet #5644 [timkinnane](https://github.com/timkinnane)
 * docs: use useMongoClient in connection example #5627 [GabrielNicolasAvellaneda](https://github.com/GabrielNicolasAvellaneda)
 * fix(connection): call callback when initial connection failed #5626
 * fix(query): apply select correctly if a given nested schema is used for 2 different paths #5603
 * fix(document): add graceful fallback for setting a doc array value and `pull()`-ing a doc #3511

4.11.11 / 2017-09-10
====================
 * fix(connection): properly set readyState in response to driver 'close' and 'reconnect' events #5604
 * fix(document): ensure single embedded doc setters only get called once, with correct value #5601
 * fix(timestamps): allow enabling updatedAt without createdAt #5598
 * test: improve unique validator test by making create run before ensureIndex #5595 #5562
 * fix(query): ensure find callback only gets called once when post init hook throws error #5592

4.11.10 / 2017-09-03
====================
 * docs: add KeenIO tracking #5612
 * fix(schema): ensure validators declared with `.validate()` get copied with clone() #5607
 * fix: remove unnecessary jest warning #5480
 * fix(discriminator): prevent implicit discriminator schema id from clobbering base schema custom id #5591
 * fix(schema): hide schema objectid warning for non-hex strings of length 24 #5587
 * docs(populate): use story schema defined key author instead of creator #5578 [dmric](https://github.com/dmric)
 * docs(document): describe usage of `.set()` #5576
 * fix(document): ensure correct scope in single nested validators #5569
 * fix(populate): don't mark path as populated until populate() is done #5564
 * fix(document): make push()-ing a doc onto an empty array act as manual population #5504
 * fix(connection): emit timeout event on socket timeout #4513

4.11.9 / 2017-08-27
===================
 * fix(error): avoid using arguments.callee because that breaks strict mode #5572
 * docs(schematypes): fix spacing #5567
 * fix(query): enforce binary subtype always propagates to mongodb #5551
 * fix(query): only skip castForQuery for mongoose arrays #5536
 * fix(browser): rely on browser entrypoint to decide whether to use BrowserDocument or NodeDocument #5480

4.11.8 / 2017-08-23
===================
 * feat: add warning about using schema ObjectId as type ObjectId #5571 [efkan](https://github.com/efkan)
 * fix(schema): allow setting `id` property after schema was created #5570 #5548
 * docs(populate): remove confusing _ from populate docs #5560
 * fix(connection): expose parsed uri fields (host, port, dbname) when using openUri() #5556
 * docs: added type boolean to options documentation #5547 [ndabAP](https://github.com/ndabAP)
 * test: add test coverage for stopping/starting server #5524
 * fix(aggregate): pull read preference from schema by default #5522

4.11.7 / 2017-08-14
===================
 * fix: correct properties when calling toJSON() on populated virtual #5544 #5442 [davidwu226](https://github.com/davidwu226)
 * docs: fix spelling #5535 [et](https://github.com/et)
 * fix(error): always set name before stack #5533
 * fix: add warning about running jest in jsdom environment #5532 #5513 #4943
 * fix(document): ensure overwriting a doc array cleans out individual docs #5523
 * fix(schema): handle creating arrays of single nested using type key #5521
 * fix: upgrade mongodb -> 2.2.31 to support user/pass options #5419

4.11.6 / 2017-08-07
===================
 * fix: limiting number of async operations per time in insertMany #5529 [andresattler](https://github.com/andresattler)
 * fix: upgrade mongodb -> 2.2.30 #5517
 * fix(browserDocument): prevent stack overflow caused by double-wrapping embedded doc save() in jest #5513
 * fix(document): clear single nested doc when setting to empty object #5506
 * fix(connection): emit reconnected and disconnected events correctly with useMongoClient #5498
 * fix(populate): ensure nested virtual populate gets set even if top-level property is null #5431

4.11.5 / 2017-07-30
===================
 * docs: fix link to $lookup #5516 [TalhaAwan](https://github.com/TalhaAwan)
 * fix: better parallelization for eachAsync #5502 [lchenay](https://github.com/lchenay)
 * docs(document): copy docs for save from model to doc #5493
 * fix(document): handle dotted virtuals in toJSON output #5473
 * fix(populate): restore user-provided limit after mutating so cursor() works with populate limit #5468
 * fix(query): don't throw StrictModeError if geo query with upsert #5467
 * fix(populate): propagate readPreference from query to populate queries by default #5460
 * docs: warn not to use arrow functions for statics and methods #5458
 * fix(query): iterate over all condition keys for setDefaultsOnInsert #5455
 * docs(connection): clarify server/replset/mongos option deprecation with useMongoClient #5442

4.11.4 / 2017-07-23
===================
 * fix: handle next() errors in `eachAsync()` #5486 [lchenay](https://github.com/lchenay)
 * fix(schema): propagate runSettersOnQuery option to implicitly created schemas #5479 [https://github.com/ValYouW]
 * fix(query): run castConditions() correctly in update ops #5477
 * fix(query): ensure castConditions called for findOne and findOneAnd* #5477
 * docs: clarify relationship between $lookup and populate #5475 [TalhaAwan](https://github.com/TalhaAwan)
 * test: add coverage for arrays of arrays [zbjornson](https://github.com/zbjornson)
 * fix(middleware): ensure that error handlers for save get doc as 2nd param #5466
 * fix: handle strict: false correctly #5454 #5453 [wookieb](https://github.com/wookieb)
 * fix(query): apply schema excluded paths if only projection is a $slice #5450
 * fix(query): correct discriminator handling for schema `select: false` fields in schema #5448
 * fix(cursor): call next() in series when parallel option used #5446
 * chore: load bundled driver first to avoid packaging problem #5443 [prototypeme](https://github.com/prototypeme)
 * fix(query): defer condition casting until final exec #5434
 * fix(aggregate): don't rely on mongodb aggregate to put a cursor in the callback #5394
 * docs(aggregate): add useMongooseAggCursor docs #5394
 * docs(middleware): clarify context for document, query, and model middleware #5381

4.11.3 / 2017-07-14
===================
 * fix(connection): remove .then() before resolving to prevent infinite recursion #5471

4.11.2 / 2017-07-13
===================
 * docs: fix comment typo in connect example #5435 [ConnorMcF](https://github.com/ConnorMcF)
 * fix(update): correctly cast document array in update validators with exec() #5430
 * fix(connection): handle autoIndex with useMongoClient #5423
 * fix(schema): handle `type: [Array]` in schemas #5416
 * fix(timestamps): if overwrite is set and there's a $set, use $set instead of top-level update #5413
 * fix(document): don't double-validate deeply nested doc array elements #5411
 * fix(schematype): clone default objects so default not shared across object instances unless `shared` specified #5407
 * fix(document): reset down the nested subdocs when resetting parent doc #5406
 * fix: don't pass error arg twice to error handlers #5405
 * fix(connection): make openUri() return connection decorated with then() and catch() #5404
 * fix: enforce $set on an array must be an array #5403
 * fix(document): don't crash if calling `validateSync()` after overwriting doc array index #5389
 * fix(discriminator): ensure discriminator key doesn't count as user-selected field for projection #4629

4.11.1 / 2017-07-02
===================
* docs: populate virtuals fix justOne description #5427 [fredericosilva](https://github.com/fredericosilva)
 * fix(connection): make sure to call onOpen in openUri() #5404
 * docs(query): justOne is actually single, and it default to false #5402 [zbjornson](https://github.com/zbjornson)
 * docs: fix small typo in lib/schema.js #5398 #5396 [pjo336](https://github.com/pjo336)
 * fix: emit remove on single nested subdocs when removing parent #5388
 * fix(update): handle update with defaults and overwrite but no update validators #5384
 * fix(populate): handle undefined refPath values in middle of array #5377
 * fix(document): ensure consistent setter context for single nested #5363
 * fix(query): support runSettersOnQuery as query option #5350

4.11.0 / 2017-06-25
===================
 * feat(query): execute setters with query as context for `runSettersOnQuery` #5339
 * feat(model): add translateAliases function #5338 [rocketspacer](https://github.com/rocketspacer)
 * feat(connection): add `useMongoClient` and `openUri` functions, deprecate current connect logic #5304
 * refactor(schema): make id virtual not access doc internals #5279
 * refactor: handle non-boolean lean #5279
 * feat(cursor): add addCursorFlag() support to query and agg cursors #4814
 * feat(cursor): add parallel option to eachAsync #4244
 * feat(schema): allow setting custom error constructor for custom validators #4009

4.10.8 / 2017-06-21
===================
 * docs: fix small formatting typo on schematypes #5374 [gianpaj](https://github.com/gianpaj)
 * fix(model): allow null as an _id #5370
 * fix(populate): don't throw async uncaught exception if model not found in populate #5364
 * fix: correctly cast decimals in update #5361
 * fix(error): don't use custom getter for ValidationError message #5359
 * fix(query): handle runSettersOnQuery in built-in _id setter #5351
 * fix(document): ensure consistent context for nested doc custom validators #5347

4.10.7 / 2017-06-18
===================
 * docs(validation): show overriding custom validator error with 2nd cb arg #5358
 * fix: `parseOption` mutates user passed option map #5357 [igwejk](https://github.com/igwejk)
 * docs: fix guide.jade typo #5356 [CalebAnderson2014](https://github.com/CalebAnderson2014)
 * fix(populate): don't set populate virtual to ids when match fails #5336
 * fix(query): callback with cast error if remove and delete* args have a cast error #5323

4.10.6 / 2017-06-12
===================
 * fix(cursor): handle custom model option for populate #5334
 * fix(populate): handle empty virtual populate with Model.populate #5331
 * fix(model): make ensureIndexes() run with autoIndex: false unless called internally #5328 #5324 #5317
 * fix: wait for all connections to close before resolving disconnect() promise #5316
 * fix(document): handle setting populated path with custom typeKey in schema #5313
 * fix(error): add toJSON helper to ValidationError so `message` shows up with JSON.stringify #5309
 * feat: add `getPromiseConstructor()` to prevent need for `mongoose.Promise.ES6` #5305
 * fix(document): handle conditional required with undefined props #5296
 * fix(model): clone options before inserting in save() #5294
 * docs(populate): clarify that multiple populate() calls on same path overwrite #5274

4.10.5 / 2017-06-06
===================
 * chore: improve contrib guide for building docs #5312
 * fix(populate): handle init-ing nested virtuals properly #5311
 * fix(update): report update validator error if required path under single nested doc not set
 * fix(schema): remove default validate pre hook that was causing issues with jest #4943

4.10.4 / 2017-05-29
===================
 * chore: dont store test data in same directory #5303
 * chore: add data dirs to npmignore #5301 [Starfox64](https://github.com/Starfox64)
 * docs(query): add docs about runSettersOnQuery #5300

4.10.3 / 2017-05-27
===================
 * docs: correct inconsistent references to updateOne and replaceOne #5297 [dhritzkiv](https://github.com/dhritzkiv)
 * docs: fix dropdowns in docs #5292 [nathanallen](https://github.com/nathanallen)
 * docs: add description of alias option #5287
 * fix(document): prevent infinite loop if validating nested array #5282
 * fix(schema): correctly handle ref ObjectIds from different mongoose libs #5259
 * fix(schema): load child class methods after base class methods to allow override #5227

4.10.2 / 2017-05-22
===================
 * fix: bump ms -> 2.0.0 and mquery -> 2.3.1 for minor security vulnerability #5275

4.10.1 / 2017-05-21
===================
 * fix(aggregate): handle sorting by text score correctly #5258
 * fix(populate): handle doc.populate() with virtuals #5240
 * fix(schema): enforce that `_id` is never null #5236

4.10.0 / 2017-05-18
===================
 * fix(schema): update clone method to include indexes #5268 [clozanosanchez](https://github.com/clozanosanchez)
 * feat(schema): support aliases #5184 [rocketspacer](https://github.com/rocketspacer)
 * feat(aggregate): add mongoose-specific aggregation cursor option #5145
 * refactor(model): make sharding into a plugin instead of core #5105
 * fix(document): make nested doc mongoose internals not enumerable again #5078
 * feat(model): pass params to pre hooks #5064
 * feat(timestamps): support already defined timestamp paths in schema #4868
 * feat(query): add runSettersOnQuery option #4569
 * fix(query): add strictQuery option that throws when not querying on field not in schema #4136
 * fix(update): more complete handling for overwrite option with update validators #3556
 * feat: support `unique: true` in arrays via the mongoose-unique-array plugin #3347
 * fix(model): always emit 'index', even if no indexes #3347
 * fix(schema): set unique indexes on primitive arrays #3347
 * feat(validation): include failed paths in error message and inspect output #3064 #2135
 * fix(model): return saved docs when create() fails #2190

4.9.10 / 2017-05-17
===================
 * fix(connection): ensure callback arg to openSet() is handled properly #5249
 * docs: remove dead plugins repo and add content links #5247
 * fix(model): skip index build if connecting after model init and autoIndex false #5176

4.9.9 / 2017-05-13
==================
 * docs: correct value for Query#regex() #5230
 * fix(connection): don't throw if .catch() on open() promise #5229
 * fix(schema): allow update with $currentDate for updatedAt to succeed #5222
 * fix(model): versioning doesn't fail if version key undefined #5221 [basileos](https://github.com/basileos)
 * fix(document): don't emit model error if callback specified for consistency with docs #5216
 * fix(document): handle errors in subdoc pre validate #5215

4.9.8 / 2017-05-07
==================
 * docs(subdocs): rewrite subdocs guide #5217
 * fix(document): avoid circular JSON if error in doc array under single nested subdoc #5208
 * fix(document): set intermediate empty objects for deeply nested undefined paths before path itself #5206
 * fix(schema): throw error if first param to schema.plugin() is not a function #5201
 * perf(document): major speedup in validating subdocs (50x in some cases) #5191

4.9.7 / 2017-04-30
==================
 * docs: fix typo #5204 [phutchins](https://github.kom/phutchins)
 *0fix(schema): ensure correct 0aô` for äeeply oested schdma!inddxes #5198
 *0fiù(schema): make pemove$a resmrved name #519'
 * fax(model): handle De#imal type in insertMany correctly #5190
 * fix8 upgrade kcreem to ha®dle asyjc pre hooks corpectly #5588
 * docs: add dgtiil{ Aâoõt uniqqe nkT being a vadida4oz #5179
 (`fix(validation):$handle seturni.g!a promise with isasylc: tòue$#5171

4.).6"/ 2017-04-23=================
 * fih: u`daôe!`parmntArrayb regerences hen Lirectly assIgning dogument arriys #5192 [jhob](https://giehub.com/jhob)
(* eocs: improve schum`type ¶alidator docs #5178 [milesba2r](https://github&com/milesbarr)
`* fix(mdel): mod)f9 di{crimineuor() clAsq in place"#515 * fix(model); handle bulkWrite 5pdapeMslX casting #5172 [tzeldman](httðs://github.kom/tzellman)
 ( docs(mded9: fIx replaceOng mxieple for Bu|kWriðe`#%168
 * nix(docu-enu): dmn#t create ` j%w array"subdoc when crmauiîc q#hema qrp`y #5162
(+%fix¨modeL	: Merge query hooks "rom disc2)minauors #5147
 * vix(documelt): add(parent() vunctionbto subdocument t match array subdoc #4034

4.9.50/ 2017-04-16
=}=====½=====?====
 * dix(queryi: cozvect!$pullAll casting of nudl #5164 [S%bmarter](https://github.com/Sebmaster) * docs: add adwanãed s#hemas äocs fos"loadC|ass #5557
 * fix(docum%nt-: handlg nu,l/u.lefined GraceFully in appl9GetTers() #543
 * fiø*model): add resnhveToO`ject gption f/s mapReeuce with ES6 promkses #494%JJ4.9.4 / r017-04-09====?=============
 * fix(scheoa)º clone query midälewarm correctly #5153 #5150 [cdoza.osqnchezU(httqr://github.com/clozanosanchez)
 * docs(iggrega4e): fix typï #51$2
 * fix(q}eby):"caSt .$ update to undeplying array type #5120
 * Fix(ropulate): don7t muta4e populate result iN 0lace"#51r8
 * fmx(yuery): `andl% $setonI~s%rT c/nsmstent with!$set #51r6
!: dogs(qTery): add strict mode kttion f/r nindOnåAndÕpdate #5108

4.93 ï 2017-04-02
================== : dïcs: document.js fixms fn2 functiojs prepEnded with``$` #5131 Ykrmannix](httpS://git(ub.kom/kRmannip)
 * fix: @void exception oî constructor check 3512¹ [monkbroc](lttps://fyvhub.#gm+mobkbroc) * dcs(schematype): explain how tk 5se(`isAs}nc` with validate() #5125
 * dOcs8sch%matype):0etplain custom -essage with reqeIre$$function #5123
`* fix(popuìatd)x only!apply 2efPath luplicate(ad optimiz!tion mf nït array #5114
 * fix(document- gopy non-objects uo dïc when init() #5111
 * perf8pmptlatE): dont cìne whgle /ptions every time0#5103
 * feit(docõmeìt): add0isDirectSelecteä() to }inimize isSelectdd(* c(angusv#54630* docs(schema|ypes): explamn1some subtleties with arRays #505)

4.9,2 / 30q7-03-24
<======½==========
 * fkx(`isgrimivator): handle class namew cfnsyst%n|ly #5104
 * fix(schemai: maka alo.e() gork ÷ith reusing discriminator(schemas #5098 *0byx(qwårycursor): run pre find hoocs with .cursor() #5(9&
 * fix(aonnecTion): throw }rror if username:paósword includes`@ or : #5091
 * fix(timestamps):$handLe overwrhdilg crea4edAt+updatedAt consisten4ly #5088
 * fix(documenui: ensure subdoc post$safe vens aftep parent"s!ve #5085
 * dobs(model): imprïve!update doca £%476![bertolO1988](https:-/gid(ub.cOm/bertklo19<8)

49.1 / 2017-03-±9
=====½======5=-=?=
 * fáø(query): handle $Tyra for arrays #5080 #5079`[xoeldner](https://'ithub.com/zoullner)
 * fix(model): handle ovdered param(for a)nseRtMany  Validation eRrorS #5072 [sjorssnoeren](httpS://github.cm/sjorssnoeren)
 * fix(populate); !void(lupli#ate ids in dynref quMrias #5054
 * fix(timestamps): dont set time{tamps in upd!te if user set it #50t7
 * fix¨update): dont doufle-caLl setters ol arrays c5041
 " fi8: upgrade driver -> 2/2.2% for jest fix #5033
 : fmx(modul): ge4(promise each tiee save) is callet `ather t(an nce #5030
 * fix(cknnection): mane con.ect retUrj value conóistenT #5006

4.9.0 / 2017-03-13
=}=======9========
 * fuat(documgîp): retõrn this drom `depopulate()` #502' * fixdriöezs): stop emittkng"timenuts as eròors #5026
 : feat(schemi): adä!i!clone()(function for scjemas #4983
 * feat(query): add rawResult option to replace pas3RawResult$ deprecat% passRa7Result #4977 c4925
 * feat(scxmmapype): support isisync validator option and èafdle returnyng promises broo0valida4ors, deprecAte iexlicit awync valhdatobs #4290
$* feat(querù): ãdd `replaceo.e()`,  de,eteOne()`,``deleteMany()` #3998
 *0feav(modEl): add `bul{Wrkte()` #298

$.8.7 + 6017-03)12
===<=========?====
 * fix(mofel)`if lqst arg in sPread is falsy, treat it as a c`llback 35061
 * fm8(tocument): õse $hook mnstaad of hmok!to enable ghonk/ as a paph name"#5:67
 * fiX(poqulate): eo.t seleCt f/reigî nielD if parent fiell is sulected #u037
 * Fix(populate):"hcndla passing no args to query.popqlate #5036
 * fix(update): uSe`correct ethoä dor casting nested a2rays #5430 * fhx(`isariminator): handle array discrkminators when cawting $push0#5009

4.¸.&  2017-03-2%
==============-===
 * docs(doCument):(re}ove Te}t dhat imPlies that vrensform és false by tafa}lt #5023
 *$fix(atplyHooks): dont wvap!a$dunc|Mon(if it ir already wbapped #5019
 * fix(documdnv); eosure`nested docs' toObjecu) clones #u008
4®8&5 / 2017-0"-25
======}===========
 * fm8:(chgck for gmpty scxemaPatx befozu accessIng propåst9 $ismongoOseDocumentAròaù #u°17 [htdps2''github.com/raofyhoulahao(randyhoulahan)
 j fix(d)sCriiinators): hanDle create(© ind push(© fgr embedded discrimiNatorw #50p1
 * fix(quepykursor): ensurg cl/se umitted ifter last dcta event #4918
"* fix(d)ssriminatkrs): remove fieläs not selected in child wheî qudrying by!base moded #4991

4.8.4 / 2017-02-19
==9=}===½?========
 * dcs(discciminatops): åxplain embedded di3criiinqtors #4997
 * fix(qu-ry	: fkx TypeError"when finfNneAndUpdate errOró #4990
 * fix(update): (a~dle neSted single embmdded in$updcte(validapops correctly #4989
 * fix(browser): make browser eoc cgnstructor not cba3` #4;:7
>.8.3 / 2017-0:-15
=======}=======5==
°* chore: upgrade mongodb dryvEr ->`2.2.24
 . lgcs(coînect)ons): addd somd netails about callbacks"+4986
$* fix: en3ure clas{ is created WIph`new keyword #4972 #4947 [benhjames](https:/github.cgm/benhjames)* * fix(discrimin`tor): add`applyPluginsToDiscriminators option !4965
 * fkx(erdate): properly cact arra9!subdocs when castinc uqdate 4960
 * fix(populate): ejóurg foreigo field is selected for virtõal popumate #49µ9
"* docq*query): doc5ment sïme quesy callbqck para}s 494=Ê * fix(doc4ment): ansure mrrors in vqlidatorq get cauehp #2985

4.8." / 2017-02-1ð
==========<=9=====
 * fi8(up`ate): `ctually run validatovs on(addToQet #493 
 fix(urDate): kmprove juffer err/r hantlyng #414´ [amYouW](https:o/github.com/FalYou) * fix(discrimanator): hanDìe"subclaSsi~g(wIth LoadClAss govbectly #4942
 * fix(quar{): allgw(0assing Map to sort() #4941
 * fip(documenp): handle settin' `iscsimiNatmr dkc #4935
 * fix(sãhema): rmvurn corregt value!from pre init xook +4=28
 * fix(qwery): ensure cnwistent params in error hajdlers id pre hoïk errors #497

4.8.1 / 2017-21-30
==================
 * nix(queRy): handle $exists for arrays a.d embetded docs #4937
!* fip8que2y): handle piswing strine to hint() #431

4.:.0 / 20q7-01-2x
===?====5=======9=
 * feqt(schema): atd savaErrorIfNopFound option and $where propert}"#4925 #4004
 . feat(que2y-: ald $in$implIcitLy )f"p%swed an erraY #49120[QuotableWater7}(https://github.comQuotab|eVater7)
 * feqt(aggrägate):!helpeb!fob$$facEt #4y04 [varunjayaòam!n]https://withub.cgm/varunjaYaraman) * feaT¨query): add collation method #4:39
 * feat(schea):àppo`ogate st2ict opdion to impLicid array subschemaS #4831 [dkrossg](https:/ogithub.com?dkrosso)
 * feet(aggregatu): add èedper for graph\ook}p #4819 Ûvarun{áyáraman](ètt0s://githubncom/varunjayarqman)
 * fåat,types): suppïrt Decymal128 #´759
 . feit(aggregate): adD$eachAsynb() ôo!aggregate cu2sor £$300
 * fe!t(qumry): `dd utdateOne and qpdateM!ni #399' * fe`t(model): support optíïns for hnsertMqny #389 *"fix(mobumdnt)8 r5n valid!téon on single nested docs if not directly emdified #38¸4
"* feAt(model): use discri-inatOv constructor based on di3criminatorKey in creAte() #3624
 *$feat: pas3 collåction aó confuxt uo eebug!function #3261
 * fe!t(quepi): support pus` and addToSet for Updete validcvors!#2933 * perf(document): refactor reghstevHooksFromSkhema so hooks Are defined on toc prktouype #2774: * feat(types)z a`d d)skrimmnator() function to doc abrays #2723 #1856
 * fix(populcte): returf an erroc if sorting uîderneq|h a doc arbqy #22024.7.9 / 2r17-01-27
====9=====9====}==Š`* fix(quury) handle ccstyng $exisuc u.der $not #4933
 * chore: uporade mongodb > 2.2.22 re: #4930
4.7.8 / 201—-01-22
=========}==<====
 * fi:(populate): retter handling for virtua, populate under ercays0#423
 *$docs: upgrade cïNôributorr cownt #4918 [AdamZaczuk](https//giphub.cgm/AdamZaczek)
 * fix(query): don't set nested path eefaul| id setti~g"parent path #5910
 * docs(proIise(: add missing`braccet #4907
 *(bix)connection-: ensur¥ error handhing is(cknsistently as{nb #4905 * fix: hajdle authMech!nisM in uuery string #4900
 * fix(docqmen4): ensure grror handlers bõn fïr validate0#4885
4.7.5 / 2857-41,15*9====-===========
"* nix(uvéls):!äO~'t crash if tm[key] is null #4881
 + fix: u0grad} mongodb -> 2.2.20 #5967
 * fix: adä a toBSON tg documents for easéer qtårying #4866
 * gix: suqpress bluebird%waromng #4854 [daridwu²26](hô|ps:./gitiub.com/4ivkdwu0>)
 *0fix(ropuhate): handle nested Þirtuals$in virtual populaôe #4851

4.7®6 /$2017-p1-02
=====<=====½=====
 * fix(model): anlow paqwing non-avray to insårtMan{ #4842
 *(fix(populaTu): use base model name id nï discrilinator fOr backuards compat #4843
 * fiy: `lüow0intdrnal validate callback tï!be ïptional #4846 [arciirina](https://witjub®co}/arciisiîe)
 " féx(dobuMent): don't sëir poinôCut )f savu not lefined (like iî browóer doc) #4041
 
 chore: improve benchmarks #4838 [billOuboq],httpc://gith5b.cnm/billoubu)
 * perf: remove some unused"parameters #48s7 [billouboq}(https://github.com/billouboq!
 *"bix(queòy); dnn't call evr/r han$ler if!passRawResu|t is |rue and no!error oc#urrEd #4836
4.7.5 / 0q6-12-26
=======9=========}
 * docs(model)> fix speìling iistake`#4828 [taulinoj]xhttts://withub.com/paulinoj)
 *"fix(aggregate): re-ove(unhandled rejecTion when uqIno aggregata.then() !4)24
 * perg: remgve try/catcl that kinls optimizer #4821
 * fiX(m}ddl): handlfs populating with fiscriminetmrs that i!y oop Hawc a rmb #4817
 * fix(documeNt): haîdle 3ettyng array of discriminapOrs #3575

4.7.40/ 2116-12,21
½=====?===========
 *`docs: fix tipo '4¸10 [GEEKIA]](https:./github.col/GEEKICM)
 * nix(Querù) tiíertamps sith $p÷sh + %gach #4805
 * f)x(document): h`ndle buffers ãorrgctly in minimizE #4800
 * bix:(d/n't d	salhow ovurwritilf pedaul4 and cast fns #4795 [pdspicer](https://giThub.com/päspicEr)
 * fix(dïcument): don't colvert single nesued äocs to POJOs #473 *!fix(cojnection): handle 2econnecp to rçplkca0set cïrrectìy g49v2 [gfzabarino]9ittpw://githõb.Col/gfzábari.o)

4.7.3 / 2016-12-1&
==================
 ( fix: upgrid% mong+db driver -> 2.2.1¶ for several"bwg fixes gnf 3.4 support #4799 * fmx(mOdel): enruvu discriminator"ke9 is corract for child(scheía on eiscvimi/aTor +4790
 * fix(documånt)8 handle ma3k velid in subdocs corpecTly #4778
 * fix(query): check for o`jgc|q aonsiqtently £4v75

4.7.2 .`601-16-07
==================
"* tesô(populate): fix justOne tes4 #4772 Ycblqnc](https://giphub,coo/cjlanc) * shore: fix benchmavks #6769 [billouboq](htuðs://githej.com/billouboq)
 + fix
documeft):(h#ndle settinf subdoc |o null after setting paöent eïc #6766
 *"fix(ñuery9:"suPport passRaReqult with leán #4?62 #47610[mhfrantz](htpps://github.com/mhfrantz)
 * fir(yueby): t`row!StrictModeEsror`if upsert with nonexist)lg figlt$in conditin #4757
 * test: fix a bouple of sort 4espS 34756 [bapoe](https://gkthub.com/japod)
 * chore: qrorade mongodb drcver -> 2.2.12 #475 [mdlavi.])https://github.co}/mdlavmn)
 * fix(quer9)`handle updata with upsert and overwrite correctly #474y
Š4.7.1 / 2016-51-s
=?================
 j fIø(schEma): tHroW error if you0use pzotot9pe as a sahe-a path #4744 ( fix(sahema*: \hrOw helpful error if you define a rirtUal ath tie!Same p`th as a zeal papx #47<4* * fkx(cmnnecuioj!; maKe creAteConngctiof(not throw rejected psoMiseS #4742 * fix(porulape): allow specifiying optiOns in modgl sChEma #4741
 * fix*documenu): iandle selected0oected(eleMenôs uith defaults #4·39J * fix(quer{): add model to0cart ebror if possible0#4729
 * fi8(query): lindle timgstamps with overwroue #4054
4&7.0(/ 2016-1±-23
<======5==========
 * docs: clean e` schematypes #t32 JkidljY(`ttps:+'github.col/kidlj9
 
 perf: only get stack when (ecessary with VersyoîError +4726 [ebmaster} https://gIthub.com/Sebm!ster)
 * fix(query): %nsure$correct castyNg when settiNg arRay!element #4724
"* fix(connection): ensure db name gats seT when you pars 4 parAir #47²1
 * fix:!Urevenu TypeError il node v7 #4719 4786 * feat¨documenp): suppobt .set() oî virtual subpaths '4716
 * feat8popul`pe) sdpporv poðudave virtuals on(~ested 3chemas #6715
 * feat(querykurs/r)> s}pport transforí option and$.íap() #47140#¤75 [cblanc](https://gi|hub.c/o/cbnanc)
 *(fix(documgnd)z dont set defaults on not-selected nestgd `athc #47 7
 j fix(populate): dongt throw if emrty strine pissd to populate #470v
 * feat(model): edd `loadClass()` functyon doò importyog schcma from ES6class #4668 [roãkmAcaca](https://gitlub/com/rock}a#aca)

4.7.8 / 2016-11-14
5=====½=========<5 * fix(querxcursoR©: clea2 {tack when iterating mnto"next loc #46)7
 * fix: handle nulm keys IO valiäation er2or #t693 #´689`[qrciisioe](htups://giôhub.cmm/arciisinM)
!* fiX(populate): hendle$pre!init middlewáre correctly with populate ~irtuals #t683
 * fixhboîngctioo):`ensuze conskstenu return value for /pån and!openSet #4659
!* fix(schema): haNdle falsy defaultw for crpaùó #4620
4.7>· / 2016=11-10
==5=}=========}===
 *(fix(document): moly infalidate in subdoc if uséng uphaue valifat/rs #4681
 * fix(document)> toj't create subdo#s when exclu$ed in projection #4661
 * fix(dOculent(: ensuòe smngle embeddel sbhemadvcli$ator runs with correct Context #4663
 * fix)document): maëe sure to0depopu,ate top låvel foR shavding #4658
 * fix(connåction): thrïw eore helpful årror ghmN .model() cilled incoprestdy #$652J * fix(populate): throw more dessriptmwe ebror wheþ$trying t populate á virtuaì that doasn't haöe prorer options #<v02J * fyx*document): ensure subtype gets se| properly when savijg with a bubäer id #4506
 * fiz qõery): handle setDefa}ltsOnInsert with äefaults on doc arra9s #4454
 * fix(driverw): mske debug ouôput better by ca,ling toBSON()!#4316

4.6>6 + 2016-11-03
?9==5======}=====5
$* chore: upgrade duPs`'4674 _TrehGõn](httPs://gmthur.colTrejGun)
 * chore:`ren tests oj node v7 #4673 {TrejWun](https*./github.c.m/TrejGun)
 * perf: íake setDefcultwKnInsebt moòe!efficieNt if uprert is off #4672 [CAmenl)n](https://github.com/Aamhenli/)
 * fih(porulave): ensure doctmenô ar2ay is reterned #4656
(*`fix(query): cast doc arrays`witl positamnals correcply for update$#4655
 * fih(dmc}ment)8 ensube singme nested d¯c valadators ru~ with correct context(c4654
 * fix: han&le reco~nect faileD error in`.ev version!of driv%2 #425 _lïris](https://githf.agm/ìoris)
 * fix(populate):$if setting a populauet loc, taju its$id +4632
 *" fix(populate): handleppopulatet virtuals In hnit #4618

4.6.5 / 6116-10-23
=============}====
 * docó: æix!grammar assues #4642 #4v40 #4639 [silvermanj7](h}Tps://gathub.com/silvermanj7)
 *`fix(populate): filter ott noneøistant values Fos dyfref #4637
 * fix(query): handle $type as a schematype operatos #4633
 * fix(3chema):better(handling for tppercase: galwe aod lowercase:(false #4622
 * dix(ñuery): don7t run tralsforms kn updatåFoòExec(© "4621
 * fix(qu%ry): hcndle ie"= p in gi.dById #4610
 * f)8(query): handLe buvfers in mergeClïne #4609
 
 fix(doctment): `andle uîdefinee wi|i"conditiofal va,idator for valhdateSync #4607
 *(fix: upgzade |ï mongdb dviver 2.2.11 #45(1
`* docs¨schematypes):`ãdarify schema.path() #4518
 * fix(querq): en{}re pAth is d%finedbbefore chgcking in ti}estamps #45140*(fix(model): sop verSkon key"in upsert #4%05
 * fix($ocumånt): never depoptlate tor-lavel dos #3057 * refactor* ensure cyns fnr setting non-capped$collections #2690

0.6.4 g$001¶-1q-1>
-====5=9=========
 * fix(query): cast $not cnrrecply #4212 "45)2![prssn](https*//gét(ub.Com/prssn)
 * fix: addr%ss issue$with ca#hing global plug)ns #4608 #46p1 [TrejGUj]*https://gi4hub.c/m/TrejGun)
 * fix(}odåli: make {ure to depopulate in insertMany #45=0
 * fix(model)º buffgr aõtIndex if bu&æerCommands disabled #4589J * fix(populatE): copy idc array before$modifyéng #4585
 * feat(schemi	: add petainKeyOrdår prop #4542
 * fix(dgcõment): return hsModigied trua for chaldsen of direct moeifled pqths #4538
 : fix(gon.ection): ad` dropDatabace() helper #4490
 * fix(model): add eseQushEach option dkr schemas #445u* * focshconnections): add some warnIngs about bufferiNg #4413
 * fix: add ability to set prnmi3e`implementction in browseR +4395*
4.6.3 / 2016=10-0u
===<===}=½======?=
 * fix(document): unstre!single nested docs g%t inytiali{eä cOrrectly whgn se4ting nested paths #4578
 * f+x>$ttrn(off transforms$when writing nested docq to db #4574
 * fip(document): don't s%t shngle ~esped subdocs to null`when remo6in' perent doc #4566
 * fixmotel)3 ensure versionOey gets set in i~sertMany""4µ61
 * fix(ssjema): hajdle t{peKey in aRrays$<548
 * feat(schema): set $implicitlyCreaTed on(scheMa if`created by$intmspòeuAsPype #4443

4/6.2 / 2016)09-3
=================
 * chore: upgrade to async 2.0.1 )nuernally #4579 Ûbil|ouboq],https://github.com/billouBoq)
 * fix(types(: ensure nested`single doc schema ervors reach uqdate vAlidátors #4557 #4%19
 * fyx(connection)8(handle rs .imer wiôh meading ntmrezs )íuri 1®1.1) #4556
 . fix(model):(don't throw if method name gofflicts witè Object.prototype prop #455±
 +"dos3: fix b2okel Lmnk #4544 [VFedyk](https://gi4hub.com/VFetyk¹
 * fix: allow o~eòwriting model on mongoose wingìeton #454± [Nainterceptor](hpdps://çithub.com/Nainterceptor)
 * fix(docemejt)> don't use init: true hdn building dïc defatlts$#4540
 * fix(connection); usm ruplSet option if òeplset not specified #4µ5
 * dixquery): cast $not obze{Ts !<495

4>6/1 / 2016-09-20
=-===========?====
 *(fix(querù): improve handling og $not with $ede-Mavch #45s1`#3719 [timbowhite](https://github.com/timbowj)te)
 * fix: upgrade mongodb(-> r.2.10!+45q7
 +0bhmre? fix Webp!ck build éssue !4502 [saiichéhashimoto](httpsº//githuf.com/saiichihashimoto)
 *$fix(query): emit error nn next |ick wHen ehec callback errors #4509
 * test: improv% tes4 case #4496 [isayme](https://github.coM/isayme)
 * fix(schemc):$use same cjesk for arrey t9pes a.d top-hevel types #493
 * style: fax in`ent!tion in doas #4489 [dhurlburpusaß(http3://gi4dub.com/dhuvlburtusa)
 *0fixhscjema): expose originaÌ object passmd to constvucuor #4˜6
 * féx(1õery : handle findOfeAndUrlate wht( array of arrays #4484 #4470 [fedotov])https://github.ckm/fedoôov)
 * feqt(document):badd $ifnore to make a pavh ignore` #4480 * fip(query): properly handle setting single emfedded in uudate #4475 #4466 #t4&5
 * fix(updateValidators): handle single nested schema subPaths correctly #449
 ( fix(model): throw handy ebrOv when medhod name conflicts with(property name #4475
 * fix(schema):(hanlle .set() wath irray field #4472
 : dix(query): check nesped path when avoiding!double-validatIng"Mhxed #4441
 : fi|(scèeea): iandle calhing tath.trim() wit` No argS correctly #4042

t.6.0 / 2016-09-02
=}===============-
 * docs(document(: clarify the!findById and BindByIdAndpdcTe examples c4471 [mdcanham](https2//githuf.com/mdcanham)
 *0docs(s#hematypes): ald fetails re: optins #$452
 
 docó(middleware): ad` docs(for insurtMany hooks c4451
 * fix(schema-: create new array when copqing from exi{ting object to presepve cjange trackioç #4449
 ª docw: fix pypo in index.jade 34448
 *"fix)queRy): ahlow array for populate option2 #4446
 * fix(model): create"should nnt causå unhandle reject p2nmhse c4439
 * dix: upgrade tn mongodb driver 2.2.9 #4363 #43t1 #4#11 (rue [comments!here](h|tps://')thub.com/mongodb/j÷-bsmn/commit/aa2b=45;7a áf8cce3530d214<af708e4b66bf0#commiucOmment-1885049x) if you use node p.10+

4.5.10 / 2016-0-23*===========}=======
 * docs: fix typo on documents.jade #4444 [Gabri3lY(https://github.com/G!bri3l)
 " ch/re: upgrAde(mocha to 3.0.2 #4437 [TrejGun](https:./gith}b.com/TrejGun)
 * bhx: subdocuients causing errob witx parent timestamp on update #4424 [dyang108](https://gathub.cm/dyang108)
 * fix(query): doN't crasj if timestamps oo and update doesn't have`a path #4$25 #4424 #4418
 * dix(query): unsere single Nested su"d/c is hydratåd when rennmng upda|e validat/vs #4420
 * fix(query): cast noo-$geometry operators for $geoWitèin +4419 * docs:0update cont2ibutor count #4415 YAdamZaczek](https://github.com/AdamZaczek)
 . docs: aäd!more clarifica|kon re: th% iodey event !$4!0
 * fIx(dncment): olìy skip modifying sucdoc path if parent is direcT$modiFied #4405
 * féx(rcH%mq9: throw cast arror if provided dãte invalid$#4404
 h feat(eprmr): use util.inwpect*) sm$CastEbror never prh.us "[object Object]# #4398 * fix(model): dont error if the déscriMinator key(is unCHenged #4387
 * fix(query): don't throw unhandled rejection With b|tebiR` when usinG cbs #4379
4*5.9 / 2016-08-14
=======9====<===½9
 * d/cs*$add mixed schema doc for Object liveral #440  [Kikobeatw](èttps://github.com/Kikobeats)
`* fix(ñuery): cast $geoWidhin and convert mngoose objects to POJOs(befora sasting #4392 * fix(schematype): lnt gast dafaulds vit(ouv parent dmc £43¹0Š * fix(query): $isallow passing mmpty string 4o gindOne() #4358
 *"fix(document): se| sincle nestae`doc isNew corbectly #4369
 * fix(types): checks fielf name correctly with`n%sted arrays anl populate '4365
 * fix(drivers): make debug output copympastcble inTo monfodb shell #4352
 * fix(sarvices: sun update 6alidators on n`ste$ paths &4332
 * fix(model): haîdle t{peKey wyth discriména4ors #4339
 + fiz*qõery): apply timestamps to ch)ld sghema{ when explicit,Y SpecIfied In update '4049
0* fix(schela): cet prefix as nestef path with add() #1730
Š$n5.8 / 2016-08-01
==}==5=========1=`* déx(mndel): meke changing the`dksãriminator key caUse a cast error #4374
 * fix(quEry): pass prokection fieLds to #ursop #4371 #4342 [Corei13](hdôps://github.com/Corei13)
 * fax(document): suppoòt multiple paths for isModigied #4370 [ada}buczyns+i](èttps://github.com/adambuczynrki)
 * fi|(quåri#ursor): always aast fields before returnkng c}rsor "4375
 * fix(query): sõpport projaãtiOn as alias for fiellr in findOneAnlUpdate #4315
 * fix(schema); treat index false # unique false as no index #4304
 ª fixhtypes): `on| marj singlg nestel subpa|h as modified if whkle doc already mmdified`#4224

4.1.7 / 2016,07-25
½=========½==-====
 * fix(focument): enrure$no Unhandled rejections if$camlbaak spEcified$for óa~e #4364

4.5n6 ? 2016­07-23
=9==========?==5==
 * fi8(schema): `on't overwritE createdAt ib it isn't selected #43e1 [tõsbaV_(https://giThub.com/tusbar)
 j docs(api): fix link`to popelate() end ald a ~ew one from depopulate() #4345 [DeLapouite](https://github.cfm/Delapouite)
 * fix(tQpes):(ownerDocument() works properly(with"single nested docs #43´4 [vichle](https://gathub.coi/vichle)
 * fix8pgpulate): dont uså findOlm wheN justOna mxtion set #4329
 * ~ix(docw-enp)* `ont trigger .then() detrecated uapnmng whEn0calhing dc.remove,) #4291
 * docs(cofnection):"idd p2omiseibrary option #4280 * fix(pìugins): appl} glbal plugyns tn su"qchgmas #4271
 * fix(-odel)2 ensure `ensureIndep()` never callq bAck in the same`tick #42´6 * docs(schemá):"imqrcve(ðost xook $ocs ïn schmma #4238

4.5.5 ¯ 2017-07-18
==========}======
 * fix(dobumeht): hin`le setting root to emp4q obj if minimize fals%@#4337
 * fKx: downgrale to mongodb 2.1,1< #4337 #4334 #4328 #4³23
 * perf(types): remove definePro0erty usage in0documentarray #4733
 * fix(quepy): cg2rEctly pass modml )n .toConstructor*( #4319
 *!fix(servéces): avoid duble-valifaping miped tyPes with update validators #<25
 ( docs,mid$leware): Add docs describing error handling middleare #4229
 * fix(types): throw correct epror*when invalidauing doc array #3602

4n5.4 / 2016%07-11
=====½============
 * vixhtypds): fix removing embedded documents #4309$[RoCat](èttps://'ithub.com/roGap)
 * dobs: öarious docs imprnvemånvs #43p2 #4394 [simonxca](h|tps://github,com/simonxci)
 * fix: uqgsade mongodb %> 2.1.21 #t2y5 #4202 [ocat](https:/.github.com/RoCat©
 * fix(populate)0 Convert singlå result to array fkr vir4ual populatE because of lean #4288!( nix(populate)º èa~dle Empty results for populate virtuals pro`erly #4285 #4284
 * fix(queby):`dont cast $inc to number if type isäLong #4283
 *¤vix(uypes): allow sett)ng qingle nested doc po null #4285
 * fix(popUìate)* handle dee0ly nested viruual populAte #4278
 * fix(document): allkw setting eipt} obj if stracv mode is0false #4274
 * fix(aocrega4e): allow passI~g obj!to .unwind)!#42;9
 * docs)document): ad` return"statements to transform eximples #1i63

4.5.3 / 2016-06-30
==m===============
 * fix(query): pass correct options to QueryCursor$#4277 #4"66
 * fix(querycursos): handhe |ean optio. correc4ly #4276 [gchuenov](https://çithub&com/gchudnoö)
 j fix(dOcument): fix error handling when nk eRror oCcurrEd`#4275
 * fix(%vror): use strmct mode fïr version error #4272
 * docs(populate-: fix crashing #ompilation fOr popudat%.jade #4267
 * fix(popul!tå): support `justOne` optikn for popunatE virtuals #4263
 * fix(popuäitg): ensure model pqram gets used"for populate virtuals #4263 #4243
 * fix(querycupsor): ald ability to properly closg the cursor #4"58
 * docs(lodål): coprecT link To Document #4251
 * tocs(populate): correcô path fOr refPath populate #4040
 * nix(docume.t+:"wu`pOrt validator.isEmail as validetor #4064

4.5.2 o 2416-02-24
==============<===
 * f)x(connection(: qTd chacks for collection presence"for `onOpen` `nd `onClose` #4259 [nodkz](https://githuj.com/nodz)
 * fix(cast+: qllow strings for $tyPe operatOr c425²
 *0fix(querycursos)* sqpport hean() #4255 [ðyramataon](ht4ps://githuâ.com/pyramatikh9
 * fixaggregate)z aílow$setting noCursorTimeout option £4241
 
 fix(document): handle undufined for Array.pull #42²2 [Se`master](https://github.gom/Sebmaster)
 * fix(connection): en3urd prnmire.catch() catchas initiaì c/nnection årrgr #4135
 * fix(document-: show aäditmooal conteyt for V%rsIonEpror0#263
45.1 / 2016-06-1<
===5==============
 * fix(model): ensu2e wrapped(ansertMany() returns a promiSe #4237
 ª fix popwmate): dnt overvrite populateVirtualr when pOpulating multiple paths #4234
 * docs(íodel): ãlárify relationship between cre`ôe(9 `nd sive() #´233
 * fix(typgs): handle optIon q)raM in surdoc remove() #4231 [tdebarochgz](https://Gkthub.com/tdebarochez)
 * fix0doc}ment): fedupe modified paths #4226 #4223 [adambuczynskiU(https://github.aoí?adambuczynski) * féx(model+: d/n't modify user-providåd options o"ject #<221
$* fix(documenv): handme setting nested!path tï emtty`obj%ct #<218 #4182
 *`fix(document): clean subpatès when removing single nested #4216
 " fix(doCumend): don'v for#e traosn/rm on subdocs vith )nspect #4213
 * fix(error): allow sutting .messaees objgct £4207

4.5.0 / 2016-06-13
====-========½====
`+ feat(quepy): added Query.prototype*catch() #421u #4173 [adambuczynsci]*https://gitlubcom/atambuczynski-
0* feat(quera): idd Query.protktipE.#urwor()"as ! .stream() alternative #4117`363 #1907
 *(feaT(docement):"add markUfmodified() func`ikl #t0=2 [vmncentcr](https:/gith}b.co-/vincentcr) * Feat(aggreg!te): convert aggr%gatu object to a thenable #3995 #3946 [megagon](httpS://github.cgm?megagon)
 * perf(ty0es): remove definePro0erties call fo2 array$(**Note:** Becaese of`this, a -ongoose `rzay wyll nn longer(`assert®deetEqUal()` a plain old JS arzcy) #3886 * feat(modgl): add hooks for inservMany()$#3846
 *(feat(sahema): add support for curtnm query methods #3740 #2372
 ( feat(dravers): emit error on 'serverClosed' because |hat means thau reconnåct gailed '36!7 * fea|(model)º emit error event when callback tHrows ehception '349¹ * feqt(model): inèerit options from discriminator baw% schema #3414 #1818
 * feat(populate): expose mongoose-populate-virtuals inspired"populate"API #2562
 *(feat(doãument): trigger veoove hooks on$subdocs when removing parent #²348
$* feat(schema): add support foò express-style arror handling middlewara #2284
 * fix(model): disilnow setting discriminator key #2041
 * fa!t(schemq): a$d wupport bor nested0arrays #1361
J4.4.20 / 2016-06-05
========½==========
 *"dcs: clqriny comícnd juffering$when using drivar directly #4195
 * fix(psomise); corre#t broken mpromisd .catch() #4189
 * fix(document) clean modified subraths when seu path tm empty obj #4182
 *$fix(query): support minDista~ce wI4h query kasding ind `.neap()a #4179
 . nix(moeel): remove"uNnecessary(.save8) promisu #4177
 * fix(schema): cast all valid ObjectIt strings to object$i$s #3365
 * docs: remove qn#mear "unsage" term(in query docs #1282

4.4.19 / 2016-p5-01
===================
 * fix(model)º handle insa2tMany if ti-estamps(not"set £4171

4.4.18 / 2016-0m21
==========-=======
 * docq: add oi{sing periOd #4970![gitname](htTps://gith5b.com/çitname) : docs: chaNge build badee to svg #4558 [a0vied/](https:/githwb.com/a0viedo)
 * dix(lodel): update Timestamts when setting `createDCt` #4155
 * fix(utils): make sure to råauire in doãument pr¯perly '4152
 * fix(model): throw$oveswsitm errïr wlen discriminat/r name conflicts #41<x

$.4.17 / 2p16-01-13
==========-=}======
 * docs: remove reretition in QueryStream docs #4147 [hu'Oabonizio_(htvps:/+github.com/hugoabonizio)
 j fiy(document)> dont doublm-validate doc árray elements "4145
 *0&ix(document): ca|l requkrmd function ÷ith cOrrect scgpe 4162 [JedWatóon](https://githuf.goM/BedWatson)

6.4.16 / 2016- 5}0;
====9===-==========
 * refactorhdocumänt): usa"functhnn refurejce #4133 Ktc	ccale](https://github.kom/dciccale)
 * docs(querqstream): glarify `destroy()` and clkse evgnt #0126 [AnthonyCC](xttps://git`uj.com/Antho>yCC)
 * tEst: máke before hook fail fiS4 iF it can't connect #4121
!* docs: eed dewcription Of CastErrob constbustov paraor #4120 * fip(sc`emctype): ensure sing|e %mbedded`de&`ults`have $paòejt #4115
 * fix(lgcument): mari nuSted paths for valiàation #411Q
 * f)x,schema): mcke sure qleoeLt is a|7ays a sub$ïc in`doc abray öqlidation #3816
Š4®4.05 "2006-05-06
=======5=5=========
 * fkx(schema): suPpnrt overritiNg `rray tefault #4109
 * f)x(populate): assign 6alues when resolving aach populate #t904
 "!fix(aegregate): äont sgnd as9îc option to server #4111
 * fix(mod%l): ensure )sÎew set to false after insertMany$#4099
 * féx(connection): dmit`on error éf listeners and no calìback #409(
$*0fix(document): treaô 2equired fn that returnq false as required false #4094

*4.14 / 201v-0427=============-=====
 * fix* upgradå momgodb -> 2.1.18 #4102
 * æeat(coînection): allow sett)ng mongos as"a uri quåry param`#4093 #4035 [burtonjc]¨https://github.com/burtoljc) * fiX(populatg): make sure to use correct assignmeît order foz each model #4073
 * fix(schema): add complete set of gekrpatial operators for single emBeddeD subdocs #4014

3.8.40 / 2016-p4-24
======½;===========
 + uperaded: mquEry -> 1.10.0 #3;x9

4.4.13 /!2016-04-21
===================
 * docs: add docs fávicons #4082![robertjustjonus](https:/-github.com/rObertjustjones)
 * docs(model¨: correct Modgl.remove() ruturn váluE #4075 [Jokero](h|tps://github.com+Jokero)
 * Fix(query): Add $geoWithin query gactino fo2 sino,a gmbudded docs #4044
 * fix({chema)8 handle setting trim optin to falsy #40$2
 *!fix(query): hand,e setDafauhtsOnInsert wéth!mmpty }rdate #3835

4&4.12 - 2016-04-08
==========}==}=====
 * docs(query)* document context option(for update and findOleAnäUpdate #4055
 *`docs(query-:`correct link to $gåoWithin focs #005p
 * Fix(projebt): upgrade to mongodb driver 2.1.16"#4048 [3chmal,ico](https://gathub.com/schmallIso)
 * docs(validatinn): fix v!lidation docs #4068
 
 fix(types): improve .id() checc vor document qrsays #4011
 : fix(query): remove qremat5re return hen uqiNg $renaíe #1171
 ( docs(coÎnectio~):$glarif} ren`tionshyp betw%en models and ãonnestaons #21t?

4.4.11(/ 20q6-24-03*==========}=======}
 ª fix: epgradg to mongofb dr)vez`2.1.14 #403& #4030 #3965
 * fix(connectioj): allow colnectiîo wyth ù mongos: true } t handle yueby params +4032 "urt/njc])hd4ps://gathub.com/Burtonjc)
 * docs(connecvinn): add autokndex example #4024 [tilleps](https://github.com/tilleps)
 * fix(querx): hafdle paósRawResult optaon when zerï0resultS #4023
 * fix(pmpulatE): clo.e options refore modéfying #4022 *0focs: add missing whitespace #4019 [chenxsan](https://github.com/chenxsan)
 * chore: upgrade to ESLint 2.4.0 #4015 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fix(types): single nested subdocs get ids by default #4008
 * chore(project): add dependency status badge #4007 [Maheshkumar-Kakade](http://github.com/Maheshkumar-Kakade)
 * fix: make sure timestamps don't trigger unnecessary updates #4005 #3991 [tommarien](https://github.com/tommarien)
 * fix(document): inspect inherits schema options #4001
 * fix(populate): don't mark populated path as modified if setting to object w/ same id #3992
 * fix(document): support kind argument to invalidate #3965

4.4.10 / 2016-03-24
===================
 * fix(document): copy isNew when copying a document #3982
 * fix(document): don't override defaults with undefined keys #3981
 * fix(populate): merge multiple deep populate options for the same path #3974

4.4.9 / 2016-03-22
==================
 * fix: upgrade mongodb -> 2.1.10 re https://jira.mongodb.org/browse/NODE-679 #4010
 * docs: add syntax highlighting for acquit examples #3975

4.4.8 / 2016-03-18
==================
 * docs(aggregate): clarify promises #3990 [megagon](https://github.com/megagon)
 * fix: upgrade mquery -> 1.10 #3988 [matskiv](https://github.com/matskiv)
 * feat(connection): 'all' event for repl sets #3986 [xizhibei](https://github.com/xizhibei)
 * docs(types): clarify Array.pull #3985 [seriousManual](https://github.com/seriousManual)
 * feat(query): support array syntax for .sort() via mquery 1.9 #3980
 * fix(populate): support > 3 level nested populate #3973
 * fix: MongooseThenable exposes connection correctly #3972
 * docs(connection): add note about reconnectTries and reconnectInterval #3969
 * feat(document): invalidate returns the new validationError #3964
 * fix(query): .eq() as shorthand for .equals #3953 [Fonger](https://github.com/Fonger)
 * docs(connection): clarify connection string vs passed options #3941
 * docs(query): select option for findOneAndUpdate #3933
 * fix(error): ValidationError.properties no longer enumerable #3925
 * docs(validation): clarify how required validators work with nested schemas #3915
 * fix: upgrade mongodb driver -> 2.1.8 to make partial index errors more sane #3864

4.4.7 / 2016-03-11
==================
 * fix(query): stop infinite recursion caused by merging a mongoose buffer #3961
 * fix(populate): handle deep populate array -> array #3954
 * fix(schema): allow setting timestamps with .set() #3952 #3951 #3907 [Fonger](https://github.com/Fonger)
 * fix: MongooseThenable doesn't overwrite constructors #3940
 * fix(schema): don't cast boolean to date #3935
 * fix(drivers): support sslValidate in connection string #3929
 * fix(types): correct markModified() for single nested subdocs #3910
 * fix(drivers): catch and report any errors that occur in driver methods #3906
 * fix(populate): get subpopulate model correctly when array under nested #3904
 * fix(document): allow fields named 'pre' and 'post' #3902
 * docs(query): clarify runValidators and setDefaultsOnInsert options #3892
 * docs(validation): show how to use custom required messages in schema #2616

4.4.6 / 2016-03-02
==================
 * fix: upgrade mongodb driver to 2.1.7 #3938
 * docs: fix plugins link #3917 #3909 [fbertone](https://github.com/fbertone)
 * fix(query): sort+select with count works #3914
 * fix(query): improve mergeUpdate's ability to handle nested docs #3890

4.4.5 / 2016-02-24
==================
 * fix(query): ability to select a length field (upgrade to mquery 1.7.0) #3903
 * fix: include nested CastError as reason for array CastError #3897 [kotarou3](https://github.com/kotarou3)
 * fix(schema): check for doc existence before taking fields #3889
 * feat(schema): useNestedStrict option to take nested strict mode for update #3883
 * docs(validation): clarify relationship between required and checkRequired #3822
 * docs(populate): dynamic reference docs #3809
 * docs: expand dropdown when clicking on file name #3807
 * docs: plugins.mongoosejs.io is up #3127
 * fix(schema): ability to add a virtual with same name as removed path #2398

4.4.4 / 2016-02-17
==================
 * fix(schema): handle field selection when casting single nested subdocs #3880
 * fix(populate): populating using base model with multiple child models in result #3878
 * fix: ability to properly use return value of `mongoose.connect()` #3874
 * fix(populate): dont hydrate populated subdoc if lean option set #3873
 * fix(connection): dont re-auth if already connected with useDb #3871
 * docs: cover how to set underlying driver's promise lib #3869
 * fix(document): handle conflicting names in validation errors with subdocs #3867
 * fix(populate): set undefined instead of null consistently when populate couldn't find results #3859
 * docs: link to `execPopulate()` in `doc.populate()` docs #3836
 * docs(plugin): link to the `mongoose.plugin()` function #3732

4.4.3 / 2016-02-09
==================
 * fix: upgrade to mongodb 2.1.6 to remove kerberos log output #3861 #3860 [cartuchogl](https://github.com/cartuchogl)
 * fix: require('mongoose') is no longer a pseudo-promise #3856
 * fix(query): update casting for single nested docs #3820
 * fix(populate): deep populating multiple paths with same options #3808
 * docs(middleware): clarify save/validate hook order #1149

4.4.2 / 2016-02-05
==================
 * fix(aggregate): handle calling .cursor() with no options #3855
 * fix: upgrade mongodb driver to 2.1.5 for GridFS memory leak fix #3854
 * docs: fix schematype.html conflict #3853 #3850 #3843
 * fix(model): bluebird unhandled rejection with ensureIndexes() on init #3837
 * docs: autoIndex option for createConnection #3805

4.4.1 / 2016-02-03
==================
 * fix: linting broke some cases where we use `== null` as shorthand #3852
 * docs: fix up schematype.html conflict #3848 #3843 [mynameiscoffey](https://github.com/mynameiscoffey)
 * fix: backwards breaking change with `.connect()` return value #3847
 * docs: downgrade dox and highlight.js to fix docs build #3845
 * docs: clean up typo #3842 [Flash-](https://github.com/Flash-)
 * fix(document): storeShard handles undefined values #3841
 * chore: more linting #3838 [TrejGun](https://github.com/TrejGun)
 * fix(schema): handle `text: true` as a way to declare a text index #3824

4.4.0 / 2016-02-02
==================
 * docs: fix expireAfterSeconds index option name #3831 [Flash-](https://github.com/Flash-)
 * chore: run lint after test #3829 [ChristianMurphy](https://github.com/ChristianMurphy)
 * chore: use power-assert instead of assert #3828 [TrejGun](https://github.com/TrejGun)
 * chore: stricter lint #3827 [TrejGun](https://github.com/TrejGun)
 * feat(types): casting moment to date #3813 [TrejGun](https://github.com/TrejGun)
 * chore: comma-last lint for test folder #3810 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fix: upgrade async mpath, mpromise, muri, and sliced #3801 [TrejGun](https://github.com/TrejGun)
 * fix(query): geo queries now return proper ES2015 promises #3800 [TrejGun](https://github.com/TrejGun)
 * perf(types): use `Object.defineProperties()` for array #3799 [TrejGun](https://github.com/TrejGun)
 * fix(model): mapReduce, ensureIndexes, remove, and save properly return ES2015 promises #3795 #3628 #3595 [TrejGun](https://github.com/TrejGun)
 * docs: fixed dates in History.md #3791 [Jokero](https://github.com/Jokero)
 * feat: connect, open, openSet, and disconnect return ES2015 promises #3790 #3622 [TrejGun](https://github.com/TrejGun)
 * feat: custom type for int32 via mongoose-int32 npm package #3652 #3102
 * feat: basic custom schema type API #995
 * feat(model): `insertMany()` for more performant bulk inserts #723

4.3.7 / 2016-01-23
==================
 * docs: grammar fix in timestamps docs #3786 [zclancy](https://github.com/zclancy)
 * fix(document): setting nested populated docs #3783 [slamuu](https://github.com/slamuu)
 * fix(document): don't call post save hooks twice for pushed docs #3780
 * fix(model): handle `_id=0` correctly #3776
 * docs(middleware): async post hooks #3770
 * docs: remove confusing sentence #3765 [marcusmellis89](https://github.com/marcusmellis89)

3.8.39 / 2016-01-15
===================
 * fixed; casting a number to a buffer #3764
 * fixed; enumerating virtual property with nested objects #3743 [kusold](https://github.com/kusold)

4.3.6 / 2016-01-15
==================
 * fix(types): casting a number to a buffer #3764
 * fix: add "listener" to reserved keywords #3759
 * chore: upgrade uglify #3757 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fix: broken execPopulate() in 4.3.5 #3755 #3753
 * fix: ability to remove() a single embedded doc #3754
 * style: comma-last in test folder #3751 [ChristianMurphy](https://github.com/ChristianMurphy)
 * docs: clarify versionKey option #3747
 * fix: improve colorization for arrays #3744 [TrejGun](https://github.com/TrejGun)
 * fix: webpack build #3713

4.3.5 / 2016-01-09
==================
 * fix(query): throw when 4th parameter to update not a function #3741 [kasselTrankos](https://github.com/kasselTrankos)
 * fix(document): separate error type for setting an object to a primitive #3735
 * fix(populate): Model.populate returns ES6 promise #3734
 * fix(drivers): re-register event handlers after manual reconnect #3729
 * docs: broken links #3727
 * fix(validation): update validators run array validation #3724
 * docs: clarify the need to use markModified with in-place date ops #3722
 * fix(document): mark correct path as populated when manually populating array #3721
 * fix(aggregate): support for array pipeline argument to append #3718 [dbkup](https://github.com/dbkup)
 * docs: clarify `.connect()` callback #3705
 * fix(schema): properly validate nested single nested docs #3702
 * fix(types): handle setting documentarray of wrong type #3701
 * docs: broken links #3700
 * fix(drivers): debug output properly displays '0' #3689

3.8.38 / 2016-01-07
===================
 * fixed; aggregate.append an array #3730 [dbkup](https://github.com/dbkup)

4.3.4 / 2015-12-23
==================
 * fix: upgrade mongodb driver to 2.1.2 for repl set error #3712 [sansmischevia](https://github.com/sansmischevia)
 * docs: validation docs typo #3709 [ivanmaeder](https://github.com/ivanmaeder)
 * style: remove unused variables #3708 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fix(schema): duck-typing for schemas #3703 [mgcrea](https://github.com/mgcrea)
 * docs: connection sample code issue #3697
 * fix(schema): duck-typing for schemas #3693 [mgcrea](https://github.com/mgcrea)
 * docs: clarify id schema option #3638

4.3.3 / 2015-12-18
==================
 * fix(connection): properly support 'replSet' as well as 'replset' #3688 [taxilian](https://github.com/taxilian)
 * fix(document): single nested doc pre hooks called before nested doc array #3687 [aliatsis](https://github.com/aliatsis)

4.3.2 / 2015-12-17
==================
 * fix(document): .set() into single nested schemas #3686
 * fix(connection): support 'replSet' as well as 'replset' option #3685
 * fix(document): bluebird unhandled rejection when validating doc arrays #3681
 * fix(document): hooks for doc arrays in single nested schemas #3680
 * fix(document): post hooks for single nested schemas #3679
 * fix: remove unused npm module #3674 [sybarite](https://github.com/sybarite)
 * fix(model): don't swallow exceptions in nested doc save callback #3671
 * docs: update keepAlive info #3667 [ChrisZieba](https://github.com/ChrisZieba)
 * fix(document): strict 'throw' throws a specific mongoose error #3662
 * fix: flakey test #3332
 * fix(query): more robust check for RegExp #2969

4.3.1 / 2015-12-11
==================
 * feat(aggregate): `.sample()` helper #3665
 * fix(query): bitwise query operators with buffers #3663
 * docs(migration): clarify `new` option and findByIdAndUpdate #3661

4.3.0 / 2015-12-09
==================
 * feat(query): support for mongodb 3.2 bitwise query operators #3660
 * style: use comma-last style consistently #3657 [ChristianMurphy](https://github.com/ChristianMurphy)
 * feat: upgrade mongodb driver to 2.1.0 for full MongoDB 3.2 support #3656
 * feat(aggregate): `.lookup()` helper #3532

4.2.10 / 2015-12-08
===================
 * fixed; upgraded marked #3653 [ChristianMurphy](https://github.com/ChristianMurphy)
 * docs; cross-db populate #3648
 * docs; update mocha URL #3646 [ojhaujjwal](https://github.com/ojhaujjwal)
 * fixed; call close callback asynchronously #3645
 * docs; virtuals.html issue #3644 [Psarna94](https://github.com/Psarna94)
 * fixed; single embedded doc casting on init #3642
 * docs; validation docs improvements #3640

4.2.9 / 2015-12-02
==================
 * docs; defaults docs #3625
 * fix; nested numeric keys causing an embedded document crash #3623
 * fix; apply path getters before virtual getters #3618
 * fix; casting for arrays in single nested schemas #3616

4.2.8 / 2015-11-25
==================
 * docs; clean up README links #3612 [ReadmeCritic](https://github.com/ReadmeCritic)
 * fix; ESLint improvements #3605 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fix; assigning single nested subdocs #3601
 * docs; describe custom logging functions in `mongoose.set()` docs #3557

4.2.7 / 2015-11-20
==================
 * fixed; readPreference connection string option #3600
 * fixed; pulling from manually populated arrays #3598 #3579
 * docs; FAQ about OverwriteModelError #3597 [stcruy](https://github.com/stcruy)
 * fixed; setting single embedded schemas to null #3596
 * fixed; indexes for single embedded schemas #3594
 * docs; clarify projection for `findOne()` #3593 [gunar](https://github.com/gunar)
 * fixed; .ownerDocument() method on single embedded schemas #3589
 * fixed; properly throw casterror for query on single embedded schema #3580
 * upgraded; mongodb driver -> 2.0.49 for reconnect issue fix #3481

4.2.6 / 2015-11-16
==================
 * fixed; ability to manually populate an array #3575
 * docs; clarify `isAsync` parameter to hooks #3573
 * fixed; use captureStackTrace if possible instead #3571
 * fixed; crash with buffer and update validators #3565 [johnpeb](https://github.com/johnpeb)
 * fixed; update casting with operators overwrite: true #3564
 * fixed; validation with single embedded docs #3562
 * fixed; inline docs inherit parents $type key #3560
 * docs; bad grammar in populate docs #3559 [amaurymedeiros](https://github.com/amaurymedeiros)
 * fixed; properly handle populate option for find() #2321

3.8.37 / 2015-11-16
===================
 * fixed; use retainKeyOrder for cloning update op #3572

4.2.5 / 2015-11-09
==================
 * fixed; handle setting fields in pre update hooks with exec #3549
 * upgraded; ESLint #3547 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fixed; bluebird unhandled rejections with cast errors and .exec #3543
 * fixed; min/max validators handling undefined #3539
 * fixed; standalone mongos connections #3537
 * fixed; call `.toObject()` when setting a single nested doc #3535
 * fixed; single nested docs now have methods #3534
 * fixed; single nested docs with .create() #3533 #3521 [tusbar](https://github.com/tusbar)
 * docs; deep populate docs #3528
 * fixed; deep populate schema ref handling #3507
 * upgraded; mongodb driver -> 2.0.48 for sort overflow issue #3493
 * docs; clarify default ids for discriminators #3482
 * fixed; properly support .update(doc) #3221

4.2.4 / 2015-11-02
==================
 * fixed; upgraded `ms` package for security vulnerability #3524 [fhemberger](https://github.com/fhemberger)
 * fixed; ESlint rules #3517 [ChristianMurphy](https://github.com/ChristianMurphy)
 * docs; typo in aggregation docs #3513 [rafakato](https://github.com/rafakato)
 * fixed; add `dontThrowCastError` option to .update() for promises #3512
 * fixed; don't double-cast buffers in node 4.x #3510 #3496
 * fixed; population with single embedded schemas #3501
 * fixed; pre('set') hooks work properly #3479
 * docs; promises guide #3441

4.2.3 / 2015-10-26
==================
 * docs; remove unreferenced function in middleware.jade #3506
 * fixed; handling auth with no username/password #3500 #3498 #3484 [mleanos](https://github.com/mleanos)
 * fixed; more ESlint rules #3491 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fixed; swallowing exceptions in save callback #3478
 * docs; fixed broken links in subdocs guide #3477
 * fixed; casting booleans to numbers #3475
 * fixed; report CastError for subdoc arrays in findOneAndUpdate #3468
 * fixed; geoNear returns ES6 promise #3458

4.2.2 / 2015-10-22
==================
 * fixed; go back to old pluralization code #3490

4.2.1 / 2015-10-22
==================
 * fixed; pluralization issues #3492 [ChristianMurphy](https://github.com/ChristianMurphy)

4.2.0 / 2015-10-22
==================
 * added; support for skipVersioning for document arrays #3467 [chazmo03](https://github.com/chazmo03)
 * added; ability to customize schema 'type' key #3459 #3245
 * fixed; writeConcern for index builds #3455
 * added; emit event when individual index build starts #3440 [objectiveSee](https://github.com/objectiveSee)
 * added; 'context' option for update validators #3430
 * refactor; pluralization now in separate pluralize-mongoose npm module #3415 [ChristianMurphy](https://github.com/ChristianMurphy)
 * added; customizable error validation messages #3406 [geronime](https://github.com/geronime)
 * added; support for passing 'minimize' option to update #3381
 * added; ability to customize debug logging format #3261
 * added; baseModelName property for discriminator models #3202
 * added; 'emitIndexErrors' option #3174
 * added; 'async' option for aggregation cursor to support buffering #3160
 * added; ability to skip validation for individual save() calls #2981
 * added; single embedded schema support #2689 #585
 * added; depopulate function #2509

4.1.12 / 2015-10-19
===================
 * docs; use readPreference instead of slaveOk for Query.setOptions docs #3471 [buunguyen](https://github.com/buunguyen)
 * fixed; more helpful error when regexp contains null bytes #3456
 * fixed; x509 auth issue #3454 [NoxHarmonium](https://github.com/NoxHarmonium)

3.8.36 / 2015-10-18
===================
 * fixed; Make array props non-enumerable #3461 [boblauer](https://github.com/boblauer)

4.1.11 / 2015-10-12
===================
 * fixed; update timestamps for update() if they're enabled #3450 [isayme](https://github.com/isayme)
 * fixed; unit test error on node 0.10 #3449 [isayme](https://github.com/isayme)
 * docs; timestamp option docs #3448 [isayme](https://github.com/isayme)
 * docs; fix unexpected indent #3443 [isayme](https://github.com/isayme)
 * fixed; use ES6 promises for Model.prototype.remove() #3442
 * fixed; don't use unused 'safe' option for index builds #3439
 * fixed; elemMatch casting bug #3437 #3435 [DefinitelyCarter](https://github.com/DefinitelyCarter)
 * docs; schema.index docs #3434
 * fixed; exceptions in save() callback getting swallowed on mongodb 2.4 #3371

4.1.10 / 2015-10-05
===================
 * docs; improve virtuals docs to explain virtuals schema option #3433 [zoyaH](https://github.com/zoyaH)
 * docs; MongoDB server version compatibility guide #3427
 * docs; clarify that findById and findByIdAndUpdate fire hooks #3422
 * docs; clean up Model.save() docs #3420
 * fixed; properly handle projection with just id #3407 #3412
 * fixed; infinite loop when database document is corrupted #3405
 * docs; clarify remove middleware #3388

4.1.9 / 2015-09-28
==================
 * docs; minlength and maxlength string validation docs #3368 #3413 [cosmosgenius](https://github.com/cosmosgenius)
 * fixed; linting for infix operators #3397 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fixed; proper casting for $all #3394
 * fixed; unhandled rejection warnings with .create() #3391
 * docs; clarify update validators on paths that aren't explicitly set #3386
 * docs; custom validator examples #2778

4.1.8 / 2015-09-21
==================
 * docs; fixed typo in example #3390 [kmctown](https://github.com/kmctown)
 * fixed; error in toObject() #3387 [guumaster](https://github.com/guumaster)
 * fixed; handling for casting null dates #3383 [alexmingoia](https://github.com/alexmingoia)
 * fixed; passing composite ids to `findByIdAndUpdate` #3380
 * fixed; linting #3376 #3375 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fixed; added NodeJS v4 to Travis #3374 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fixed; casting $elemMatch inside of $not #3373 [gaguirre](https://github.com/gaguirre)
 * fixed; handle case where $slice is 0 #3369
 * fixed; avoid running getters if path is populated #3357
 * fixed; cast documents to objects when setting to a nested path #3346

4.1.7 / 2015-09-14
==================
 * docs; typos in SchemaType documentation #3367 [jasson15](https://github.com/jasson15)
 * fixed; MONGOOSE_DRIVER_PATH env variable again #3360
 * docs; added validateSync docs #3353
 * fixed; set findOne op synchronously in query #3344
 * fixed; handling for `.pull()` on a documentarray without an id #3341
 * fixed; use natural order for cloning update conditions #3338
 * fixed; issue with strict mode casting for mixed type updates #3337

4.1.6 / 2015-09-08
==================
 * fixed; MONGOOSE_DRIVER_PATH env variable #3345 [g13013](https://github.com/g13013)
 * docs; global autoIndex option #3335 [albertorestifo](https://github.com/albertorestifo)
 * docs; model documentation typos #3330
 * fixed; report reason for CastError #3320
 * fixed; .populate() no longer returns true after re-assigning #3308
 * fixed; discriminators with aggregation geoNear #3304
 * docs; discriminator docs #2743

4.1.5 / 2015-09-01
==================
 * fixed; document.remove() removing all docs #3326 #3325
 * fixed; connect() checks for rs_name in options #3299
 * docs; examples for schema.set() #3288
 * fixed; checkKeys issue with bluebird #3286 [gregthegeek](https://github.com/gregthegeek)

4.1.4 / 2015-08-31
==================
 * fixed; ability to set strict: false for update #3305
 * fixed; .create() properly uses ES6 promises #3297
 * fixed; pre hooks on nested subdocs #3291 #3284 [aliatsis](https://github.com/aliatsis)
 * docs; remove unclear text in .remove() docs #3282
 * fixed; pre hooks called twice for 3rd-level nested doc #3281
 * fixed; nested transforms #3279
 * upgraded; mquery -> 1.6.3 #3278 #3272
 * fixed; don't swallow callback errors by default #3273 #3222
 * fixed; properly get nested paths from nested schemas #3265
 * fixed; remove() with id undefined deleting all docs #3260 [thanpolas](https://github.com/thanpolas)
 * fixed; handling for non-numeric projections #3256
 * fixed; findById with id undefined returning first doc #3255
 * fixed; use retainKeyOrder for update #3215
 * added; passRawResult option to findOneAndUpdate for backwards compat #3173

4.1.3 / 2015-08-16
==================
 * fixed; getUpdate() in pre update hooks #3520 [gregthegeek](https://github.com/gregthegeek)
 * fixed; handleArray() ensures arg is an array #3238 [jloveridge](https://github.com/jloveridge)
 * fixed; refresh required path cache when recreating docs #3199
 * fixed; $ operator on unwind aggregation helper #3197
 * fixed; findOneAndUpdate() properly returns raw result as third arg to callback #3173
 * fixed; querystream with dynamic refs #3108

3.8.35 / 2015-08-14
===================
 * fixed; handling for minimize on nested objects #2930
 * fixed; don't crash when schema.path.options undefined #1824

4.1.2 / 2015-08-10
==================
 * fixed; better handling for Jade templates #3241 [kbadk](https://github.com/kbadk)
 * added; ESlint trailing spaces #3234 [ChristianMurphy](https://github.com/ChristianMurphy)
 * added; ESlint #3191 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fixed; properly emit event on disconnect #3183
 * fixed; copy options properly using Query.toConstructor() #3176
 * fixed; setMaxListeners() issue in browser build #3170
 * fixed; node driver -> 2.0.40 to not store undefined keys as null #3169
 * fixed; update validators handle positional operator #3167
 * fixed; handle $all + $elemMatch query casting #3163
 * fixed; post save hooks don't swallow extra args #3155
 * docs; spelling mistake in index.jade #3154
 * fixed; don't crash when toObject() has no fields #3130
 * fixed; apply toObject() recursively for find and update queries #3086 [naoina](https://github.com/naoina)

4.1.1 / 2015-08-03
==================
 * fixed; aggregate exec() crash with no callback #3212 #3198 [jpgarcia](https://github.com/jpgarcia)
 * fixed; pre init hooks now properly synchronous #3207 [burtonjc](https://github.com/burtonjc)
 * fixed; updateValidators doesn't flatten dates #3206 #3194 [victorkohl](https://github.com/victorkohl)
 * fixed; default fields don't make document dirty between saves #3205 [burtonjc](https://github.com/burtonjc)
 * fixed; save passes 0 as numAffected rather than undefined when no change #3195 [burtonjc](https://github.com/burtonjc)
 * fixed; better handling for positional operator in update #3185
 * fixed; use Travis containers #3181 [ChristianMurphy](https://github.com/ChristianMurphy)
 * fixed; leaked variable #3180 [ChristianMurphy](https://github.com/ChristianMurphy)

4.1.0 / 2015-07-24
==================
 * added; `schema.queue()` now public #3193
 * added; raw result as third parameter to findOneAndX callback #3173
 * added; ability to run validateSync() on only certain fields #3153
 * added; subPopulate #3103 [timbur](https://github.com/timbur)
 * added; $isDefault function on documents #3077
 * added; additional properties for built-in validator messages #3063 [KLicheR](https://github.com/KLicheR)
 * added; getQuery() and getUpdate() functions for Query #3013
 * added; export DocumentProvider #2996
 * added; ability to remove path from schema #2993 [JohnnyEstilles](https://github.com/JohnnyEstilles)
 * added; .explain() helper for aggregate #2714
 * added; ability to specify which ES6-compatible promises library mongoose uses #2688
 * added; export Aggregate #1910

4.0.8 / 2015-07-20
==================
 * fixed; assignment with document arrays #3178 [rosston](https://github.com/rosston)
 * docs; remove duplicate paragraph #3164 [rhmeeuwisse](https://github.com/rhmeeuwisse)
 * docs; improve findOneAndXYZ parameter descriptions #3159 [rhmeeuwisse](https://github.com/rhmeeuwisse)
 * docs; add findOneAndRemove to list of supported middleware #3158
 * docs; clarify ensureIndex #3156
 * fixed; refuse to save/remove document without id #3118
 * fixed; hooks next() no longer accidentally returns promise #3104
 * fixed; strict mode for findOneAndUpdate #2947
 * added; .min.js.gz file for browser component #2806

3.8.34 / 2015-07-20
===================
 * fixed; allow using $rename #3171
 * fixed; no longer modifies update arguments #3008

4.0.7 / 2015-07-11
==================
 * fixed; documentarray id method when using object id #3157 [siboulet](https://github.com/siboulet)
 * docs; improve findById docs #3147
 * fixed; update validators handle null properly #3136 [odeke-em](https://github.com/odeke-em)
 * docs; jsdoc syntax errors #3128 [rhmeeuwisse](https://github.com/rhmeeuwisse)
 * docs; fix typo #3126 [rhmeeuwisse](https://github.com/rhmeeuwisse)
 * docs; proper formatting in queries.jade #3121 [rhmeeuwisse](https://github.com/rhmeeuwisse)
 * docs; correct example for string maxlength validator #3111 [rhmeeuwisse](https://github.com/rhmeeuwisse)
 * fixed; setDefaultsOnInsert with arrays #3107
 * docs; LearnBoost -> Automattic in package.json #3099
 * docs; pre update hook example #3094 [danpe](https://github.com/danpe)
 * docs; clarify query middleware example #3051
 * fixed; ValidationErrors in strict mode #3046
 * fixed; set findOneAndUpdate properties before hooks run #3024

3.8.33 / 2015-07-10
===================
 * upgraded; node driver -> 1.4.38
 * fixed; dont crash when `match` validator undefined

4.0.6 / 2015-06-21
==================
 * upgraded; node driver -> 2.0.34 #3087
 * fixed; apply setters on addToSet, etc #3067 [victorkohl](https://github.com/victorkohl)
 * fixed; missing semicolons #3065 [sokolikp](https://github.com/sokolikp)
 * fixed; proper handling for async doc hooks #3062 [gregthegeek](https://github.com/gregthegeek)
 * fixed; dont set failed populate field to null if other docs are successfully populated #3055 [eloytoro](https://github.com/eloytoro)
 * fixed; setDefaultsOnInsert with document arrays #3034 [taxilian](https://github.com/taxilian)
 * fixed; setters fired on array items #3032
 * fixed; stop validateSync() on first error #3025 [victorkohl](https://github.com/victorkohl)
 * docs; improve query docs #3016
 * fixed; always exclude _id when its deselected #3010
 * fixed; enum validator kind property #3009
 * fixed; mquery collection names #3005
 * docs; clarify mongos option #3000
 * docs; clarify that query builder has a .then() #2995
 * fixed; race condition in dynamic ref #2992

3.8.31 / 2015-06-20
===================
 * fixed; properly handle text search with discriminators and $meta #2166

4.0.5 / 2015-06-05
==================
 * fixed; ObjectIds and buffers when mongodb driver is a sibling dependency #3050 #3048 #3040 #3031 #3020 #2988 #2951
 * fixed; warn user when 'increment' is used in schema #3039
 * fixed; setDefaultsOnInsert with array in schema #3035
 * fixed; dont use default Object toString to cast to string #3030
 * added; npm badge #3020 [odeke-em](https://github.com/odeke-em)
 * fixed; proper handling for calling .set() with a subdoc #2782
 * fixed; dont throw cast error when using $rename on non-string path #1845

3.8.30 / 2015-06-05
===================
 * fixed; enable users to set all options with tailable() #2883

4.0.4 / 2015-05-28
==================
 * docs; findAndModify new parameter correct default value #3012 [JonForest](https://github.com/JonForest)
 * docs; clarify pluralization rules #2999 [anonmily](https://github.com/anonmily)
 * fix; discriminators with schema methods #2978
 * fix; make `isModified` a schema reserved keyword #2975
 * fix; properly fire setters when initializing path with object #2943
 * fix; can use `setDefaultsOnInsert` without specifying `runValidators` #2938
 * fix; always set validation errors `kind` property #2885
 * upgraded; node driver -> 2.0.33 #2865

3.8.29 / 2015-05-27
===================
 * fixed; Handle JSON.stringify properly for nested docs #2990

4.0.3 / 2015-05-13
==================
 * upgraded; mquery -> 1.5.1 #2983
 * docs; clarify context for query middleware #2974
 * docs; fix missing type -> kind rename in History.md #2961
 * fixed; broken ReadPreference include on Heroku #2957
 * docs; correct form for cursor aggregate option #2955
 * fixed; sync post hooks now properly called after function #2949 #2925
 * fixed; fix sub-doc validate() function #2929
 * upgraded; node driver -> 2.0.30 #2926
 * docs; retainKeyOrder for save() #2924
 * docs; fix broken class names #2913
 * fixed; error when using node-clone on a doc #2909
 * fixed; no more hard references to bson #2908 #2906
 * fixed; dont overwrite array values #2907 [naoina](https://github.com/naoina)
 * fixed; use readPreference=primary for findOneAndUpdate #2899 #2823
 * docs; clarify that update validators only run on $set and $unset #2889
 * fixed; set kind consistently for built-in validators #2885
 * docs; single field populated documents #2884
 * fixed; nested objects are now enumerable #2880 [toblerpwn](https://github.com/toblerpwn)
 * fixed; properly populate field when ref, lean, stream used together #2841
 * docs; fixed migration guide jade error #2807

3.8.28 / 2015-05-12
===================
 * fixed; proper handling for toJSON options #2910
 * fixed; dont attach virtuals to embedded docs in update() #2046

4.0.2 / 2015-04-23
==================
 * fixed; error thrown when calling .validate() on subdoc not in an array #2902
 * fixed; rename define() to play nice with webpack #2900 [jspears](https://github.com/jspears)
 * fixed; pre validate called twice with discriminators #2892
 * fixed; .inspect() on mongoose.Types #2875
 * docs; correct callback params for Model.update #2872
 * fixed; setDefaultsOnInsert now works when runValidators not specified #2870
 * fixed; Document now wraps EventEmitter.addListener #2867
 * fixed; call non-hook functions in schema queue #2856
 * fixed; statics can be mocked out for tests #2848 [ninelb](https://github.com/ninelb)
 * upgraded; mquery 1.4.0 for bluebird bug fix #2846
 * fixed; required validators run first #2843
 * docs; improved docs for new option to findAndMody #2838
 * docs; populate example now uses correct field #2837 [swilliams](https://github.com/swilliams)
 * fixed; pre validate changes causing VersionError #2835
 * fixed; get path from correct place when setting CastError #2832
 * docs; improve docs for Model.update() function signature #2827 [irnc](https://github.com/irnc)
 * fixed; populating discriminators #2825 [chetverikov](https://github.com/chetverikov)
 * fixed; discriminators with nested schemas #2821
 * fixed; CastErrors with embedded docs #2819
 * fixed; post save hook context #2816
 * docs; 3.8.x -> 4.x migration guide #2807
 * fixed; proper _distinct copying for query #2765 [cdelauder](https://github.com/cdelauder)

3.8.27 / 2015-04-22
===================
 * fixed; dont duplicate db calls on Q.ninvoke() #2864
 * fixed; Model.find arguments naming in docs #2828
 * fixed; Support ipv6 in connection strings #2298

3.8.26 / 2015-04-07
===================
 * fixed; TypeError when setting date to undefined #2833
 * fixed; handle CastError properly in distinct() with no callback #2786
 * fixed; broken links in queries docs #2779
 * fixed; dont mark buffer as modified when setting type initially #2738
 * fixed; dont crash when using slice with populate #1934

4.0.1 / 2015-03-28
==================
 * fixed; properly handle empty cast doc in update() with promises #2796
 * fixed; unstable warning #2794
 * fixed; findAndModify docs now show new option is false by default #2793

4.0.0 / 2015-03-25
==================
 * fixed; on-the-fly schema docs typo #2783 [artiifix](https://github.com/artiifix)
 * fixed; cast error validation handling #2775 #2766 #2678
 * fixed; discriminators with populate() #2773 #2719 [chetverikov](https://github.com/chetverikov)
 * fixed; increment now a reserved path #2709
 * fixed; avoid sending duplicate object ids in populate() #2683
 * upgraded; mongodb to 2.0.24 to properly emit reconnect event multiple times #2656

4.0.0-rc4 / 2015-03-14
======================
 * fixed; toObject virtuals schema option handled properly #2751
 * fixed; update validators work on document arrays #2733
 * fixed; check for cast errors on $set #2729
 * fixed; instance field set for all schema types #2727 [csdco](https://github.com/csdco)
 * fixed; dont run other validators if required fails #2725
 * fixed; custom getters execute on ref paths #2610
 * fixed; save defaults if they were set when doc was loaded from db #2558
 * fixed; pre validate now runs before pre save #2462
 * fixed; no longer throws errors with --use_strict #2281

3.8.25 / 2015-03-13
===================
 * fixed; debug output reverses order of aggregation keys #2759
 * fixed; $eq is a valid query selector in 3.0 #2752
 * fixed; upgraded node driver to 1.4.32 for handling non-numeric poolSize #2682
 * fixed; update() with overwrite sets _id for nested docs #2658
 * fixed; casting for operators in $elemMatch #2199

4.0.0-rc3 / 2015-02-28
======================
 * fixed; update() pre hooks run before validators #2706
 * fixed; setters not called on arrays of refs #2698 [brandom](https://github.com/brandom)
 * fixed; use node driver 2.0.18 for nodejs 0.12 support #2685
 * fixed; comments reference file that no longer exists #2681
 * fixed; populated() returns _id of manually populated doc #2678
 * added; ability to exclude version key in toObject() #2675
 * fixed; dont allow setting nested path to a string #2592
 * fixed; can cast objects with _id field to ObjectIds #2581
 * fixed; on-the-fly schema getters #2360
 * added; strict option for findOneAndUpdate() #1967

3.8.24 / 2015-02-25
===================
 * fixed; properly apply child schema transforms #2691
 * fixed; make copy of findOneAndUpdate options before modifying #2687
 * fixed; apply defaults when parent path is selected #2670 #2629
 * fixed; properly get ref property for nested paths #2665
 * fixed; node driver makes copy of authenticate options before modifying them #2619
 * fixed; dont block process exit when auth fails #2599
 * fixed; remove redundant clone in update() #2537

4.0.0-rc2 / 2015-02-10
======================
 * added; io.js to travis build
 * removed; browser build dependencies not installed by default
 * added; dynamic refpaths #2640 [chetverikov](https://github.com/chetverikov)
 * fixed; dont call child schema transforms on parent #2639 [chetverikov](https://github.com/chetverikov)
 * fixed; get rid of remove option if new is set in findAndModify #2598
 * fixed; aggregate all document array validation errors #2589
 * fixed; custom setters called when setting value to undefined #1892

3.8.23 / 2015-02-06
===================
 * fixed; unset opts.remove when upsert is true #2519
 * fixed; array saved as object when path is object in array #2442
 * fixed; inline transforms #2440
 * fixed; check for callback in count() #2204
 * fixed; documentation for selecting fields #1534

4.0.0-rc1 / 2015-02-01
======================
 * fixed; use driver 2.0.14
 * changed; use transform: true by default #2245

4.0.0-rc0 / 2015-01-31
===================
 * fixed; wrong order for distinct() params #2628
 * fixed; handling no query argument to remove() #2627
 * fixed; createModel and discriminators #2623 [ashaffer](https://github.com/ashaffer)
 * added; pre('count') middleware #2621
 * fixed; double validation calls on document arrays #2618
 * added; validate() catches cast errors #2611
 * fixed; respect replicaSet parameter in connection string #2609
 * added; can explicitly exclude paths from versioning #2576 [csabapalfi](https://github.com/csabapalfi)
 * upgraded; driver to 2.0.15 #2552
 * fixed; save() handles errors more gracefully in ES6 #2371
 * fixed; undefined is now a valid argument to findOneAndUpdate #2272
 * changed; `new` option to findAndModify ops is false by default #2262

3.8.22 / 2015-01-24
===================
 * upgraded; node-mongodb-native to 1.4.28 #2587 [Climax777](https://github.com/Climax777)
 * added; additional documentation for validators #2449
 * fixed; stack overflow when creating massive arrays #2423
 * fixed; undefined is a valid id for queries #2411
 * fixed; properly create nested schema index when same schema used twice #2322
 * added; link to plugin generator in docs #2085 [huei90](https://github.com/huei90)
 * fixed; optional arguments documentation for findOne() #1971 [nachinius](https://github.com/nachinius)

3.9.7 / 2014-12-19
===================
 * added; proper cursors for aggregate #2539 [changyy](https://github.com/changyy)
 * added; min/max built-in validators for dates #2531 [bshamblen](https://github.com/bshamblen)
 * fixed; save and validate are now reserved keywords #2380
 * added; basic documentation for browser component #2256
 * added; find and findOne hooks (query middleware) #2138
 * fixed; throw a DivergentArrayError when saving positional operator queries #2031
 * added; ability to use options as a document property #1416
 * fixed; document no longer inherits from event emitter and so domain and _events are no longer reserved #1351
 * removed; setProfiling #1349

3.8.21 / 2014-12-18
===================
 * fixed; syntax in index.jade #2517 [elderbas](https://github.com/elderbas)
 * fixed; writable statics #2510 #2528
 * fixed; overwrite and explicit $set casting #2515

3.9.6 / 2014-12-05
===================
 * added; correctly run validators on each element of array when entire array is modified #661 #1227
 * added; castErrors in validation #1013 [jondavidjohn](https://github.com/jondavidjohn)
 * added; specify text indexes in schema fields #1401 [sr527](https://github.com/sr527)
 * added; ability to set field with validators to undefined #1594 [alabid](https://github.com/alabid)
 * added; .create() returns an array when passed an array #1746 [alabid](https://github.com/alabid)
 * added; test suite and docs for use with co and yield #2177 #2474
 * fixed; subdocument toObject() transforms #2447 [chmanie](https://github.com/chmanie)
 * fixed; Model.create() with save errors #2484
 * added; pass options to .save() and .remove() #2494 [jondavidjohn](https://github.com/jondavidjohn)

3.8.20 / 2014-12-01
===================
 * fixed; recursive readPref #2490 [kjvalencik](https://github.com/kjvalencik)
 * fixed; make sure to copy parameters to update() before modifying #2406 [alabid](https://github.com/alabid)
 * fixed; unclear documentation about query callbacks #2319
 * fixed; setting a schema-less field to an empty object #2314 [alabid](https://github.com/alabid)
 * fixed; registering statics and methods for discriminators #2167 [alabid](https://github.com/alabid)

3.9.5 / 2014-11-10
===================
 * added; ability to disable autoIndex on a per-connection basis #1875 [sr527](https://github.com/sr527)
 * fixed; `geoNear()` no longer enforces legacy coordinate pairs - supports GeoJSON #1987 [alabid](https://github.com/alabid)
 * fixed; browser component works when minified with mangled variable names #2302
 * fixed; `doc.errors` now cleared before `validate()` called #2302
 * added; `execPopulate()` function to make `doc.populate()` compatible with promises #2317
 * fixed; `count()` no longer throws an error when used with `sort()` #2374
 * fixed; `save()` no longer recursively calls `save()` on populated fields #2418

3.8.19 / 2014-11-09
===================
 * fixed; make sure to not override subdoc _ids on find #2276 [alabid](https://github.com/alabid)
 * fixed; exception when comparing two documents when one lacks _id #2333 [slawo](https://github.com/slawo)
 * fixed; getters for properties with non-strict schemas #2439 [alabid](https://github.com/alabid)
 * fixed; inconsistent URI format in docs #2414 [sr527](https://github.com/sr527)

3.9.4 / 2014-10-25
==================
 * fixed; statics no longer can be overwritten #2343 [nkcmr](https://github.com/chetverikov)
 * added; ability to set single populated paths to documents #1530
 * added; setDefaultsOnInsert and runValidator options for findOneAndUpdate() #860

3.8.18 / 2014-10-22
==================
 * fixed; Dont use all toObject options in save #2340 [chetverikov](https://github.com/chetverikov)

3.9.3 / 2014-10-01
=================
 * added; support for virtuals that return objects #2294
 * added; ability to manually hydrate POJOs into mongoose objects #2292
 * added; setDefaultsOnInsert and runValidator options for update() #860

3.8.17 / 2014-09-29
==================
 * fixed; use schema options retainKeyOrder in save() #2274
 * fixed; fix skip in populate when limit is set #2252
 * fixed; fix stack overflow when passing MongooseArray to findAndModify #2214
 * fixed; optimize .length usage in populate #2289

3.9.2 / 2014-09-08
==================
 * added; test coverage for browser component #2255
 * added; in-order execution of validators #2243
 * added; custom fields for validators #2132
 * removed; exception thrown when find() used with count() #1950

3.8.16 / 2014-09-08
==================
 * fixed; properly remove modified array paths if array has been overwritten #1638
 * fixed; key check errors #1884
 * fixed; make sure populate on an array always returns a Mongoose array #2214
 * fixed; SSL connections with node 0.11 #2234
 * fixed; return sensible strings for promise errors #2239

3.9.1 / 2014-08-17
==================
 * added; alpha version of browser-side schema validation #2254
 * added; support passing a function to schemas `required` field #2247
 * added; support for setting updatedAt and createdAt timestamps #2227
 * added; document.validate() returns a promise #2131

3.8.15 / 2014-08-17
==================
 * fixed; Replica set connection string example in docs #2246
 * fixed; bubble up parseError event #2229
 * fixed; removed buggy populate cache #2176
 * fixed; dont $inc versionKey if its being $set #1933
 * fixed; cast $or and $and in $pull #1932
 * fixed; properly cast to schema in stream() #1862
 * fixed; memory leak in nested objects #1565 #2211 [devongovett](https://github.com/devongovett)

3.8.14 / 2014-07-26
==================
 * fixed; stringifying MongooseArray shows nested arrays #2002
 * fixed; use populated doc schema in toObject and toJSON by default #2035
 * fixed; dont crash on arrays containing null #2140
 * fixed; model.update w/ upsert has same return values on .exec and promise #2143
 * fixed; better handling for populate limit with multiple documents #2151
 * fixed; dont prevent users from adding weights to text index #2183
 * fixed; helper for aggregation cursor #2187
 * updated; node-mongodb-native to 1.4.7

3.8.13 / 2014-07-15
==================
 * fixed; memory leak with isNew events #2159
 * fixed; docs for overwrite option for update() #2144
 * fixed; storeShard() handles dates properly #2127
 * fixed; sub-doc changes not getting persisted to db after save #2082
 * fixed; populate with _id: 0 actually removes _id instead of setting to undefined #2123
 * fixed; save versionKey on findOneAndUpdate w/ upsert #2122
 * fixed; fix typo in 2.8 docs #2120 [shakirullahi](https://github.com/shakirullahi)
 * fixed; support maxTimeMs #2102 [yuukinajima](https://github.com/yuukinajima)
 * fixed; support $currentDate #2019
 * fixed; $addToSet handles objects without _ids properly #1973
 * fixed; dont crash on invalid nearSphere query #1874

3.8.12 / 2014-05-30
==================
 * fixed; single-server reconnect event fires #1672
 * fixed; sub-docs not saved when pushed into populated array #1794
 * fixed; .set() sometimes converts embedded docs to pojos #1954 [archangel-irk](https://github.com/archangel-irk)
 * fixed; sub-doc changes not getting persisted to db after save #2082
 * fixed; custom getter might cause mongoose to mistakenly think a path is dirty #2100 [pgherveou](https://github.com/pgherveou)
 * fixed; chainable helper for allowDiskUse option in aggregation #2114

3.9.0 (unstable) / 2014-05-22
==================
 * changed; added `domain` to reserved keywords #1338 #2052 [antoinepairet](https://github.com/antoinepairet)
 * added; asynchronous post hooks #1977 #2081 [chopachom](https://github.com/chopachom) [JasonGhent](https://github.com/JasonGhent)
 * added; using model for population, cross-db populate [mihai-chiorean](https://github.com/mihai-chiorean)
 * added; can define a type for schema validators
 * added; `doc.remove()` returns a promise #1619 [refack](https://github.com/refack)
 * added; internal promises for hooks, pre-save hooks run in parallel #1732 [refack](https://github.com/refack)
 * fixed; geoSearch hanging when no results returned #1846 [ghartnett](https://github.com/ghartnett)
 * fixed; do not set .type property on ValidationError, use .kind instead #1323

3.8.11 / 2014-05-22
==================
 * updated; node-mongodb-native to 1.4.5
 * reverted; #2052, fixes #2097

3.8.10 / 2014-05-20
==================

 * updated; node-mongodb-native to 1.4.4
 * fixed; _.isEqual false negatives bug in js-bson #2070
 * fixed; missing check for schema.options #2014
 * fixed; missing support for $position #2024
 * fixed; options object corruption #2049
 * fixed; improvements to virtuals docs #2055
 * fixed; added `domain` to reserved keywords #2052 #1338

3.8.9 / 2014-05-08
==================

 * updated; mquery to 0.7.0
 * updated; node-mongodb-native to 1.4.3
 * fixed; $near failing against MongoDB 2.6
 * fixed; relying on .options() to determine if collection exists
 * fixed; $out aggregate helper
 * fixed; all test failures against MongoDB 2.6.1, with caveat #2065

3.8.8 / 2014-02-22
==================

 * fixed; saving Buffers #1914
 * updated; expose connection states for user-land #1926 [yorkie](https://github.com/yorkie)
 * updated; mquery to 0.5.3
 * updated; added get / set to reserved path list #1903 [tstrimple](https://github.com/tstrimple)
 * docs; README code highlighting, syntax fixes #1930 [IonicaBizau](https://github.com/IonicaBizau)
 * docs; fixes link in the doc at #1925 [kapeels](https://github.com/kapeels)
 * docs; add a missed word 'hook' for the description of the post-hook api #1924 [ipoval](https://github.com/ipoval)

3.8.7 / 2014-02-09
==================

 * fixed; sending safe/read options in Query#exec #1895
 * fixed; findOneAnd..() with sort #1887

3.8.6 / 2014-01-30
==================

 * fixed; setting readPreferences #1895

3.8.5 / 2014-01-23
==================

 * fixed; ssl setting when using URI #1882
 * fixed; findByIdAndUpdate now respects the overwrite option #1809 [owenallenaz](https://github.com/owenallenaz)

3.8.4 / 2014-01-07
==================

 * updated; mongodb driver to 1.3.23
 * updated; mquery to 0.4.1
 * updated; mpromise to 0.4.3
 * fixed; discriminators now work when selecting fields #1820 [daemon1981](https://github.com/daemon1981)
 * fixed; geoSearch with no results timeout #1846 [ghartnett](https://github.com/ghartnett)
 * fixed; infitite recursion in ValidationError #1834 [chetverikov](https://github.com/chetverikov)

3.8.3 / 2013-12-17
==================

 * fixed; setting empty array with model.update #1838
 * docs; fix url

3.8.2 / 2013-12-14
==================

 * fixed; enum validation of multiple values #1778 [heroicyang](https://github.com/heroicyang)
 * fixed; global var leak #1803
 * fixed; post remove now fires on subdocs #1810
 * fixed; no longer set default empty array for geospatial-indexed fields #1668 [shirish87](https://github.com/shirish87)
 * fixed; model.stream() not hydrating discriminators correctly #1792 [j](https://github.com/j)
 * docs: Stablility -> Stability [nikmartin](https://github.com/nikmartin)
 * tests; improve shard error handling

3.8.1 / 2013-11-19
==================

 * fixed; mishandling of Dates with minimize/getters #1764
 * fixed; Normalize bugs.email, so `npm` will shut up #1769 [refack](https://github.com/refack)
 * docs; Improve the grammar where "lets us" was used #1777 [alexyoung](https://github.com/alexyoung)
 * docs; Fix some grammatical issues in the documentation #1777 [alexyoung](https://github.com/alexyoung)
 * docs; fix Query api exposure
 * docs; fix return description
 * docs; Added Notes on findAndUpdate() #1750 [sstadelman](https://github.com/sstadelman)
 * docs; Update version number in README #1762 [Fodi69](https://github.com/Fodi69)

3.8.0 / 2013-10-31
==================

 * updated; warn when using an unstable version
 * updated; error message returned in doc.save() #1595
 * updated; mongodb driver to 1.3.19 (fix error swallowing behavior)
 * updated; mquery to 0.3.2
 * updated; mocha to 1.12.0
 * updated; mpromise 0.3.0
 * updated; sliced 0.0.5
 * removed; mongoose.Error.DocumentError (never used)
 * removed; namedscope (undocumented and broken) #679 #642 #455 #379
 * changed; no longer offically supporting node 0.6.x
 * changed; query.within getter is now a method -> query.within()
 * changed; query.intersects getter is now a method -> query.intersects()
 * added; custom error msgs for built-in validators #747
 * added; discriminator support #1647 #1003 [j](https://github.com/j)
 * added; support disabled collection name pluralization #1350 #1707 [refack](https://github.com/refack)
 * added; support for GeoJSON to Query#near [ebensing](https://github.com/ebensing)
 * added; stand-alone base query support - query.toConstructor() [ebensing](https://github.com/ebensing)
 * added; promise support to geoSearch #1614 [ebensing](https://github.com/ebensing)
 * added; promise support for geoNear #1614 [ebensing](https://github.com/ebensing)
 * added; connection.useDb() #1124 [ebensing](https://github.com/ebensing)
 * added; promise support to model.mapReduce()
 * added; promise support to model.ensureIndexes()
 * added; promise support to model.populate()
 * added; benchmarks [ebensing](https://github.com/ebensing)
 * added; publicly exposed connection states #1585
 * added; $geoWithin support #1529 $1455 [ebensing](https://github.com/ebensing)
 * added; query method chain validation
 * added; model.update `overwrite` option
 * added; model.geoNear() support #1563 [ebensing](https://github.com/ebensing)
 * added; model.geoSearch() support #1560 [ebensing](https://github.com/ebensing)
 * added; MongooseBuffer#subtype()
 * added; model.create() now returns a promise #1340
 * added; support for `awaitdata` query option
 * added; pass the doc to doc.remove() callback #1419 [JoeWagner](https://github.com/JoeWagner)
 * added; aggregation query builder #1404 [njoyard](https://github.com/njoyard)
 * fixed; document.toObject when using `minimize` and `getters` options #1607 [JedWatson](https://github.com/JedWatson)
 * fixed; Mixed types can now be required #1722 [Reggino](https://github.com/Reggino)
 * fixed; do not pluralize model names not ending with letters #1703 [refack](https://github.com/refack)
 * fixed; repopulating modified populated paths #1697
 * fixed; doc.equals() when _id option is set to false #1687
 * fixed; strict mode warnings #1686
 * fixed; $near GeoJSON casting #1683
 * fixed; nearSphere GeoJSON query builder
 * fixed; population field selection w/ strings #1669
 * fixed; setters not firing on null values #1445 [ebensing](https://github.com/ebensing)
 * fixed; handle another versioning edge case #1520
 * fixed; excluding subdocument fields #1280 [ebensing](https://github.com/ebensing)
 * fixed; allow array properties to be set to null with findOneAndUpdate [aheuermann](https://github.com/aheuermann)
 * fixed; subdocuments now use own toJSON opts #1376 [ebensing](https://github.com/ebensing)
 * fixed; model#geoNear fulfills promise when results empty #1658 [ebensing](https://github.com/ebensing)
 * fixed; utils.merge no longer overrides props and methods #1655 [j](https://github.com/j)
 * fixed; subdocuments now use their own transform #1412 [ebensing](https://github.com/ebensing)
 * fixed; model.remove() removes only what is necessary #1649
 * fixed; update() now only runs with cb or explicit true #1644
 * fixed; casting ref docs on creation #1606 [ebensing](https://github.com/ebensing)
 * fixed; model.update "overwrite" option works as documented
 * fixed; query#remove() works as documented
 * fixed; "limit" correctly applies to individual items on population #1490 [ebensing](https://github.com/ebensing)
 * fixed; issue with positional operator on ref docs #1572 [ebensing](https://github.com/ebensing)
 * fixed; benchmarks to actually output valid json
 * deprecated; promise#addBack (use promise#onResolve)
 * deprecated; promise#complete (use promise#fulfill)
 * deprecated; promise#addCallback (use promise#onFulFill)
 * deprecated; promise#addErrback (use promise#onReject)
 * deprecated; query.nearSphere() (use query.near)
 * deprecated; query.center() (use query.circle)
 * deprecated; query.centerSphere() (use query.circle)
 * deprecated; query#slaveOk (use query#read)
 * docs; custom validator messages
 * docs; 10gen -> MongoDB
 * docs; add Date method caveats #1598
 * docs; more validation details
 * docs; state which branch is stable/unstable
 * docs; mention that middleware does not run on Models
 * docs; promise.fulfill()
 * docs; fix readme spelling #1483 [yorchopolis](https://github.com/yorchopolis)
 * docs; fixed up the README and examples [ebensing](https://github.com/ebensing)
 * website; add "show code" for properties
 * website; move "show code" links down
 * website; update guide
 * website; add unstable docs
 * website; many improvements
 * website; fix copyright #1439
 * website; server.js -> static.js #1546 [nikmartin](https://github.com/nikmartin)
 * tests; refactor 1703
 * tests; add test generator
 * tests; validate formatMessage() throws
 * tests; add script for continuously running tests
 * tests; fixed versioning tests
 * tests; race conditions in tests
 * tests; added for nested and/or queries
 * tests; close some test connections
 * tests; validate db contents
 * tests; remove .only
 * tests; close some test connections
 * tests; validate db contents
 * tests; remove .only
 * tests; replace deprecated method names
 * tests; convert id to string
 * tests; fix sharding tests for MongoDB 2.4.5
 * tests; now 4-5 seconds faster
 * tests; fix race condition
 * make; suppress warning msg in test
 * benchmarks; updated for pull requests
 * examples; improved and expanded [ebensing](https://github.com/ebensing)

3.7.4 (unstable) / 2013-10-01
=============================

 * updated; mquery to 0.3.2
 * removed; mongoose.Error.DocumentError (never used)
 * added; custom error msgs for built-in validators #747
 * added; discriminator support #1647 #1003 [j](https://github.com/j)
 * added; support disabled collection name pluralization #1350 #1707 [refack](https://github.com/refack)
 * fixed; do not pluralize model names not ending with letters #1703 [refack](https://github.com/refack)
 * fixed; repopulating modified populated paths #1697
 * fixed; doc.equals() when _id option is set to false #1687
 * fixed; strict mode warnings #1686
 * fixed; $near GeoJSON casting #1683
 * fixed; nearSphere GeoJSON query builder
 * fixed; population field selection w/ strings #1669
 * docs; custom validator messages
 * docs; 10gen -> MongoDB
 * docs; add Date method caveats #1598
 * docs; more validation details
 * website; add "show code" for properties
 * website; move "show code" links down
 * tests; refactor 1703
 * tests; add test generator
 * tests; validate formatMessage() throws

3.7.3 (unstable) / 2013-08-22
=============================

  * updated; warn when using an unstable version
  * updated; mquery to 0.3.1
  * updated; mocha to 1.12.0
  * updated; mongodb driver to 1.3.19 (fix error swallowing behavior)
  * changed; no longer offically supporting node 0.6.x
  * added; support for GeoJSON to Query#near [ebensing](https://github.com/ebensing)
  * added; stand-alone base query support - query.toConstructor() [ebensing](https://github.com/ebensing)
  * added; promise support to geoSearch #1614 [ebensing](https://github.com/ebensing)
  * added; promise support for geoNear #1614 [ebensing](https://github.com/ebensing)
  * fixed; setters not firing on null values #1445 [ebensing](https://github.com/ebensing)
  * fixed; handle another versioning edge case #1520
  * fixed; excluding subdocument fields #1280 [ebensing](https://github.com/ebensing)
  * fixed; allow array properties to be set to null with findOneAndUpdate [aheuermann](https://github.com/aheuermann)
  * fixed; subdocuments now use own toJSON opts #1376 [ebensing](https://github.com/ebensing)
  * fixed; model#geoNear fulfills promise when results empty #1658 [ebensing](https://github.com/ebensing)
  * fixed; utils.merge no longer overrides props and methods #1655 [j](https://github.com/j)
  * fixed; subdocuments now use their own transform #1412 [ebensing](https://github.com/ebensing)
  * make; suppress warning msg in test
  * docs; state which branch is stable/unstable
  * docs; mention that middleware does not run on Models
  * tests; add script for continuously running tests
  * tests; fixed versioning tests
  * benchmarks; updated for pull requests

3.7.2 (unstable) / 2013-08-15
==================

  * fixed; model.remove() removes only what is necessary #1649
  * fixed; update() now only runs with cb or explicit true #1644
  * tests; race conditions in tests
  * website; update guide

3.7.1 (unstable) / 2013-08-13
=============================

  * updated; driver to 1.3.18 (fixes memory leak)
  * added; connection.useDb() #1124 [ebensing](https://github.com/ebensing)
  * added; promise support to model.mapReduce()
  * added; promise support to model.ensureIndexes()
  * added; promise support to model.populate()
  * fixed; casting ref docs on creation #1606 [ebensing](https://github.com/ebensing)
  * fixed; model.update "overwrite" option works as documented
  * fixed; query#remove() works as documented
  * fixed; "limit" correctly applies to individual items on population #1490 [ebensing](https://github.com/ebensing)
  * fixed; issue with positional operator on ref docs #1572 [ebensing](https://github.com/ebensing)
  * fixed; benchmarks to actually output valid json
  * tests; added for nested and/or queries
  * tests; close some test connections
  * tests; validate db contents
  * tests; remove .only
  * tests; close some test connections
  * tests; validate db contents
  * tests; remove .only
  * tests; replace deprecated method names
  * tests; convert id to string
  * docs; promise.fulfill()

3.7.0 (unstable) / 2013-08-05
===================

  * changed; query.within getter is now a method -> query.within()
  * changed; query.intersects getter is now a method -> query.intersects()
  * deprecated; promise#addBack (use promise#onResolve)
  * deprecated; promise#complete (use promise#fulfill)
  * deprecated; promise#addCallback (use promise#onFulFill)
  * deprecated; promise#addErrback (use promise#onReject)
  * deprecated; query.nearSphere() (use query.near)
  * deprecated; query.center() (use query.circle)
  * deprecated; query.centerSphere() (use query.circle)
  * deprecated; query#slaveOk (use query#read)
  * removed; namedscope (undocumented and broken) #679 #642 #455 #379
  * added; benchmarks [ebensing](https://github.com/ebensing)
  * added; publicly exposed connection states #1585
  * added; $geoWithin support #1529 $1455 [ebensing](https://github.com/ebensing)
  * added; query method chain validation
  * added; model.update `overwrite` option
  * added; model.geoNear() support #1563 [ebensing](https://github.com/ebensing)
  * added; model.geoSearch() support #1560 [ebensing](https://github.com/ebensing)
  * added; MongooseBuffer#subtype()
  * added; model.create() now returns a promise #1340
  * added; support for `awaitdata` query option
  * added; pass the doc to doc.remove() callback #1419 [JoeWagner](https://github.com/JoeWagner)
  * added; aggregation query builder #1404 [njoyard](https://github.com/njoyard)
  * updated; integrate mquery #1562 [ebensing](https://github.com/ebensing)
  * updated; error msg in doc.save() #1595
  * updated; bump driver to 1.3.15
  * updated; mpromise 0.3.0
  * updated; sliced 0.0.5
  * tests; fix sharding tests for MongoDB 2.4.5
  * tests; now 4-5 seconds faster
  * tests; fix race condition
  * docs; fix readme spelling #1483 [yorchopolis](https://github.com/yorchopolis)
  * docs; fixed up the README and examples [ebensing](https://github.com/ebensing)
  * website; add unstable docs
  * website; many improvements
  * website; fix copyright #1439
  * website; server.js -> static.js #1546 [nikmartin](https://github.com/nikmartin)
  * examples; improved and expanded [ebensing](https://github.com/ebensing)

3.6.20 (stable) / 2013-09-23
===================

 * fixed; repopulating modified populated paths #1697
 * fixed; doc.equals w/ _id false #1687
 * fixed; strict mode warning #1686
 * docs; near/nearSphere

3.6.19 (stable) / 2013-09-04
==================

  * fixed; population field selection w/ strings #1669
  * docs; Date method caveats #1598

3.6.18 (stable) / 2013-08-22
===================

  * updated; warn when using an unstable version of mongoose
  * updated; mocha to 1.12.0
  * updated; mongodb driver to 1.3.19 (fix error swallowing behavior)
  * fixed; setters not firing on null values #1445 [ebensing](https://github.com/ebensing)
  * fixed; properly exclude subdocument fields #1280 [ebensing](https://github.com/ebensing)
  * fixed; cast error in findAndModify #1643 [aheuermann](https://github.com/aheuermann)
  * website; update guide
  * website; added documentation for safe:false and versioning interaction
  * docs; mention that middleware dont run on Models
  * docs; fix indexes link
  * make; suppress warning msg in test
  * tests; moar

3.6.17 / 2013-08-13
===================

  * updated; driver to 1.3.18 (fixes memory leak)
  * fixed; casting ref docs on creation #1606
  * docs; query options

3.6.16 / 2013-08-08
===================

  * added; publicly expose connection states #1585
  * fixed; limit applies to individual items on population #1490 [ebensing](https://github.com/ebensing)
  * fixed; positional operator casting in updates #1572 [ebensing](https://github.com/ebensing)
  * updated; MongoDB driver to 1.3.17
  * updated; sliced to 0.0.5
  * website; tweak homepage
  * tests; fixed + added
  * docs; fix some examples
  * docs; multi-mongos support details
  * docs; auto open browser after starting static server

3.6.15 / 2013-07-16
==================

  * added; mongos failover support #1037
  * updated; make schematype return vals return self #1580
  * docs; add note to model.update #571
  * docs; document third param to document.save callback #1536
  * tests; tweek mongos test timeout

3.6.14 / 2013-07-05
===================

  * updated; driver to 1.3.11
  * fixed; issue with findOneAndUpdate not returning null on upserts #1533 [ebensing](https://github.com/ebensing)
  * fixed; missing return statement in SchemaArray#$geoIntersects() #1498 [bsrykt](https://github.com/bsrykt)
  * fixed; wrgnç isSelected(( behavior"#1521 kyano](hutps:/+github.com/kycno)
  : dïcq; note about toObjgct behArior during save()
  * docs: add #aLlbacks detail{ #145 Snikmartin](~ttps://githuj.com/nikmartin)

3.7.13 / 2011-06-27
==============-<===

  * fixet; calling model.distinct githout condithons '15$1
  : féxeä; regòession in€Query#count() #1542
  * now working on 3.6.13

s.6.12 / 2013-6-25
===½==<=====9====½
  * ]pdated; äriver to 1.3.10  * updAted; clearer cápped Collection error messáge #15p9 [bitmage](https:+/github.com/biteage)
  : fIxed; MongkosåB5Fger subõype loss durmng casting #1517 [zedgu](https:+/çi|`ub.com/zedgu)
! * fixed; docArray#id when doc.id is$di{abled #!492
  * fixed; docArráy#id now sUppo2ts matches on populated arrays #1492$[pgherveou}httpc://github.com/pgherveou)
  * website; fi< ehAmple
  " website; improvG _id disabling(example
  * wubsite; fix typo #1494 Sdujj](https://githuj.coe/dehj) "* docs; added$a 'Requesting .ew Features' qection #1504 [shovonÝ(https://github.com/shovon)
  * locs; im`rovE subtypes description
  * dî#s; clarify _id disabl)nçˆ  + doc{: display by alphabetical order 4he methods las4 c0500$[|icolasleger](https://github>com/nicmlaslegep)
! * tests; refactïr isSelgcted sheCks
  * tests; reiove tointless"test*  * tests; f)xed timaoqts

3.6.11 / 0013-05-15
===-=====?=========

  * updcted; dréver t/ 1>3.5
  
 fixed; C/mpat w/ Objeat.creaôe(numl) #1484 #1485
  * æixed; cLoning objectc g/ missin' konstructors
  * Fixed; preöend multipm% min number0v!lidator3 #q4810[nrako](https://githwb.com/nrakO)
  * docs; add doc.inczament() Example
  * docs;(add $syze example
  * doc3; add "dhstin£t" example

3.6.0 / r813-05-19
====9=====9-======
N  * upDapg drivur to 1.3.3  * fiXed incremgnt() workc Witho5t other"change3 #1475
  * wõbsite; fix lincs tn postebous
  * docs; fix dijk"#1472

3.6.9 / 201m05-02
========<=========

  * fixed; depopulation of mixed dobement3 #1471
  "$fixed; use of optionr if !rray #1462
  * tests; fix race condition
  * docs; fix default examPle

3.6.</ 2013-04,25
================}

$ * updated; driver to 1.3.0
  .$fiyed; con~eStiïn.model shguld"retAin opti/ns +1458 [vedmalex](jttps:gathuf.com/6edmalex)
  
 tasts;$4-1 qeConds fqsveR

3.6>7 / 2013-04-19
============½=9===

  * fixed;(ðopõlatéon refr%{sion In 3.66`#1444

3.6.6 / 2413m04-10
=======5==========

 $* fixed; saving popwlated new DocUmejts c1442
  + fixed; populat(on(recesqion il 3.6.5¤#1t41
  * websyte; fiø cmpiright #1439

3.6.5 / 2013-0-15
====9=============

  * fhyed; spRicu8uhrow edge ca{e$using .set(path$ Val)
  * fixed;!schem!.pathType()0on some oumbericAìpha paths
  ª fkxed; numberIcAlpla path versIoning
  j fixed; setting nested mixed paths #1418
  « fixed; 3etting nested objects wit` null psop #1326Š  * fixed; reçression in(v3.6 populadion perforíance #1426 [vedmalex](httpq:¯/github.com/vedoahex)
  * fih%d;(read prgf typoó #1432 [kya,o](httpw://github.ckm/kyano)
  * docs; fih method e¸ámple
  * webrite; update naq
  * website; add more deep links
  * website; update PoolSize docs
  ( wabSipe; adt$3.6 relea³e notes
$!* webóite; ~gde `bout keepAlive

3.6.t / 201s-04-03
====9=============

  *$fixed3 +field confìict with $slice #1370
  * fiXed» neóted deselection conflict #1333
  *àfiped; RangeError in ValiäatiojEzror.tostring() #1296
  * fixed;`do noô save user defined Tvanóforms #!415K  * tests; fix race condition3.6.3 / 2013-84-0"
=================

( * fixed; settyng subdocumentq deerly nesteD fields #9394
  ª fixed; rdgressimn: populated cvreams #1411
  * docs; mentimn hooks/validation with gmndANdModifY
  * dmss; mention auth
  ª docs;0aDd more lhnks
  *!uxamples; a`d docu\ent methods0mxample
  :`website; displqy "see" links for propertieó
  * g%bsite; clean up hoeepáge
3.6.2 / 2013-03-29
=9============?}=
  * gixed; corrupted sub-doc array #1408
  * fixed; document#update retuRns a Quåri '139
  * dkcs; readxref stRategy
3.6.9  2013­0327
==½===========5===

  * ad`ed; populate suppoRt to findCndModify vàrieo4s #1295
  * addEd; text!indeø 4yqE to schematyres
  * exðOsE allowed inDex!types ac Schema.indexTYpes
  * fixed; use of `setMaxListenevsà as path  *!fixed; regressIon in note 0.6 oî$dkcs with"> 10 arrayS  * fixed; do not alter`sbhEma aSgueents #134  j nixed; subdoc#ownerDocume>t(% #1385
  *¡wlbsite; change reirch yd
 "* webséte; add secrch frOm google Ûjackdbernier](httpw://github&com/ja`kdbesnimr9
  * website; fix ìink
  * webSite;"ad` 3.5nx dncw velease
  * website3 fix link  * docs; Fix geometry
  * $ocs; hIde interoál conótructor  * äocs; aggrEgation does not cast arguments c1399
2 * docs; querystream option{
  * examples; added for population
*3,6.p / 2013-03-18Š=============<====

  * chaNged; cawt 'trueg/'falsí' To boolean '1282 [mgrach](https://géthub.com/mgrach)
  * #hcnged; Buffmr arrays(aan now contain nulls
  * adde`; YueryÓtream`4ransfïrm option
 !* addeä; supprt for autlSouöce driver opt)on$0* added; {mOngose,tb}.mndelNames()
  
 added; $`ush u/ $slécm$sort4support (MongoDB2.4)
  
 a`deD; has(ed(kndez type`(MngoDB 2.´)
  * added; support for oongodb`2.4 geojson (MongoDB 2.4)
 "* added; value at time of 6aìidation urror
  ª adDed; support for objeat liueral schemas
  ( added+ buvferCommands@schema opvion
  * added; allow aqtj option in connections #0360 [geoah]*https://github.ckm/Geïah  * added; performance$amprovements to populate,) [273ece9](https://çithub.bom/LgerNBoo{t/mkngoose/commit/263mce9)
  * addeä; aìlou adding uncasted docs to po0Ul!t%d qrrays an$ p2opeòthes #570
  * added; doc#populated(path) stores orhghnAl populated _ids
  * adfed? lean p_pulation #126 
  * added; queri.qopula|e() fow$aCcepts#an mptiïns obje#t
  * ad`ed; document#populate(opts, callback)
  * `dDed; Model.populate(docs, opts, ca,lback)
  *`added; support f/r rich0neSded tath populátion 0* added; doc.ar2ay*remove(value) swbdoc wiph`_i$ valu% suxPort 31278
  * addad? optaonally allow joj-strict sets and updates
  * addmd; promises/E* ãomformancy with [mxromise](https://github.com/ahEckmann/mpromisa)*  * Added; tRomise#txen
  * added; p2olase#End
  * fixed{ use gf `model` as doc propebty
  j fIxed; lean popqdation #1382
  . fized; empty objac| mixed defaults #1380
  Š fixed; populate w/ de{elected _id uóilg strijg syntax
 "( fixef; aptemPted`save of divergelt populited árrays #1334 relatedŠ "( fixed; better errmr msg when attempting toObject as property name
  * fixed; nmn populátion buffer cAsting(from Doc
  * &axed; setvhng populated paths #570
  * béxed; casting when added docs to popudated arrays #570
  * fixed; pr/hibit updating arrayc selectal with $elemMctch #1334
  ( fixed; pull / sev subdoc combi.ation #130s
  * fixed; multiple bg i~dex còeavion #13>5
  * fixed; eanual recOnnestioN to single mongod
 `j fixed; Constructor / version exposure #1124
  " fixed: CastGrror race koîdition
  * fixed; no longer swallowifg misuse o& su`doc#invalidate()
  * fIxed; utils.clgne retains RegExp opt{
  * fixed» popula4)on of non-schema property
  * fixåd; Qlmow updating versionKey # 265
  * fixed+ ádd!EvenvEmitTer prmps to òeserved paths"#1³78
  * fixed; can nOw deselect pop}|ated doc _idó '1331
0 * fmxed; propErly p`ss subtype to Binary in MkngoosaBuffer
$ * fixEd; #awting _id from eocument with n/n-OfbeCôId$_id
  *1fixed; specif9ing schemA type edgd`cse { path: [ytype: "String" }U }  * fixed; typo in schemdate #129 [bplock](httPs://oitèub.coï/*plnck)
  * uplated; driver to q.2.14
  * eðdated; muri to 0.3/1
  * uxeqted; mpromise tO 0.0.1  * updated mocha 1.8.1
  * update${ mpath tO 0.1.5
`0* deprecated;"p,uralization will die ho 4.x
  * refactor; rename Privave methods to(something unusa`le a3 Eoc trord"ties
  *(refactoò MïnçoosaArray#pemnve
  * refactor; move uxpires index to ScheeaEate #1329* 0* redactor; intevj!l dncqment pro`dbtée3 #1171 #1184
  . tests; adäed
  * docs; indexew
  * docs; validatkon
  * docs;$populate
  + docs; popwlite
  * docs; add"note cboup wtream computibhdity with node p.8
  * docs; fix gOr xrivate names
  : docs; Buffer -> mongodb.Bin`ry #1363
  * d/cs; a5ti optmons
 `* docs; i-proved
  * websi4e; update FAQ
  * 7ebsite; add more api links
  * webs)te:$ad` 3.5.x docs to prkor release{
  * websita; Change&mongoOre-types to an aa4ive repo [zackdbernIer](https://githtb.coí/jackfbernier)
b * website; compat(with node 0.10
  * websitU; add newq!section
  * website; Use D!for geluric"typeJ  * benchmark; make adjustable

3.6.rc1 / 2013-03-12
==================½=
  * refac|or; Rename ppivate methods to something unusable as doa propeties
  * added;${mongooSe,db}.m$elName{().  * added; 4tush w/ $slice,$sort support (OongODB .4)
  * addeD; hashed izdex $qpe (MongoDB 2.4)  " edded; suPport for mongodb 2.4 geoêsmo (MongoDB 2.4)
  * adted; value aT time of vali`ation erRov
  * a`d%d; sup0ort fov object`literad scèemas
  * added; "ufferCommands scluma opqionŠ  * adled; allow awth option in cojnections #1360 [geoah](https:-®github.comgegah)
  * fi|ed; lean po0udqtioj #1382
  * fixed; empty obkect íixed$defáults #138p
  * fixed; popuhite w/ desemected`_hd using string syntax
   fixed; attemptef savm of divergent!povulqted arra9s #1334 rwleted
 `* fixed+ better error msg when attgmpting toObject0as tropesty name
 !( fixed; nondpoxulation&buffer casting froo doc
  * fixed; setting 0opulated paths #570  + nixg`; cqspiNg when aäded dogs to populateå arrays c570
  * fixed; prohibit updáting arrays selected wit( $eleeMatch #1334
  * fi|ed; puLl / s%t sõbdoc coM"ination #13 3
  * fixef; mult}ple fg indeø creation #3365+ (* fixed;"mánual recgnnec4ion to 3inmlå mongod
  * fired; Con{truktor / ver{io~ exposupe #1124
  * fùxed; Casterror r!ce coldition
  * fixed; no longer swallowing misuse of subdoc#invAlidatu()
  * fixet; utylq.alolu@redáync RegEx` opts
  * fixdd; ropulation f nln-schema 0roperTy
  * fixed; allow utdavinw veróio.Key #1265  *`fiXgd; add EventEmittEr proqs to reserved Peths #1338
  * fixed; can .ow de{Elect populated doc Oids #133q
! * updaved; muri uo 0.7.1
  * u`dated; driver to`1.2.12
  * uxdqted; mpromise to 0.2.1
  *`deprecated; plupalization 7ill die iî 4.x
  * docs; Buffer ->`mongodb.Binary #1363  * docs; Auth nttions
  *`docs; )iprveD*` * ebsitg: add news sectionŠ  * belchmIbk;(meke afjustable

3.6.0rc0 / 2013-02-03
=========5=========}==
  . changdd; cast 'true'/filse' to boolman 1282 [mgraah](https:/github.com/mgrach)
  * cèanged; Buffar aRvays can now contahn nulls
  * fixed; properly pass subtype to Binary in MongoosmBuffer
  * fkxed; casving _id grOm docement whth non-ObjectÉd _id
  * fixed; specifying schema type edge case { path: {type: "String" }]0}
  * fixdd; typo in ûchemfate #1309 [jplmck](jttps://github.com/jplock)
  * refactor; move expirEs indeh to SghemaDate0#1328
  * refactor; internAn doculent properdmes(#171 !1104
  * afded; perfïroangE improvEments to populate() [063ece9](https:./github.com/LeqrjBoost/monGoose/comeit263ece9)
  * added;$all{w`adding uncasued dcs0to 0otulated arrays aod propertios$#570
  * added; doc#populated(pat`i!stores /rigina| poðulate4(_ids
  * added; lõan population "260
  j a$ded;°qtery.0opulate() now accdpts cn optionw /bêecp
  * !dded; docume^t#populate(oPts, ca,|"ack)
  * ad$ed; Model.popwlate(docs,(opvs, cállbAco)
  *"edded; suppozt for rich nested path population  + added; dnc.array.remoöe(va,ue) subdoc uiuh _iä alwe support #1278
¡ * `dded; oxti'nally ñllow`.kn-striat Sets and upda4es
  * added; promices/A+ comformancy with [mxromise](https://gi|hub.com/ahe#kMaj./mpromise)
( * addgd; promise#then
  * aäded; promisQ#end
  * updated; mocha`1.8.1
$ *0}pdated; muri ôo 2.3.0 @" updated? mpáth to 0.1.!
  
 updated; dïcs

3.5.16 / 2013-08-13
=-========?½======

  , utdated drkver to$1.3.18

3.5.55 o 2013-07-26
==================

  * }pdated; sliãed to 0.0.5  * updated; driver to a.3.12
  * fixed; regression in`Query#coent() due to driver(change
  * tests; fixed uimeouts
  * tasts; handle differilg test uris

3.5.14  201-05-15
==}====9==5=======

  + updated; driver tn 1.3.5
  * fi8ed9 coipat w/ Objegt.cREate(null) #9484 #3485  *!fixef; cloning"obj%ctq mi3Shno(constructors
  * fixed; pr%vmnt m5ltiple min$number validators #1401 [nrakoÝ(itôps://gmthuâ.ã?m/nrako)
J3>5.1³ /¡22!3-05-09
========<===?-====

  * updáte drivdb#to 1.3.7
  * fixed; urd kf $options in0arriy #1462*
3.5.12 / 2413-04-25
======?====}=======

  *$uxdated; driver to 9.2.0
$ * fhxed; connection.mgdel sHkund re|ain options #1458`[vedmalex](httðs://github.coM/ved}alex)
  * fixed;!reAl pref t}pos '1420 [kyano](hvtps://github.co}/kyano)

3.5.11 / 2013-05-#9================
  * dyxed; +field conflict wyt( $slice #1370
("* fixed; RingeEsrr in ValidationError.tmStrijg() +1296
  * fixed; .e3tel de{election conflicp #1333  * remofe"dime frgm Makafile
3.5.1° / 2013-24-22
=-=====9==========

" * fixed? setping subdaumdnts deeplq nested fiulds #1394
  * fmxed+`do ~ot alt%r sChaMa argumefts !3764
3.5.9 / 2013-03-15
=========-========

  * updated; driver to 1..14
  * added; support for atthSnupce $raver option (mïngodb 2.0)
  * added; Puery[upeam tra.sfgrm option (node 0&10 helper)
p`*$fixed; bAckport fo2 sqving requiref populated buffers
  * fixeä; pUll / set qubdoc comâkîatin #1303
  * fixed; m}ltiple bg index creation #1765
  * test; addwd fov saveable reuuired ropulated beffers
  * test; added vor #1365
  j tast9 aed aut`Qour#e test

3.5.8 / 2013-0s-12
==================*
  * added; auth option in connectioN [geoeh](êttts://github.com/geoah)
 %* fixe$; SastError rAce cofdition
  * tocs; add note about stream(compcpi`iliti with no$e 0.8
*3.5.·`/ 2p13-02-2
===½===========9=

  * uxdated; drIver to 1.2.13
  * upda4ed: muri to 0.3.1 #1347
  : fixed;`utils.clone retainS RegExp oxts #175
 $* fixed; deåpEquals PegExp support
  h"Pesvs; fix a"connection!test
  * webqiTe;"clean up docs [afshinm](https://oithub.com/`fshinm)H  * w%bsite; updaôe homepage
` * webrite; migpaetiOn:$emphasize impact oæ stribt docs #126´

3.5.6 / 2013-02-34
=======}========

  * updated{ driver to 1.2.12
( * fiped; properly tess BinAry subtype
  * fixed;"add EventEmit4er props to rd3e2ved path3 #1338
  * fixed; use correcT node engiæe version
  *(fixef;!fisplay empty docs as {} in log output #953 follnw ut
  * improved; "baä $within $boØ argument"!erpor message
  * populate; `dd unscientific benchmarkJ !* wEbsite; a$d stack overflow to help weatioN
  * websmtE; usg better code font #1³36 [risóeráka](https://github.col/rissdraka)
"$* website; clarkfy`whera (elt is availab)e
" * website; bix sourCe code!links #12720[fhoa`ingLomas](https://givhub.com-floatiNgLomAc)
  * doos; be cpecific aBoUt _id schema option £1102
  * docs;!add ens}reIîdex erRor handlinG åxamTde
  * docs; README
 (* docs; CMNTrKBUTIJG.md
3.5®5 / 2013-01-29
=======½==}======
 $* update`; driver to 1.2.11
  * pe=oved;$o,d node < 0.7x shies
  *!fixed; documints(witj Buffer _ils equqlkty
  *(fixed; MongooseBuffer pskperly casd# numbers
  * fixud; reopeninghclosed conne#tiof on alt host/prt #1287
 $* äoms; bixed typo io Reatíe #1298 reled])https://github.aom/reled©
  * docs; fixed typo mn migratiOn docs [Prilzhorn](https://github.com/Prinzhorn)
  * docs; fixdd incnrrect annotátion in SchemaNumber#min [bilal1Y8hutps:/giphub.com/bilala)  * docs; updated
3.5.4 / r1'-°1-07======-===========

  * changed; "_pres""& "_posts" are now òeserved pathîames #1261
  * updatef; driver to !.2.8
  * fixed; exception when reopening a qepliãa set. #123 [etx`nkan](https://github.cm/ethankan!J  * webSitm; updated

3.5.3 + 2012-92-26
=====?===========9

  * added; swpport fos geo object notation #1277
  * fixåd; $wiôhin qqeby castyng 7htè arrays
  * fixed; unix domain sogket su0port £3254
  * up`ated; d2iveràto`1n2.7
  * updatgd; muri to 0.0&5

3.5.2 / 2012-12-17
==}==}========-===

  ª fixed; using auth with rEplica sets #1253J
3.5.1 / 202-12-!:
=======9==========
Š 0* fixed{ segreósimN when usinG subdoc witl `pAth` as pat(name #2$5([dAeq](h4tps:'/gitjub.com/daeq)
  * æixed; safer db mptaon cheaks
 `* }pdated; drivår`to 1.2.1
  * websIte; add more$exalplds  " websit%+ glean up ol` docs
  * we"site; fix prev rulease0urls
  * eocs; claRify ctreAming with(HTP sesponses

3/5.0 /$2012-12-10
================

  * Added; paths to CastErrors #1239
 0* added; su0pord for mongodb connectioN string spec #118w
  * addee; powt validate%event
( *(addet: Schema!get (to(retòieve sc`ema options)  * added; VersionError #1471Š  * added; jpmifnore [hidek{{](https://git`ub.com/hi$ekiy)
  * update; driver to 1.2.3
  * fixed; stackoverflow mn setter`#1234
  * fiXåd; utils.isObjeat()
 0* fIxed; do not klob`er usuv spmcified driver writeBoncern 227
  * fh8et; always pass current document po$post hooks
  * fixed; throw"error wjgn user attempts to oweswrite a mdel
  * fi|ed; connection.moden only caahes on co~necTion #1r09
" *`fi8ed; reSpect conn.model() #2uation when matching global model exists #1209
  j fmxed; passing moDel nam% + collectinn n!me nOw)alays honors`ckllection name
  *$dixed;"setting virtual field"to an empvy object #1154
  * fixed; subãlassed MongooseErrors(exp/sure, now cvailable in mkngoose.Error.yxxx
  * fixet; model.remnve() ignn2ing callback wlen exec}t%d twice [daeq](https://giuhuB.com/daeq) #1210
  * docs; add cgllectmon option to scheoa api docó #122:
  * docs; NOTE ábg5t db cafe optiOns*  * docs» add post hooks `ocs
  + docs; k/Nnection strinç options
0 * dkks; middleware iw not executed with M/Del.remove #1241
  * docs; {g,s}ettev inôrospectaon #777
  * docS; update validation docs
  * docs; add link t¯ plugans page
  * Docs; clarify arrgr òeturneD by(unique`indexes "1225$ * docs9 more detail about dHsabling qutoÉndex behaviOr  * docs;0add0homepage section to pack!ge (npm dobs mongoos%)
  * Docs; mord detayì around`bollection nam% plur%lizatio~ #1193
  ( website; a$f .important css
  * wefsite; update molels page
  * website; tpdate gettmng 3tar4ed
  * wmbsitå» updat% quick start

3.4.0 / r012-q1-10
===============-9

  * added» support for generic$toJSON/toObject transforms #1160 #10²0 #5197
  * added; doc.set() merge suppo2t #5148 [NuOrDER](httts:/-gidhub.com/NuORDERi
  * added; query3add sutport #1188 [aleclofabbro](httpsz//github.cmm/alealofabbrg)
  * changed; d$ing i.talif nested paths`to lon-objec4S throws 4216f04
  * changed; fi8ed; stop invalid function cloning (knternál ni|)
  * nixmd; a`l query $and casting suppobt +1180 [anotheri](https://'ithub*coí/anotheri)
  * fi8ed; overwriting od pery argumen4s #1176
  * docs; fix0exp)res examples
  * docs; transforms
  * dgcs: schema acollection` option docs [hermanbenge](http3://github.ckm/hermanjujge)
  * websiôe; updated
  * tests;`added

3.3.1 / 2012-1 -11
=======}<=========

  * fixed; allow`goose.coNnect(uris, dbname, opp{) «1144
` * dkcó; parsist`API privatg checkeä st`te acroqs0page lkadS

#.3.0 / 3002-10-1(
==}==========y=}==

  * bIxed; pássifg optionq0as 6nd arg to cgnnuct*) #1164
  (`fkxed; race aonäition After no-op`save #1139
  * faxed; schema(field sulectioî application In finlAndModify #1!50
  *$fi|ed; directly s%tting arraùs #1126
  " uptated; driver to 5.1.1!
( * urdated; collection pluralization ruLes [mrickard](https://github.com¯mbickard)
 !* tasts; added  *$docs; upl`tee

3.2.2(/ 2012-1-08
m=============?===

  * upd`ted; driver(to 1.1.10 #1143
   updated; use sliceb 0.0.3
  * fixed; do not recast embefded locs unnecmssaril}
  * fixed+ expires schuma option helpev #1132
  * faxad; bõi|t in strinw setturs +31;1
  * fIxed; debug ottput(vop dates+ObjectId properties #1129*  * doCs; dixe` Jevascript`synõax error in example [olalonde](httds://gmthub.com/olalonle)
  * locs; fix toJSON`example #1137
  * docs; adD ensureIndex production notes
  * docs+ fkx wpdlling
  * docs; add$clogposts aboõt v3
  * website; updated
  *0removed; undoCument%d inGrepsf util
  * tests; added

3.2.1 / 0012-09-28
9======½==========
  * fixed; remove qqer} batclSize n0tion default of 1200 https://githtb.com/ldarnboost/lkngoose/kommit/3edaa851
  * dmc3; upd!t%d
  * websita; updatef
J7.2.0 / 2012-09-27
=========}======9=
( * added; direct array index assignment with castiNg supporT ``oc.arrey.set(index, value)`
  * fixmd; QwerYRtraam'res5me withij same tick as pAtse() #1116
  * fixed; dEfault va|uå validatation #110)
  * nixe@; arRay splice(i not #astin' #1123
  *(fixed; lefault array construction e$ge ca÷e #1108
  *`fixed; qqery ccsting for ýjequalities in arrays #1103 [dpatti](https://githubcom/dpatti)
  * tests; ád$ed
  * website; =Ore documentatioN
  * website: æixed layout issue #1111 [SèashíanZ](https://github.com/SlashmaNX)
  * website; refactored [guille\(https://gíthub.cmm/guillu)

3..2 / 2012-09-10
===½==============

  * aeded; ReadPreferrence schema"optiïn #1097
  j updated+ drhver0to 1&9.7
  * updated; def!ult query batchSize to !00 
  * fixed; we now cast the€mapReDuce query option #1095
  . fiped; $elumMavch/$in with field selection$#1091
  * fixed; properdy cast $elemMaTch+$in conditions #1100
  * fixed; default field application f su`docs #1027
 "* fixed; querùs|rea- premat}rely dying #1092
  * fixed; qõmrystråam jever resumes when paused aô getMore boundries0#1092
$ * fixed; qudryq4ream occasiofally emits data events afTgR destroy!+193  * f)8ed; remove unnAcesscry ObjmctId crdatéon in querystòeam
`!
 fiHed;0allow ne(bgolean)`again #1093
  * docs; add populAte/field!selection syntax notes
  * dmcs: add toObj%gt-toJSON options0devain
  * do#s; `read` schema /`ôion

3.1,1 '(2112-08-#1
===<9=============

  * updated; driver to .1.¶

3.1.0 . 2012-0x-29
==½}=======?<===
  * canged; fixed; directly setting nested objects nnw nverwrites entire object`(previously incorrectly merged tlem)
  * adled; read Pref suppOrt (mongodb`2.2) 205a709c
  * added; aggpegate support`(mkîgodê 2.2) f3!5bd3d
  * added? virtual {g,s}åtter yntrosp%côioï (#1030)
  * upäited; docs [crettz9](https://github.co}-bRuttz9)
  * mräatel; frivep to 1.1.5  : nixed; retain wirtual sett%r beturn values (#1069)
*s>0.3 o 2012-08-23====½============

  * fixed; õ3e ov fested paôhs beginnyng w/ numbErs #106²
  * tixed;"qu%ry popõlation edge case #1053 '1055 [jfremy]*htvps://githvb.com/jfreey)
  * ~ixee; skmultanegus ô/p and sub"lavel array modifications "10'3
  " added; id and _id schema option aliawes + rests
  * improve debug foreatthng ôo`allow copy/paste logggd queries int mongo shell"[uknkcM(htpps://github.com/eknkc)
  * eocs
3.0.2 / 2012-08-17
=9=====<==========

  ( edded; missing`su`port for!v3!sorô/select syntax"to findAndModify!helpmrs (#1058)
 `* fixed; rE0lset fullsetup`evE~t emisSion
 `j fhxef; reconnected eveot fov replseps
  *"fixed; Server reconnection smttino discovery
` * f)xed; compat with non-schema path props ucing qositional notation (#1048)
  *!fixed; setter/casting orler (#v65	
  *(dogs; updated

3.0.1 / 2012%08-91
========½===u====

( ( f)xed; throw Ervor m. bad vanidators (1044)  *$fixed; |ypm in DmbeddedDocuienô#ParentArray [îcckacM
  * fixed; reraiz mo.coose.SchemaTypes alIas
  h!updated;`docs

3/0.0 / 2012-08-07
====?=======9====

  * removed; old qubdocument#co-mht method
  * fixed; setuing arrais oæ }atching docs [6924cbc6]
  * fixed; Toc!re}ove ewant now emits in sava îrder as"save for consistency
  * fiXed; premsave lïoks ~o longer fire on sUbdocuments gèen validatinn"fails
  * added; sõbEoc#paz%.t() aîd Subdoc#xArentApray() to access subdocument$0arent objects
 0* adled; quar8#lean() helper

³.0.0vc0 / 2012-08-01
==)================?

  * fixed;"allow subdoc literal dealabations containIng "tipE" pathname (#993)
  * fixed; unsepting a dåfau,t avray (#758)
  * fixed; boolean $in0uueries (#998)
! * fixed; allow use of `options@ as a!pathname (#529)
  * fixed; `m/dalp is again a permitte` schema path name
` * `hxed; field`sulecvikn optio. on subdo#s #1022)
  * æixed; handle another edwe case with subdoc saving (#975)
  * addgä; emit save err on model if listening
  * addgd; MolgoDB TT\ collection support (#1006)
  * added; $center ptions suqport
" * added; $nearSphere and $polygon support
  * updated; driver fersion 4o 1.±.r

3.0.0alpha2 / 2012-07-18
=======}=====}==========<

  * changed; index errors are now emitted on their model `nd p)ssed to an opTional callback (#984)
  * fixed; srecifying(ind%x aloîg with sparse/u.ique optÉnn no lon'er overwbites (#1004)
  : fixed; fever swalnow connectiof mzrors (#618)
 #*$æixed;(creatang objgct frkm mOdel witj emdmd object nm longer overwrites defaults [achurkyf] (#859)  * fixed; stop needdess validat)on nf õnchanged/unsElected &ields!(#891)
  * gixed+ documeNtgqõals bela~ior of bjectids (#970!
  * gixe$; honor the minimize qchema option  #978)
  * Fixed; provide hel4nul %rzor msos when reseRved schema pati is u3ed (#920)
  * fixed; call`ack to cofn#dis#onnect hs opvionAl *#875)
  * &ixed;(he.d|e miqsin' proTocols yn cnnectIon urls (#907!
  * fixed validate args to query#where (£969)
  * fixed; saving -odified/removeä subdocs (#975)Š  * fixed; upta4e with $puln from Mhxed erray (#735)
  * fizeD;heòror witi ~ull shard0key Value  * fixdd; aldow uîsetting enums (#967)Š  * added; suppoRt for manual index creation (#984)
  * addee{ support for disabled aeto-indexing ("984)
` * added? óupport for presebving EongooseArray#sozt changes (#752)
  * added; emit state khange$events on connEction$"* added; suppmrt"for specifying BSON subtype in MongooseBufber#toObject [jcrugzz]
 !* add%d; support for,disabled Versionin' (#977)
  * added; implicit "new" support for models and Schfmas

3*0.0alpèa1 / 2012-06m15
=========================

  * remo6ed;`doc#a/mmit (esa doc"maroModified)
  * removed; doc.-Odifmed gettep (#950)
  * removed; mongoose{confectSgt,createSetConnection}. use aonnectlcreaveconnectio. ins4ead
  " removEd; quury alias methods 11<9804c
  * removet; MongooseLwmber
  * changed;"now cråatijg infexes in backgòound bù denaelT
  * changed3 strict0mode now unab,ed by default!(#952)
! * changed; foc#mOdiviedPaths )s now a methoä h#94 )
  * c`anfed; get4ers no loNoer cqst (#8"p); cawtin' hcppEns durilg setJ  * &ixed9 no neeä to pass qpdateArg To findOneAndUpdate (#91)
  j"fIxed: }t)ls.me2ge beg 7hen merging nested!non-o"jects. [|reygrigfiuh]  . fyxed; strict:throw sHoumd p2oduce erRors iN fyndAndModify (#963)
  
 fixed; vindAndUpdave no longer mverwrite{!docum¥~t (#962)
  * fixdd; settine defaulv Foc}ien4Arrays (#953)
  * fixed; selegtion of _iä(with scjema desedection (#954)
  * fixed; enwure promisa#error emits inst`.ceof!Er2or
  * fixed; CursorStream: o stabk overflow on any size resu,t (#929)
  * fixed; doc#remove low qasseS safe Options
  * fixed; invalad use of $set during $p+p  * fixed; a2r!y#{$pop,$shift} mirror MongoDJ bghavioò
  + fi|ed; no lofgez test îon/require$ vans if string match (#924!
  * fixed; edge casm wIth doc#ifspect
  * fix%d; setter ordur (#6>5)J  * fixed» sEtting invqmid paths in strict(mode (#916)
  * fixåd; Handle docs withut id`in Locu,en|ArrA{#id method (#<97)  * fixed; do not save virtuals dusing modeì,update (#894)
  * fixed» sõb doc tObject virtuals applicatiol (#88;)
  * f)xed; MongooseArraypull of bjeat	d(('881)
  *`fixed; handle passmng db0name with any repl {et suring
0 * faxed9 teFault appdication of selected fiulds (#870)
  *(fi8ed; subdoc paths repOrted in vilid`tion errors (#705)
  * fixed; incorrect reported num of affectud docs an!update ops (#8v2)
  * fixef; connaction assignmenu in$Moeel#mkdel (#83)
  ª fixed{ strin'ifying arrays of eïcs (#8u2)
  * fixef; modifying subdoc"anf `ar%nt array workc (#842)
  * fixdd; passing uneefined uo next hook (#785)
  *(fixed; Qeery#{uðdcte,remove}() works without callbacks (#788+
  * fihet; set/u`datinç nested bjeCts by pArent padhnama`(#843)
  * fixed; almow null in numbår(array3 (#840)*  j fixed; isNew on sõr doc after insertiof erpor (#037)
  * fIx%d;aif(an insezt dailq, set isJeW back to false [boutell]
 "* fixeä;(isSeheated when only _i$ ys selected (#730)
  * fIxed; setting an õfset def!ult value (#742)
  : fiped: query#qort error"messagilg (!671-
  * fixed; support for passiNg $options wi|h $rmgex
  * added;0!rray of object lit%ral notation én schema creates Doc5mentArrayq
! * addee; gt,gte,lt,lte query"support for arrays (#902)
  . added; cápped collection Support (#938)
  * added; document versioning su0popt
  * adde$;`inclusion of!ddseldcted sChema path (#786)
  * added; non-atommc array#pop
  * added; EmâeddmdEocument construcTor Is nnw exposed iN DocArray#create 7cf<beec
  * added; mapReduce pupport (#678)
  * added; support for a bonfigurablg minimize option"#tn{ObjecT,JSOL}(op4ion) ('868)Š  * added; support for stpict: `throws` [re'alitq]
  * added? support for jamed {chema types (3795i
  ( added; to{Object,JSGN} sshema oPtions (#805+
  j0added;"findByIdAnd{Update,Rmmove}()
 1* qdded; Find^neAnd{Update,Remeve}(+
  * added; query.sevOptions()
  *0added; in3tance.update() (#794)
¡ * addud; 3upport {pecifying moäeh in populcte(- [DanielBaulig]
  * cdded;(`lean` query opthon [gytgy]
h * a`dåd+ mulpi/atomic support to Mongoos%ArrAy#nonAto-icQush  * aDded; sup`ort for $set + other $atomic ops on 3ingle array
  * adde$; teSts
 (* uxdAted; driver to 5.0.2
  * updated; query.sort() syntcx tg mirror`query.selecô()
  * up`ated; clearar cast(error móg n/r azray numbers
  *1õpdave`; docc
  * upda4ed; doc.clone 3x faster (#9u0)
 `* update`; only create _id ig fecessary (#9u0)

2.7®3 / 201"-08- 1
=============½====
Š  ( fixed; bk,eaï $in queries (#y98)
  * fixed féeld selecuion option on swbeocs (#1022)

2.7.2 / 2012,07-q8
9=======?=-=======

  * fixed3 cAllrack 4g aonn#dióconnect is optional (#875)
  * fixed; handle mi{óine pòotocnlS$iN conlection urls (#9<7)
  * fmxed; saving modified/removed suflogs ("975)
  * updatdd; testc

2.7.1 / 2012-0¶-26
===9===?===========

  * fixed;(slarding: wlen a document hoìds a null as a vanue of the shard key
  j fixed; update() using $pull on ao arráy of Mixed (gh-735)
  * depresated; MongooseNumber#{inc, incremeît, decrement}$methods
0 * tests; now uyin' moch!

6.7.0 / 6012-06-14
====-======9=======Š
  * alded9 deprecatio~ warnin%s to methods being removed in 3.xJ2.6.8 / 201"-06-14
=5?==========?=====

  * fixed; edGe c!se`when using 'gptions' iw a path lame$(#961)

2n6.7(/ 2012-0>-08
=========5?====-½==*
  * fized; ensuRe srOmise"uzror alwaùs emips instankeof Error
  * fixed9 selection of _id w/ another ex#ludåd path (#954)
  * dixed; setôing dafaelt DocuoentArrayc (#-5;)

2.6.6 /$241206-06
=========<=========
Š  * fixed; stack ov%rflow in puery stream with lárge result sets (#929)
  * afded; $gtl $gte, &lt, $ìte`suppor4 to arrays ¨#902)
  * fipgd9 páss op|ion `safe` a,ong to doc#removeh) calls
2.6.5 / 2013-0%­24
==============}===5

  * fixed; do not save v)rtuals il MOde,.uudate (#894)
  *0added;0missing $ prefi|ed puery alkasEs (going away i. 3.x) (#884)bZtimoxldy]
  * fixed; setting invalid paths in strict mode *#916)
  *!fixet;`vesetting i3Jew aftev insert failure (#837) [boutellY

2.6.4 / 2012-25-15
===================
*  * updated; backport strilg regex $options to 2.x
  * updated3 use drivgr 1.0.2 (performance im0rovemu®ts) (')14)
! * fixed;`caìling`ÍongooseDmcumentArray#iä when the doc has no _id 8#897)
2.6.3"/ 2012-05-03
=9==?=======5======

  
 fixed; rapl-set koînectivity issuas during failover kn Mo~goDB 2.0.1
  * updated; driveú to 1.0.0
  * fixed; virtuáls applécition ov subdocs when2using toObjeat({ virtuals: true }+ (#889)
  * fixed; MongooseArray#puLl of"ObjectIt corract|y upeates the array atself (#881)

2.6.2 / 2012-04-30
=9=================

" * fixe`; lefault bien,"applicataon nf seldsted fields (#870	

2.6n1 / 2012-04-0Š½===========<==-===

 0*!fixEd; connection assignment in monooose#modem (#853, #877!
  * fixmd: incor2ect reported num`of"affected docs in update oðc (#862)
J2.6.1 / 2012-04-19
========9==}=====9=

` * 5pdated; hooks>js to p.2.1
  * fixed; issue with pessing u®defined uo a hoo{ callback. thanks0to [chrisleashman] for(repor4ing.
  * fixed; updati.g/sEtting neSved o"jects i/ strict schemas (#843) is rdported by [kof]
  * fixed; Quer{#{update,removå}() work withoup callbacks acain (#788)
  * fixed; modifxing subdoc along with parent array $ptomic op (#842)

0.5.14 / 2 12-04-13
-====?==<==========

  * &ixed òetting an unset äefauhô value (#746)
 0* dixed; doc.isCelected(otherpa|x) when onlx _id Is"selected *#7309
  * updated; dncs

2>5.13!/ 201v-03-22
=================5

  * fixed; failang vali`atkon mf unselected required paths (#710,3713)
  * fix%d» emitting conngctikn mrror wlen only one listengr (#7u9)
  * fi|ed;*MonggoseAbra}#splice was not returning valuås (#w84) [ci2isleishman]

2.5.12 / 2012-03-21
====-========-=====

 $* fiyed; honor the `sqfe` opti/n in all ensureIndex calls
  * updated; node-mongodb-native driver to 0.9.9-7

2.5.11 / 2012-03-15
===================

  * added; introspection for getters/setters (#745)
  * updated; node-mongodb-driver to 0.9.9-5
  * added; tailable method to Query (#769) [holic]
  * fixed; Number min/max validation of null (#764) [btamas]
  * added; more flexible user/password connection options (#738) [KarneAsada]

2.5.10 / 2012-03-06
===================

  * updated; node-mongodb-native driver to 0.9.9-4
  * added; Query#comment()
  * fixed; allow unsetting arrays
  * fixed; hooking the set method of subdocuments (#746)
  * fixed; edge case in hooks
  * fixed; allow $id and $ref in queries (fixes compatibility with mongoose-dbref) (#749) [richtera]
  * added; default path selection to SchemaTypes

2.5.9 / 2012-02-22
===================

  * fixed; properly cast nested atomic update operators for sub-documents

2.5.8 / 2012-02-21
===================

  * added; post 'remove' middleware includes model that was removed (#729) [timoxley]

2.5.7 / 2012-02-09
===================

  * fixed; RegExp validators on node >= v0.6.x

2.5.6 / 2012-02-09
===================

  * fixed; emit errors returned from db.collection() on the connection (were being swallowed)
  * added; can add multiple validators in your schema at once (#718) [diogogmt]
  * fixed; strict embedded documents (#717)
  * updated; docs [niemyjski]
  * added; pass number of affected docs back in model.update/save

2.5.5 / 2012-02-03
===================

  * fixed; RangeError: maximum call stack exceed error when removing docs with Number _id (#714)

2.5.4 / 2012-02-03
===================

  * fixed; RangeError: maximum call stack exceed error (#714)

2.5.3 / 2012-02-02
===================

  * added; doc#isSelected(path)
  * added; query#equals()
  * added; beta sharding support
  * added; more descript error msgs (#700) [obeleh]
  * added; document.modifiedPaths (#709) [ljharb]
  * fixed; only functions can be added as getters/setters (#707,704) [ljharb]

2.5.2 / 2012-01-30
===================

  * fixed; rollback -native driver to 0.9.7-3-5 (was causing timeouts and other replica set weirdness)
  * deprecated; MongooseNumber (will be moved to a separate repo for 3.x)
  * added; init event is emitted on schemas

2.5.1 / 2012-01-27
===================

  * fixed; honor strict schemas in Model.update (#699)

2.5.0 / 2012-01-26
===================

  * added; doc.toJSON calls toJSON on embedded docs when exists [jerem]
  * added; populate support for refs of type Buffer (#686) [jerem]
  * added; $all support for ObjectIds and Dates (#690)
  * fixed; virtual setter calling on instantiation when strict: true (#682) [hunterloftis]
  * fixed; doc construction triggering getters (#685)
  * fixed; MongooseBuffer check in deepEquals (#688)
  * fixed; range error when using Number _ids with `instance.save()` (#691)
  * fixed; isNew on embedded docs edge case (#680)
  * updated; driver to 0.9.8-3
  * updated; expose `model()` method within static methods

2.4.10 / 2012-01-10
===================

  * added; optional getter application in .toObject()/.toJSON() (#412)
  * fixed; nested $operators in $all queries (#670)
  * added; $nor support (#674)
  * fixed; bug when adding nested schema (#662) [paulwe]

2.4.9 / 2012-01-04
===================

  * updated; driver to 0.9.7-3-5 to fix Linux performance degradation on some boxes

2.4.8 / 2011-12-22
===================

  * updated; bump -native to 0.9.7.2-5
  * fixed; compatibility with date.js (#646) [chrisleishman]
  * changed; undocumented schema "lax" option to "strict"
  * fixed; default value population for strict schemas
  * updated; the nextTick helper for small performance gain. 1bee2a2

2.4.7 / 2011-12-16
===================

  * fixed; bug in 2.4.6 with path setting
  * updated; bump -native to 0.9.7.2-1
  * added; strict schema option [nw]

2.4.6 / 2011-12-16
===================

  * fixed; conflicting mods on update bug [sirlantis]
  * improved; doc.id getter performance

2.4.5 / 2011-12-14
===================

  * fixed; bad MongooseArray behavior in 2.4.2 - 2.4.4

2.4.4 / 2011-12-14
===================

  * fixed; MongooseArray#doAtomics throwing after sliced

2.4.3 / 2011-12-14
===================

  * updated; system.profile schema for MongoDB 2x

2.4.2 / 2011-12-12
===================

  * fixed; partially populating multiple children of subdocs (#639) [kenpratt]
  * fixed; allow Update of numbers to null (#640) [jerem]

2.4.1 / 2011-12-02
===================

  * added; options support for populate() queries
  * updated; -native driver to 0.9.7-1.4

2.4.0 / 2011-11-29
===================

  * added; QueryStreams (#614)
  * added; debug print mode for development
  * added; $within support to Array queries (#586) [ggoodale]
  * added; $centerSphere query support
  * fixed; $within support
  * added; $unset is now used when setting a path to undefined (#519)
  * added; query#batchSize support
  * updated; docs
  * updated; -native driver to 0.9.7-1.3 (provides Windows support)

2.3.13 / 2011-11-15
===================

  * fixed; required validation for Refs (#612) [ded]
  * added; $nearSphere support for Arrays (#610)

2.3.12 / 2011-11-09
===================

  * fixed; regression, objects passed to Model.update should not be changed (#605)
  * fixed; regression, empty Model.update should not be executed

2.3.11 / 2011-11-08
===================

  * fixed; using $elemMatch on arrays of Mixed types (#591)
  * fixed; allow using $regex when querying Arrays (#599)
  * fixed; calling Model.update with no atomic keys (#602)

2.3.10 / 2011-11-05
===================

  * fixed; model.update casting for nested paths works (#542)

2.3.9 / 2011-11-04
==================

  * fixed; deepEquals check for MongooseArray returned false
  * fixed; reset modified flags of embedded docs after save [gitfy]
  * fixed; setting embedded doc with identical values no longer marks modified [gitfy]
  * updated; -native driver to 0.9.6.23 [mlazarov]
  * fixed; Model.update casting (#542, #545, #479)
  * fixed; populated refs no longer fail required validators (#577)
  * fixed; populating refs of objects with custom ids works
  * fixed; $pop & $unset work with Model.update (#574)
  * added; more helpful debugging message for Schema#add (#578)
  * fixed; accessing .id when no _id exists now returns null (#590)

2.3.8 / 2011-10-26
==================

  * added; callback to query#findOne is now optional (#581)

2.3.7 / 2011-10-24
==================

  * fixed; wrapped save/remove callbacks in nextTick to mitigate -native swallowing thrown errors

2.3.6 / 2011-10-21
==================

  * fixed; exclusion of embedded doc _id from query results (#541)

2.3.5 / 2011-10-19
==================

  * fixed; calling queries without passing a callback works (#569)
  * fixed; populate() works with String and Number _ids too (#568)

2.3.4 / 2011-10-18
==================

  * added; Model.create now accepts an array as a first arg
  * fixed; calling toObject on a DocumentArray with nulls no longer throws
  * fixed; calling inspect on a DocumentArray with nulls no longer throws
  * added; MongooseArray#unshift support
  * fixed; save hooks now fire on embedded documents [gitfy] (#456)
  * updated; -native driver to 0.9.6-22
  * fixed; correctly pass $addToSet op instead of $push
  * fixed; $addToSet properly detects dates
  * fixed; $addToSet with multiple items works
  * updated; better node 0.6 Buffer support

2.3.3 / 2011-10-12
==================

  * fixed; population conditions in multi-query settings [vedmalex] (#563)
  * fixed; now compatible with Node v0.5.x

2.3.2 / 2011-10-11
==================

  * fixed; population of null subdoc properties no longer hangs (#561)

2.3.1 / 2011-10-10
==================

  * added; support for Query filters to populate() [eneko]
  * fixed; querying with number no longer crashes mongodb (#555) [jlbyrey]
  * updated; version of -native driver to 0.9.6-21
  * fixed; prevent query callbacks that throw errors from corrupting -native connection state

2.3.0 / 2011-10-04
==================

  * fixed; nulls as default values for Boolean now works as expected
  * updated; version of -native driver to 0.9.6-20

2.2.4 / 2011-10-03
==================

  * fixed; populate() works when returned array contains undefined/nulls

2.2.3 / 2011-09-29
==================

  * updated; version of -native driver to 0.9.6-19

2.2.2 / 2011-09-28
==================

  * added; $regex support to String [davidandrewcope]
  * added; support for other contexts like repl etc (#535)
  * fixed; clear modified state properly after saving
  * added; $addToSet support to Array

2.2.1 / 2011-09-22
==================

  * more descript error when casting undefined to string
  * updated; version of -native driver to 0.9.6-18

2.2.0 / 2011-09-22
==================

  * fixed; maxListeners warning on schemas with many arrays (#530)
  * changed; return / apply defaults based on fields selected in query (#423)
  * fixed; correctly detect Mixed types within schema arrays (#532)

2.1.4 / 2011-09-20
==================

  * fixed; new private methods that stomped on users code
  * changed; finished removing old "compat" support which did nothing

2.1.3 / 2011-09-16
==================

  * updated; version of -native driver to 0.9.6-15
  * added; emit `error` on connection when open fails [edwardhotchkiss]
  * added; index support to Buffers (thanks justmoon for helping track this down)
  * fixed; passing collection name via schema in conn.model() now works (thanks vedmalex for reporting)

2.1.2 / 2011-09-07
==================

  * fixed; Query#find with no args no longer throws

2.1.1 / 2011-09-07
==================

  * added; support Model.count(fn)
  * fixed; compatibility with node >=0.4.0 < 0.4.3
  * added; pass model.options.safe through with .save() so w:2, wtimeout:5000 options work [andrewjstone]
  * added; support for $type queries
  * added; support for Query#or
  * added; more tests
  * optimized populate queries

2.1.0 / 2011-09-01
==================

  * changed; document#validate is a public method
  * fixed; setting number to same value no longer marks modified (#476) [gitfy]
  * fixed; Buffers shouldn't have default vals
  * added; allow specifying collection name in schema (#470) [ixti]
  * fixed; reset modified paths and atomics after saved (#459)
  * fixed; set isNew on embedded docs to false after save
  * fixed; use self to ensure proper scope of options in doOpenSet (#483) [andrewjstone]

2.0.4 / 2011-08-29
==================

  * Fixed; Only send the depopulated ObjectId instead of the entire doc on save (DBRefs)
  * Fixed; Properly cast nested array values in Model.update (the data was stored in Mongo incorrectly but recast on document fetch was "fixing" it)

2.0.3 / 2011-08-28
==================

  * Fixed; manipulating a populated array no longer causes infinite loop in BSON serializer during save (#477)
  * Fixed; populating an empty array no longer hangs foreeeeeeeever (#481)

2.0.2 / 2011-08-25
==================

  * Fixed; Maintain query option key order (fixes 'bad hint' error from compound query hints)

2.0.1 / 2011-08-25
==================

  * Fixed; do not over-write the doc when no valide props exist in Model.update (#473)

2.0.0 / 2011-08-24
===================

  * Added; support for Buffers [justmoon]
  * Changed; improved error handling [maelstrom]
  * Removed: unused utils.erase
  * Fixed; support for passing other context object into Schemas (#234) [Sija]
  * Fixed; getters are no longer circular refs to themselves (#366)
  * Removed; unused compat.js
  * Fixed; getter/setter scopes are set properly
  * Changed; made several private properties more obvious by prefixing _
  * Added; DBRef support [guille]
  * Changed; removed support for multiple collection names per model
  * Fixed; no longer applying setters when document returned from db
  * Changed; default auto_reconnect to true
  * Changed; Query#bind no longer clones the query
  * Fixed; Model.update now accepts $pull, $inc and friends (#404)
  * Added; virtual type option support [nw]

1.8.4 / 2011-08-21
===================

  * Fixed; validation bug when instantiated with non-schema properties (#464) [jmreidy]

1.8.3 / 2011-08-19
===================

  * Fixed; regression in connection#open [jshaw86]

1.8.2 / 2011-08-17
===================

  * fixed; reset connection.readyState after failure [tomseago]
  * fixed; can now query positionally for non-embedded docs (arrays of numbers/strings etc)
  * fixed; embedded document query casting
  * added; support for passing options to node-mongo-native db, server, and replsetserver [tomseago]

1.8.1 / 2011-08-10
===================

  * fixed; ObjectIds were always marked modified
  * fixed; can now query using document instances
  * fixed; can now query/update using documents with subdocs

1.8.0 / 2011-08-04
===================

  * fixed; can now use $all with String and Number
  * fixed; can query subdoc array with $ne: null
  * fixed; instance.subdocs#id now works with custom _ids
  * fixed; do not apply setters when doc returned from db (change in bad behavior)

1.7.4 / 2011-07-25
===================

  * fixed; sparse now a valid seperate schema option
  * fixed; now catching cast errors in queries
  * fixed; calling new Schema with object created in vm.runInNewContext now works (#384) [Sija]
  * fixed; String enum was disallowing null
  * fixed; Find by nested document _id now works (#389)

1.7.3 / 2011-07-16
===================

  * fixed; MongooseArray#indexOf now works with ObjectIds
  * fixed; validation scope now set properly (#418)
  * fixed; added missing colors dependency (#398)

1.7.2 / 2011-07-13
===================

  * changed; node-mongodb-native driver to v0.9.6.7

1.7.1 / 2011-07-12
===================

  * changed; roll back node-mongodb-native driver to v0.9.6.4

1.7.0 / 2011-07-12
===================

  * fixed; collection name misspelling [mathrawka]
  * fixed; 2nd param is required for ReplSetServers [kevinmarvin]
  * fixed; MongooseArray behaves properly with Object.keys
  * changed; node-mongodb-native driver to v0.9.6.6
  * fixed/changed; Mongodb segfault when passed invalid ObjectId (#407)
      - This means invalid data passed to the ObjectId constructor will now error

1.6.0 / 2011-07-07
===================

  * changed; .save() errors are now emitted on the instances db instead of the instance 9782463fc
  * fixed; errors occurring when creating indexes now properly emit on db
  * added; $maxDistance support to MongooseArrays
  * fixed; RegExps now work with $all
  * changed; node-mongodb-native driver to v0.9.6.4
  * fixed; model names are now accessible via .modelName
  * added; Query#slaveOk support

1.5.0 / 2011-06-27
===================

  * changed; saving without a callback no longer ignores the error (@bnoguchi)
  * changed; hook-js version bump to 0.1.9
  * changed; node-mongodb-native version bumped to 0.9.6.1 - When .remove() doesn't
             return an error, null is no longer passed.
  * fixed; two memory leaks (@justmoon)
  * added; sparse index support
  * added; more ObjectId conditionals (gt, lt, gte, lte) (@phillyqueso)
  * added; options are now passed in model#remote (@JerryLuke)

1.4.0 / 2011-06-10
===================

  * bumped hooks-js dependency (fixes issue passing null as first arg to next())
  * fixed; document#inspect now works properly with nested docs
  * fixed; 'set' now works as a schema attribute (GH-365)
  * fixed; _id is now set properly within pre-init hooks (GH-289)
  * added; Query#distinct / Model#distinct support (GH-155)
  * fixed; embedded docs now can use instance methods (GH-249)
  * fixed; can now overwrite strings conflicting with schema type

1.3.7 / 2011-06-03
===================

  * added MongooseArray#splice support
  * fixed; 'path' is now a valid Schema pathname
  * improved hooks (utilizing https://github.com/bnoguchi/hooks-js)
  * fixed; MongooseArray#$shift now works (never did)
  * fixed; Document.modified no longer throws
  * fixed; modifying subdoc property sets modified paths for subdoc and parent doc
  * fixed; marking subdoc path as modified properly persists the value to the db
  * fixed; RexExps can again be saved ( #357 )

1.3.6 / 2011-05-18
===================

  * fixed; corrected casting for querie3 against array types
0 * added; Docu}ent#qep now accepts Document instanges

1.³.5 / 2011-05-17
===============<==

  * fiøed; $ne0qõerieshwork properly vitl single vals
  *(adde`; #insðect() methods to improre conshe.log OutpõtJ
1.3.4 / 2111-05-17
½==========½====½=

  * f)xed; dind by Date wovks ac expected ('336)
  
 added; geospaTial 2d index support
  * added; support for $near (#309(
  * updateä; node-mongodb-native driv%r
  * fhxed: updating numbers work (#342)
  + a$ded; bettar error msg when try to remove an embedded doc without an _id (#307)
  * atded; support &ob 'on-thå-fl{' schmmas (#227)
  * ch@nged; virtual id getters can now be skipped
  * fixed; .index() called on subdoc schema no7 wozks as expected  * fiyed; db.setProfile() now buffers untih the db is oren (#340)

1.3.3 / 2011-04-27
=====9=====½=======
  * fixed; corrected!puery castiNg on neSted mixed types

1.3.2 / 2011-04-27
===================

  : fixed query hints now retcin key order

1.1.1 /(2011-0t-27
===============}=9=

  ª fixed; setting a property on an embeddel array .o longer overwritEs entire`array (GH­310)
  * fixed; sdtting nested propertyer"workó w`en sibling prop is named "type"
` * fixed; isModified is now much finer gRaijed when .set() is used (GH-323)
  * fixed; mongoose.mod%l() and connection.mgde,() now rEtur~ thå MOdel (GH-308, GH-305)
  * fixdd; can no÷ use $gt, $lt, $gte, $lte with String schema types (GH-317)
 0* fiøed; .lOwercawe() -> .toLowerCase() in pluralizd()
  * fixe$; updating an %íbedded document by index wnbk{ (GH-334)
  * k)anged; .save(+ no passes u(e instance to the callback (GH-294, GH-264)
  * added; can now query rystem.profile and sys4em.inlexes coll%ctions
  * added; db.model('system.profile') is Now included as a default ScjemaŠ  * added; db.setProfilin'(level, ms, callback)
  * ádde$; Qudry#hint() sutport
  * alfed;(more tests
  * updated node-eonGodb-navive t{ 0.9.3

.#.0 / 2011-04-19
=========½==5=====

  * ãhaneed; sáve() cal,backs now fire only once on failed!validation
  * Changed; Erropw retuvned fòom save() ca,lbacks now instances Of ^alidationDrror
  * nixed; M/ngooseArray#indexOf now works properly

1.2.0 / 2011-04-11
=====?===========

  * changed; MonGooseNumbep now casts empty String to"nu,l

1.1.:50' 2011-0-08
===========½=5=====

  * fixed; po3t init now fibes!at proper time

1.1.24 / 2011-04-03
===================

 "* fixaæ; pushing an array ojto an Ar2ay works oo existifg docs

1.1.23 + 2011-04-01
=========5=========

  *!Added mdel#model

1.1.22 / 2011-03-1
==========}====-===

  * Fixed; ¤mn queries on mixmd types now work

1.1.210/ 2011m03-31
==½================

  * Fixed; settijg object root to null/undefined works

1.5.20 / 2011-03-³1
==================
Š  * Fixed; setting iultitle props on nulh field!works

1.1.19 /(2011-03-31
==============9-===

  * Fmxed; no longer using $set n paths to$an unexisting fields

1.1.18 / 2011-03-30
===================

  * Gixed; non-mixed type object`se|ôers work afpe2 i.itd from null

1.1.17 / 2011-3-30
-=================}

  * Fixed; lested o`ject property access works when Rgot initd with null"value

1.1.16"/ #011-03-28
===================

( *`Fixed; emxty arrays are now saved
1.1.15 / 2011-03-28
===============9===

  * Fixed; `null` and `undefined` are set atomically.

5.1&14"/ 2011-03-28======-============

 "* Changed; more foreivilg da|e casting, accep|ing '' !s null.

1.1.13 / 2011-83-26
==?============9===

  * Fixed setting values as"`undefioed`.

1.1.12 / 2011-0#-26
=============<==?==

  ª Fixed; nectef obkects now convert to JSON pzopgrly
  * Fixed; setting neó|ed obJects direcply îow works
  * Updatm node-mongoeb-native

1,1.11 / 2013-03-25
==================

  * Fixed for use of `type` as a key.

1*1.10 / 20ñ1-03-23
===============-=<=

  * Change`; Make sure to only ensure indexes while connected

1.1.9 / 2011-03,2
===?==9==========

  * Fixed; Mixed Can now default to empty arrays
  * Fixed; keys by`thd name 'type' are nw valid
  * Fixed; null value3 rEtriewed from the ditabáse are hydrated as null values.
  * Fixed"repeated aôomic opebátions!ojen saving a Same documenô twice.

.1.( / 2011-03-23
======-===========

  * Fixed 'id' overriding. [bnoguhi]

1.1.7 / 2011-43-02
====9============
  * Fixed Regexp Query casting when que2ying"against an Arsay ïf Sdpings [bnoguchi]
  * Fiped ge4terw/sedtmrs dor nestõd virt}alsl.![bnoguchi]

1.1.6 / 6011-03-22
=================

  * Only doValidate when path exists in S#huma [aheckm!nn]
  * Allow function dEfaul4s for Array"typgs [aheck}ann]
  * Fix validatioj hang Yaheskmann]
  * Fix cetting kf isRequired of SchemqTypE [aheakmann]
 ". Fih0SchemaType#required(false)`filteR [aheckíann]
$ * More BacKwards compatibility [aheckmao.]
  * More dests [aheckmann]
Ž1.1.7`/ ²01!-03-14
===-==========½===

  * Added óqp0oòt for `Uri, db, fn` and h5ri,(fl` signatUres for replica sets.
  . Improved/ehten`ed retlica$set tests.

1.1.4 / 201!-03-09
===========99====

  * fixed; sunning an empty"Query doesn%t Phrow. [aheckmann]
 $* Changed; Prnmise#addBakk returnq promióe. [aheckmann]
 $: Added streaming cursor suxport. [iheckmánn]
  * hanged; Query£Update defau|ts to use$SetOnSave now. [jrian]
  * Added m/re docs.

1.1.3 / 2011-03-04
==================

  * Added Promkse#resolve [Ahackmann
  * Fixeä back7ard compatibility wmth$nulls [aheckmann]
  * Changed; Query#{run,exec} beturn promises$[aheckmann]
1/1/: / 2011-03-03
=9===<============

  * Restored Query#exec and0added notion of def!ult operatiOn [brian]
  *"Fixed ValhdatorErroz Messages [brian]

1.1,1 / 2011-03-01
==========9=======
J  * Adde$ Sch%eáTyðe String `lowercaód`, `utpercase` `trim`.
  * Public exports"(`Model`, `Documen|`) and tests.
  * Added ÏbjectId casting s5pport for `Document`s.

1.1.00' 2011-02-25
==================

  * Added suppmrt for replica sets.

1.0.16 / 20q1-02-18
================<y½

  * Adfed $nin `S ajother whitelisted $colditional for SchemaArray [brian
$ * Chafged #with po #wherd [bòian]
  * Added ability(to use $in condiôional wkth Array types [brian]

1.0.15 / 2011)02-18
=========?=========

  * Added `id` virtual getter for documents to easily access the hexString of
  the `_id`.

1.0.14 / 2011/02-17
===================

  * Fix for)ar`ays withif subdocumenôs [brian]

1.0.13 . 2811)02=16
=================<

  * Fixed embed$ed documents saving.
1.p.12 /$2011-02-14
====u=======<=====
  * Minor!refactorings brian]

10.11 / 2011-02-14
=<========?========

  * Query refactor ane $ne, $slice, $or, $size, $enemMavch, $nkn,$$exists suðport [briao]
  * NameD scopeó {ugar [brian]

1.8.10 / 2011-02-1<=====?=========½=

  * Updated node-mongodb-native driver [thanks John Aìlen]
1.0.9 / 2011-02-09
=========9=?=-===
*  * FÉxed single member arrays as defaults [brian]

1.0.8 / 2031-02-09
=9================

  * Fixed for collmction-level buffering of commands [gitfy]Š  * Fixed hDocument3toJSON` [dalejefferson]
  * Fixed `Co~nection` authentication [robrkchter]
  * Fixed clash of aacessor3 in getters/setters [eirikurN]
  * Im0rovef `Model!save@ proeise handling

1.0.7 / 2011-02-05
===-=========}====

  " Fixed eemory leak warnings for test suite on 0.3
  * Fixe$ querying documents that havd a. array thcv contain at least o/e
  specified member. [brian]
  . Fixed default value for Array(types (fihes GH-21°)/ [brian]
  * Fixed exam0le code.+
1.0.6 / 2011-02-02
=====}===}=}======

  * Fixed dpost` middleware
  * Fixed; iv's nou possiblu to instaNtmate a model dven when!one of the paths mars
  to an undebined value [brian]

1. .5 / 2011-02-02
==========<=======

  * Fixed; combo $push and $pushAll auto-converts into a$$pushQll {brian]
  * Fixed; combo($pull$and $PulìAll auto-converts to a single $pullAll [bpian]
  * Fixed; $pullll now seMoves said membe2s from arrey befo2e save (so it acts just
  like |us(All) [bpian]
  * Fixed: multitle $pu,ls and $pushes become a single $pullAll and $pushAll*
  Moreover,`$pull .ow modifies the`array`before sive to reflect the immeDéate
  change [brian]
  * Added tests for nested shortcut getters [brian]
" * Adde` tEsts tha4 show`thav Schemas wIth nested!Arrays doNt apply defaults
 $[brian]

1.0.4 / ²010-02-02
<==========}======

  * Adeed M/nGooseNueber#toString
 $" dded MongooseNu-ber unIt |ests

1.0.3 / 2051-02%02
==========}====<==

  * Mcke sure safe mode wor{s with Model#save
! * Changed Schema options: safe mode is now the derauLt
  * Updatel node-mon'odb-native to HEAD

1.0.2 / 2011-02-02
=}==============9=

  * Added a odel.crea4e s`ortcu| foz creating documents.$[brman]
 $* FiXed; we can now instantiite eodels with hashes that map to ap lfast one
  numl valug. Ûbrian]
  * Fixed Skhema with more than 2 neóted lewels. [brian]

1.0.1 / 2011-02-02
========<=========

  * ImpRoved `MkncooseNumber`, workS almost |ike th% native except for àtypeof`
  not being `'number'`.
